import{t as ea,h as Ha,a as ta}from"../chunks/AwDElgrE.js";import"../chunks/RXuRlTD1.js";import{v as za,w as Ja,$ as Ya,c as v,s as a,b as t,m as Z,r as s,h as o,x as G,B as ia,y as c,n as Ka,a as Qa}from"../chunks/DqzT7aWf.js";import{e as D,s as H}from"../chunks/BjFHoynf.js";import{i as ma}from"../chunks/dUYLJQ_5.js";import{e as Wa,i as Xa}from"../chunks/D_N7JuGC.js";import{r as d}from"../chunks/Dxge3KwP.js";import{s as wa}from"../chunks/Dz_krg_u.js";import{t as Za,f as at,b as f,p as Na}from"../chunks/DUY4N44i.js";import{b as ra}from"../chunks/DOEI6xEw.js";import{i as tt}from"../chunks/Dz9YM5No.js";import{o as et}from"../chunks/S0sOL0db.js";import{g as ot}from"../chunks/9_0LQjj_.js";var it=ea('<p class="info-message"> </p>'),rt=ea('<form class="create-form"><select name="autonomous_community" required><option disabled selected>Comunidad autónoma</option><option>Andalucía</option><option>Aragón</option><option>Asturias</option><option>Baleares</option><option>Canarias</option><option>Cantabria</option><option>Castilla y León</option><option>Castilla-La Mancha</option><option>Cataluña</option><option>Ceuta y Melilla</option><option>Comunitat Valenciana</option><option>Extremadura</option><option>Galicia</option><option>La Rioja</option><option>Madrid</option><option>Murcia</option><option>Navarra</option><option>País Vasco</option><option>TOTAL</option></select> <input type="number" placeholder="Año" required> <select name="education_level" required><option disabled selected>Nivel educativo</option><option>Educación superior (SUP)</option><option>Secundaria (SEC)</option><option>Inferior a secundaria (INF)</option><option>Total (TOTAL)</option></select> <input type="number" step="0.01" placeholder="Tasa actividad" required> <input type="number" step="0.01" placeholder="Tasa empleo" required> <input type="number" step="0.01" placeholder="Tasa paro" required> <button type="submit" class="submit">Crear</button> <button type="button" class="cancel">Cancelar</button></form>'),nt=ea('<form class="create-form"><input type="number" placeholder="Desde año"> <input type="number" placeholder="Hasta año"> <input type="number" placeholder="Año exacto"> <select name="autonomous_community"><option disabled selected>Comunidad autónoma</option><option>Andalucía</option><option>Aragón</option><option>Asturias</option><option>Baleares</option><option>Canarias</option><option>Cantabria</option><option>Castilla y León</option><option>Castilla-La Mancha</option><option>Cataluña</option><option>Ceuta y Melilla</option><option>Comunitat Valenciana</option><option>Extremadura</option><option>Galicia</option><option>La Rioja</option><option>Madrid</option><option>Murcia</option><option>Navarra</option><option>País Vasco</option><option>TOTAL</option></select> <select name="education_level"><option disabled selected>Nivel educativo</option><option>Educación superior (SUP)</option><option>Secundaria (SEC)</option><option>Inferior a secundaria (INF)</option><option>Total (TOTAL)</option></select> <input type="number" placeholder="Tasa actividad min"> <input type="number" placeholder="Tasa actividad max"> <input type="number" placeholder="Tasa empleo min"> <input type="number" placeholder="Tasa empleo max"> <input type="number" placeholder="Tasa paro min"> <input type="number" placeholder="Tasa paro max"> <input type="number" placeholder="Limitar a..."> <input type="number" placeholder="Comenzar desde..."> <button class="btn" type="submit">Buscar</button></form>'),lt=ea('<tr><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td class="actions"><button class="btn-circle" title="Editar Registro"><i class="fas fa-pen"></i></button>  <button class="btn-circle" title="Eliminar Registro"><i class="fas fa-times"></i></button></td></tr>'),st=ea('<div class="wrapper dash"><div class="container dash"><!> <div class="header"><h3>Datos de empleo</h3> <div class="actions"><button class="btn"><i class="fas fa-search"></i> Buscar</button> <button class="btn"><i class="fas fa-plus"></i> Nuevo registro</button> <button class="btn"><i class="fas fa-sync-alt"></i> Recargar</button> <button class="btn"><i class="fas fa-trash-alt"></i> Eliminar</button></div></div> <!> <!> <div class="seeker"></div> <div class="table-container"><table><thead><tr><th>Comunidad Autónoma</th><th>Año</th><th>Nivel educativo</th><th>Tasa de actividad</th><th>Tasa de empleo</th><th>Tasa de paro</th><th>Acciones</th></tr></thead></table> <div class="scroll-body"><table><tbody></tbody></table></div></div></div></div>');function Ct($a,Ra){za(Ra,!1);let z="/api/v1/employment-data",M=Z([]),n=Z(""),J=Z(!1),aa=Z(!1),u=Z({autonomous_community:"",year:"",education_level:"",activity_rate:"",employment_rate:"",unemployment_rate:""}),i=Z({from:"",to:"",year:"",autonomous_community:"",education_level:"",activity_rateMin:"",activity_rateMax:"",employment_rateMin:"",employment_rateMax:"",unemployment_rateMin:"",unemployment_rateMax:"",limit:"",offset:""});async function Y(){try{const r=await fetch(z);if(!r.ok){r.status===404?o(n,"No se encontraron datos de empleo."):r.status===500?o(n,"Error del servidor. Intenta más tarde."):o(n,"Error inesperado"),o(M,[]);return}o(M,await r.json())}catch(r){console.error("[GET] Error cargando datos:",r),o(n,"No se pudo conectar con el servidor."),o(M,[])}setTimeout(()=>o(n,""),2e3)}function Da(){o(aa,!t(aa)),o(J,!1),t(aa)||(o(i,{from:"",to:"",year:"",autonomous_community:"",education_level:"",activity_rateMin:"",activity_rateMax:"",employment_rateMin:"",employment_rateMax:"",unemployment_rateMin:"",unemployment_rateMax:"",limit:"",offset:""}),o(n,""),Y())}function Sa(){o(J,!t(J)),o(aa,!1)}async function Ia(){const r=new URLSearchParams;for(const[e,p]of Object.entries(t(i)))p!==""&&p!==null&&p!==void 0&&r.append(e,p);try{const e=await fetch(`${z}?${r.toString()}`);if(!e.ok){e.status===400?o(n,"Parámetros de búsqueda no válidos."):e.status===500?o(n,"Error interno del servidor al buscar."):o(n,"Error inesperado"),o(M,[]);return}o(M,await e.json()),t(M).length===0?o(n,"No se encontraron resultados para tu búsqueda."):o(n,`Se encontraron ${t(M).length} resultados.`)}catch(e){console.error("[SEARCH] Error al buscar:",e),o(n,"No se pudo conectar con el servidor."),o(M,[])}setTimeout(()=>o(n,""),2e3)}async function ka(){try{const r=await fetch(z,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t(u))}),e=await r.json();r.status===201?(o(n,"Registro creado correctamente"),o(J,!1),qa(),await Y()):r.status===400?o(n,"Datos inválidos: revisa los campos."):r.status===409?o(n,"Ya existe un registro con esos identificadores."):o(n,"Error inesperado al procesar la petición.")}catch(r){console.error("[CREATE] Error:",r),o(n,"No se pudo conectar con el servidor.")}setTimeout(()=>o(n,""),2e3)}function qa(){o(u,{autonomous_community:"",year:"",education_level:"",activity_rate:"",employment_rate:"",unemployment_rate:""})}async function Oa(){const r=`${z}/loadInitialData`;try{const e=await fetch(r);if(!e.ok)throw new Error(`Error ${e.status}`);o(n,"Datos iniciales cargados."),await Y()}catch(e){console.error("[LOAD INITIAL DATA] Error:",e),o(n,"Error al cargar los datos iniciales.")}setTimeout(()=>{o(n,"")},2e3)}async function Pa(){if(confirm("¿Estás seguro de que quieres eliminar todos los registros?")){try{const e=await fetch(z,{method:"DELETE"});e.status===200?(o(n,"Todos los registros han sido eliminados."),await Y()):e.status===404?o(n,"No hay registros que eliminar."):o(n,"Error al eliminar")}catch(e){console.error("[DELETE] Error deleting records:",e),o(n,"Error al eliminar los registros.")}setTimeout(()=>{o(n,"")},2e3)}}async function ja(r,e,p){try{const _=await fetch(`${z}/${r}/${e}/${p}`,{method:"DELETE"});_.status===200?(o(n,`Registro de ${r} (${e}, ${p}) eliminado correctamente.`),await Y()):_.status===404?o(n,"Registro no encontrado."):o(n,"Error al eliminar")}catch(_){console.error("[DELETE] Error deleting record:",_),o(n,"Error al eliminar el registro.")}setTimeout(()=>{o(n,"")},2e3)}et(async()=>{await Y()}),tt();var na=st();Ha(r=>{Ya.title="Datos de Empleo"});var da=v(na),fa=v(da);{var Va=r=>{var e=it(),p=v(e,!0);s(e),G(()=>H(p,t(n))),Za(3,e,()=>at,()=>({duration:300})),ta(r,e)};ma(fa,r=>{t(n)&&r(Va)})}var la=a(fa,2),ya=a(v(la),2),ba=v(ya),ha=a(ba,2),Ea=a(ha,2),Ba=a(Ea,2);s(ya),s(la);var Ta=a(la,2);{var Fa=r=>{var e=rt(),p=v(e);G(()=>{t(u),ia(()=>{})});var _=v(p);_.value=_.__value="";var x=a(_);x.value=x.__value="Andalucía";var y=a(x);y.value=y.__value="Aragón";var S=a(y);S.value=S.__value="Asturias";var b=a(S);b.value=b.__value="Baleares";var A=a(b);A.value=A.__value="Canarias";var h=a(A);h.value=h.__value="Cantabria";var L=a(h);L.value=L.__value="Castilla y León";var E=a(L);E.value=E.__value="Castilla-La Mancha";var w=a(E);w.value=w.__value="Cataluña";var T=a(w);T.value=T.__value="Ceuta y Melilla";var N=a(T);N.value=N.__value="Comunitat Valenciana";var C=a(N);C.value=C.__value="Extremadura";var g=a(C);g.value=g.__value="Galicia";var $=a(g);$.value=$.__value="La Rioja";var k=a($);k.value=k.__value="Madrid";var q=a(k);q.value=q.__value="Murcia";var O=a(q);O.value=O.__value="Navarra";var P=a(O);P.value=P.__value="País Vasco";var K=a(P);K.value=K.__value="TOTAL",s(p);var j=a(p,2);d(j);var I=a(j,2);G(()=>{t(u),ia(()=>{})});var V=v(I);V.value=V.__value="";var Q=a(V);Q.value=Q.__value="SUP";var R=a(Q);R.value=R.__value="SEC";var W=a(R);W.value=W.__value="INF";var X=a(W);X.value=X.__value="TOTAL",s(I);var B=a(I,2);d(B);var F=a(B,2);d(F);var U=a(F,2);d(U);var oa=a(U,4);s(e),ra(p,()=>t(u).autonomous_community,m=>c(u,t(u).autonomous_community=m)),f(j,()=>t(u).year,m=>c(u,t(u).year=m)),ra(I,()=>t(u).education_level,m=>c(u,t(u).education_level=m)),f(B,()=>t(u).activity_rate,m=>c(u,t(u).activity_rate=m)),f(F,()=>t(u).employment_rate,m=>c(u,t(u).employment_rate=m)),f(U,()=>t(u).unemployment_rate,m=>c(u,t(u).unemployment_rate=m)),D("click",oa,()=>o(J,!1)),D("submit",e,Na(ka)),ta(r,e)};ma(Ta,r=>{t(J)&&r(Fa)})}var Ca=a(Ta,2);{var Ua=r=>{var e=nt(),p=v(e);d(p);var _=a(p,2);d(_);var x=a(_,2);d(x);var y=a(x,2);G(()=>{t(i),ia(()=>{})});let S;var b=v(y);b.value=b.__value="";var A=a(b);A.value=A.__value="Andalucía";var h=a(A);h.value=h.__value="Aragón";var L=a(h);L.value=L.__value="Asturias";var E=a(L);E.value=E.__value="Baleares";var w=a(E);w.value=w.__value="Canarias";var T=a(w);T.value=T.__value="Cantabria";var N=a(T);N.value=N.__value="Castilla y León";var C=a(N);C.value=C.__value="Castilla-La Mancha";var g=a(C);g.value=g.__value="Cataluña";var $=a(g);$.value=$.__value="Ceuta y Melilla";var k=a($);k.value=k.__value="Comunitat Valenciana";var q=a(k);q.value=q.__value="Extremadura";var O=a(q);O.value=O.__value="Galicia";var P=a(O);P.value=P.__value="La Rioja";var K=a(P);K.value=K.__value="Madrid";var j=a(K);j.value=j.__value="Murcia";var I=a(j);I.value=I.__value="Navarra";var V=a(I);V.value=V.__value="País Vasco";var Q=a(V);Q.value=Q.__value="TOTAL",s(y);var R=a(y,2);G(()=>{t(i),ia(()=>{})});let W;var X=v(R);X.value=X.__value="";var B=a(X);B.value=B.__value="SUP";var F=a(B);F.value=F.__value="SEC";var U=a(F);U.value=U.__value="INF";var oa=a(U);oa.value=oa.__value="TOTAL",s(R);var m=a(R,2);d(m);var sa=a(m,2);d(sa);var ua=a(sa,2);d(ua);var pa=a(ua,2);d(pa);var va=a(pa,2);d(va);var ca=a(va,2);d(ca);var _a=a(ca,2);d(_a);var La=a(_a,2);d(La),Ka(2),s(e),G((l,Ga)=>{S=wa(y,1,"",null,S,l),W=wa(R,1,"",null,W,Ga)},[()=>({empty:t(i).autonomous_community===""}),()=>({empty:t(i).education_level===""})],Qa),f(p,()=>t(i).from,l=>c(i,t(i).from=l)),f(_,()=>t(i).to,l=>c(i,t(i).to=l)),f(x,()=>t(i).year,l=>c(i,t(i).year=l)),ra(y,()=>t(i).autonomous_community,l=>c(i,t(i).autonomous_community=l)),ra(R,()=>t(i).education_level,l=>c(i,t(i).education_level=l)),f(m,()=>t(i).activity_rateMin,l=>c(i,t(i).activity_rateMin=l)),f(sa,()=>t(i).activity_rateMax,l=>c(i,t(i).activity_rateMax=l)),f(ua,()=>t(i).employment_rateMin,l=>c(i,t(i).employment_rateMin=l)),f(pa,()=>t(i).employment_rateMax,l=>c(i,t(i).employment_rateMax=l)),f(va,()=>t(i).unemployment_rateMin,l=>c(i,t(i).unemployment_rateMin=l)),f(ca,()=>t(i).unemployment_rateMax,l=>c(i,t(i).unemployment_rateMax=l)),f(_a,()=>t(i).limit,l=>c(i,t(i).limit=l)),f(La,()=>t(i).offset,l=>c(i,t(i).offset=l)),D("submit",e,Na(Ia)),ta(r,e)};ma(Ca,r=>{t(aa)&&r(Ua)})}var ga=a(Ca,4),Ma=a(v(ga),2),xa=v(Ma),Aa=v(xa);Wa(Aa,5,()=>t(M),Xa,(r,e)=>{var p=lt(),_=v(p),x=v(_,!0);s(_);var y=a(_),S=v(y,!0);s(y);var b=a(y),A=v(b,!0);s(b);var h=a(b),L=v(h,!0);s(h);var E=a(h),w=v(E,!0);s(E);var T=a(E),N=v(T,!0);s(T);var C=a(T),g=v(C),$=a(g,2);s(C),s(p),G(()=>{H(x,t(e).autonomous_community),H(S,t(e).year),H(A,t(e).education_level),H(L,t(e).activity_rate),H(w,t(e).employment_rate),H(N,t(e).unemployment_rate)}),D("click",g,()=>ot(`/employment/edit/${encodeURIComponent(t(e).autonomous_community)}/${t(e).year}/${encodeURIComponent(t(e).education_level)}`)),D("click",$,()=>ja(t(e).autonomous_community,t(e).year,t(e).education_level)),ta(r,p)}),s(Aa),s(xa),s(Ma),s(ga),s(da),s(na),D("click",ba,Da),D("click",ha,Sa),D("click",Ea,Oa),D("click",Ba,Pa),ta($a,na),Ja()}export{Ct as component};
