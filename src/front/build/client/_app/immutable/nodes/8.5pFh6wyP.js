import{t as L,h as ft,a as q}from"../chunks/DPAxXt5P.js";import"../chunks/mJqeYPRp.js";import{v as yt,w as bt,$ as ht,c as m,s as r,b as t,m as I,r as c,h as a,x as F,B as Et,y as d,n as gt}from"../chunks/UhFziN8V.js";import{e as D,s as C}from"../chunks/-BXE7098.js";import{i as U}from"../chunks/Dv-5-jWs.js";import{e as Tt,i as xt}from"../chunks/DbKlm0bd.js";import{r as p}from"../chunks/DnUxF-Tf.js";import{t as Mt,f as wt,b as v,p as tt}from"../chunks/i9WfCmyJ.js";import{b as $t}from"../chunks/gZiIxItT.js";import{i as At}from"../chunks/DIe8ygAY.js";import{o as Dt}from"../chunks/D-IH1sAi.js";import{g as Ct}from"../chunks/DiWoTeV4.js";var Nt=L('<p class="info-message"> </p>'),Rt=L('<form class="create-form"><input placeholder="Comunidad Autónoma" required> <input type="number" placeholder="Año" required> <select required><option disabled selected>Nivel educativo</option><option>Educación superior (SUP)</option><option>Secundaria (SEC)</option><option>Inferior a secundaria (INF)</option><option>Total (TOTAL)</option></select> <input type="number" step="0.01" placeholder="Tasa actividad" required> <input type="number" step="0.01" placeholder="Tasa empleo" required> <input type="number" step="0.01" placeholder="Tasa paro" required> <button type="submit" class="submit">Crear</button> <button type="button" class="cancel">Cancelar</button></form>'),kt=L('<form class="create-form"><input type="number" placeholder="Desde año"> <input type="number" placeholder="Hasta año"> <input type="number" placeholder="Año exacto"> <input type="text" placeholder="Comunidad autónoma"> <input type="text" placeholder="Nivel educativo"> <input type="number" placeholder="Tasa actividad min"> <input type="number" placeholder="Tasa actividad max"> <input type="number" placeholder="Tasa empleo min"> <input type="number" placeholder="Tasa empleo max"> <input type="number" placeholder="Tasa paro min"> <input type="number" placeholder="Tasa paro max"> <input type="number" placeholder="Limitar a..."> <input type="number" placeholder="Comenzar desde..."> <button class="btn" type="submit">Buscar</button></form>'),It=L('<tr><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td class="actions"><button class="btn-circle" title="Editar Registro"><i class="fas fa-pen"></i></button>  <button class="btn-circle" title="Eliminar Registro"><i class="fas fa-times"></i></button></td></tr>'),St=L('<div class="wrapper dash"><div class="container dash"><!> <div class="header"><h3>Datos de empleo</h3> <div class="actions"><button class="btn"><i class="fas fa-search"></i> Búsqueda</button> <button class="btn"><i class="fas fa-plus"></i> Nuevo registro</button> <button class="btn"><i class="fas fa-sync-alt"></i> Recargar los datos iniciales</button> <button class="btn"><i class="fas fa-trash-alt"></i> Eliminar todos los datos</button></div></div> <!> <!> <div class="seeker"></div> <div class="table-container"><table><thead><tr><th>Comunidad Autónoma</th><th>Año</th><th>Nivel educativo</th><th>Tasa de actividad</th><th>Tasa de empleo</th><th>Tasa de paro</th><th>Acciones</th></tr></thead></table> <div class="scroll-body"><table><tbody></tbody></table></div></div></div></div>');function Yt(et,at){yt(at,!1);let N="/api/v1/employment-data",T=I([]),n=I(""),R=I(!1),S=I(!1),l=I({autonomous_community:"",year:"",education_level:"",activity_rate:"",employment_rate:"",unemployment_rate:""}),o=I({from:"",to:"",year:"",autonomous_community:"",education_level:"",activity_rateMin:"",activity_rateMax:"",employment_rateMin:"",employment_rateMax:"",unemployment_rateMin:"",unemployment_rateMax:"",limit:"",offset:""});async function k(){try{const i=await fetch(N);if(!i.ok){i.status===404?a(n,"No se encontraron datos de empleo."):i.status===500?a(n,"Error del servidor. Intenta más tarde."):a(n,"Error inesperado"),a(T,[]);return}a(T,await i.json())}catch(i){console.error("[GET] Error cargando datos:",i),a(n,"No se pudo conectar con el servidor."),a(T,[])}setTimeout(()=>a(n,""),2e3)}function ot(){a(S,!t(S)),a(R,!1),t(S)||(a(o,{from:"",to:"",year:"",autonomous_community:"",education_level:"",activity_rateMin:"",activity_rateMax:"",employment_rateMin:"",employment_rateMax:"",unemployment_rateMin:"",unemployment_rateMax:"",limit:"",offset:""}),a(n,""),k())}function rt(){a(R,!t(R)),a(S,!1)}async function it(){const i=new URLSearchParams;for(const[e,u]of Object.entries(t(o)))u!==""&&u!==null&&u!==void 0&&i.append(e,u);try{const e=await fetch(`${N}?${i.toString()}`);if(!e.ok){e.status===400?a(n,"Parámetros de búsqueda no válidos."):e.status===500?a(n,"Error interno del servidor al buscar."):a(n,"Error inesperado"),a(T,[]);return}a(T,await e.json()),t(T).length===0?a(n,"No se encontraron resultados para tu búsqueda."):a(n,`Se encontraron ${t(T).length} resultados.`)}catch(e){console.error("[SEARCH] Error al buscar:",e),a(n,"No se pudo conectar con el servidor."),a(T,[])}setTimeout(()=>a(n,""),2e3)}async function nt(){try{const i=await fetch(N,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t(l))}),e=await i.json();i.status===201?(a(n,"Registro creado correctamente"),a(R,!1),st(),await k()):i.status===400?a(n,"Datos inválidos: revisa los campos."):i.status===409?a(n,"Ya existe un registro con esos identificadores."):a(n,"Error inesperado al procesar la petición.")}catch(i){console.error("[CREATE] Error:",i),a(n,"No se pudo conectar con el servidor.")}setTimeout(()=>a(n,""),2e3)}function st(){a(l,{autonomous_community:"",year:"",education_level:"",activity_rate:"",employment_rate:"",unemployment_rate:""})}async function lt(){const i=`${N}/loadInitialData`;try{const e=await fetch(i);if(!e.ok)throw new Error(`Error ${e.status}`);a(n,"Datos iniciales cargados."),await k()}catch(e){console.error("[LOAD INITIAL DATA] Error:",e),a(n,"Error al cargar los datos iniciales.")}setTimeout(()=>{a(n,"")},2e3)}async function ut(){if(confirm("¿Estás seguro de que quieres eliminar todos los registros?")){try{const e=await fetch(N,{method:"DELETE"});e.status===200?(a(n,"Todos los registros han sido eliminados."),await k()):e.status===404?a(n,"No hay registros que eliminar."):a(n,"Error al eliminar")}catch(e){console.error("[DELETE] Error deleting records:",e),a(n,"Error al eliminar los registros.")}setTimeout(()=>{a(n,"")},2e3)}}async function ct(i,e,u){try{const _=await fetch(`${N}/${i}/${e}/${u}`,{method:"DELETE"});_.status===200?(a(n,`Registro de ${i} (${e}, ${u}) eliminado correctamente.`),await k()):_.status===404?a(n,"Registro no encontrado."):a(n,"Error al eliminar")}catch(_){console.error("[DELETE] Error deleting record:",_),a(n,"Error al eliminar el registro.")}setTimeout(()=>{a(n,"")},2e3)}Dt(async()=>{await k()}),At();var O=St();ft(i=>{ht.title="Datos de Empleo"});var j=m(O),B=m(j);{var mt=i=>{var e=Nt(),u=m(e,!0);c(e),F(()=>C(u,t(n))),Mt(3,e,()=>wt,()=>({duration:300})),q(i,e)};U(B,i=>{t(n)&&i(mt)})}var P=r(B,2),H=r(m(P),2),z=m(H),G=r(z,2),J=r(G,2),dt=r(J,2);c(H),c(P);var Y=r(P,2);{var pt=i=>{var e=Rt(),u=m(e);p(u);var _=r(u,2);p(_);var E=r(_,2);F(()=>{t(l),Et(()=>{})});var y=m(E);y.value=((y.__value="")==null,"");var x=r(y);x.value=(x.__value="SUP")==null?"":"SUP";var b=r(x);b.value=(b.__value="SEC")==null?"":"SEC";var M=r(b);M.value=(M.__value="INF")==null?"":"INF";var g=r(M);g.value=(g.__value="TOTAL")==null?"":"TOTAL",c(E);var w=r(E,2);p(w);var h=r(w,2);p(h);var $=r(h,2);p($);var A=r($,4);c(e),v(u,()=>t(l).autonomous_community,f=>d(l,t(l).autonomous_community=f)),v(_,()=>t(l).year,f=>d(l,t(l).year=f)),$t(E,()=>t(l).education_level,f=>d(l,t(l).education_level=f)),v(w,()=>t(l).activity_rate,f=>d(l,t(l).activity_rate=f)),v(h,()=>t(l).employment_rate,f=>d(l,t(l).employment_rate=f)),v($,()=>t(l).unemployment_rate,f=>d(l,t(l).unemployment_rate=f)),D("click",A,()=>a(R,!1)),D("submit",e,tt(nt)),q(i,e)};U(Y,i=>{t(R)&&i(pt)})}var K=r(Y,2);{var vt=i=>{var e=kt(),u=m(e);p(u);var _=r(u,2);p(_);var E=r(_,2);p(E);var y=r(E,2);p(y);var x=r(y,2);p(x);var b=r(x,2);p(b);var M=r(b,2);p(M);var g=r(M,2);p(g);var w=r(g,2);p(w);var h=r(w,2);p(h);var $=r(h,2);p($);var A=r($,2);p(A);var f=r(A,2);p(f),gt(2),c(e),v(u,()=>t(o).from,s=>d(o,t(o).from=s)),v(_,()=>t(o).to,s=>d(o,t(o).to=s)),v(E,()=>t(o).year,s=>d(o,t(o).year=s)),v(y,()=>t(o).autonomous_community,s=>d(o,t(o).autonomous_community=s)),v(x,()=>t(o).education_level,s=>d(o,t(o).education_level=s)),v(b,()=>t(o).activity_rateMin,s=>d(o,t(o).activity_rateMin=s)),v(M,()=>t(o).activity_rateMax,s=>d(o,t(o).activity_rateMax=s)),v(g,()=>t(o).employment_rateMin,s=>d(o,t(o).employment_rateMin=s)),v(w,()=>t(o).employment_rateMax,s=>d(o,t(o).employment_rateMax=s)),v(h,()=>t(o).unemployment_rateMin,s=>d(o,t(o).unemployment_rateMin=s)),v($,()=>t(o).unemployment_rateMax,s=>d(o,t(o).unemployment_rateMax=s)),v(A,()=>t(o).limit,s=>d(o,t(o).limit=s)),v(f,()=>t(o).offset,s=>d(o,t(o).offset=s)),D("submit",e,tt(it)),q(i,e)};U(K,i=>{t(S)&&i(vt)})}var Q=r(K,4),V=r(m(Q),2),W=m(V),X=m(W);Tt(X,5,()=>t(T),xt,(i,e)=>{var u=It(),_=m(u),E=m(_,!0);c(_);var y=r(_),x=m(y,!0);c(y);var b=r(y),M=m(b,!0);c(b);var g=r(b),w=m(g,!0);c(g);var h=r(g),$=m(h,!0);c(h);var A=r(h),f=m(A,!0);c(A);var s=r(A),Z=m(s),_t=r(Z,2);c(s),c(u),F(()=>{C(E,t(e).autonomous_community),C(x,t(e).year),C(M,t(e).education_level),C(w,t(e).activity_rate),C($,t(e).employment_rate),C(f,t(e).unemployment_rate)}),D("click",Z,()=>Ct(`/employment/edit/${encodeURIComponent(t(e).autonomous_community)}/${t(e).year}/${encodeURIComponent(t(e).education_level)}`)),D("click",_t,()=>ct(t(e).autonomous_community,t(e).year,t(e).education_level)),q(i,u)}),c(X),c(W),c(V),c(Q),c(j),c(O),D("click",z,ot),D("click",G,rt),D("click",J,lt),D("click",dt,ut),q(et,O),bt()}export{Yt as component};
