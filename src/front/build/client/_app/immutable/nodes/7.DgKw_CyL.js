import{t as u,h as de,a as m}from"../chunks/Cw--0ebe.js";import"../chunks/C5mLL2l5.js";import{p as fe,t as C,c as s,g as t,a as me,$ as ue,s as d,m as _,b as f,n as pe,i as R,r as n}from"../chunks/LDrxhfq1.js";import{e as W,s as z}from"../chunks/1neYngIx.js";import{i as S}from"../chunks/BG8tU1X3.js";import{e as P,i as H}from"../chunks/Cqtn9Ic4.js";import{t as V,f as U}from"../chunks/IMrtpuJV.js";import{b as q}from"../chunks/CWLJEzV_.js";import{i as ve}from"../chunks/BwztKqQM.js";import{o as he}from"../chunks/C73a-Tmm.js";var ge=u('<meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0">',1),be=u("<option> </option>"),ye=u("<p>Cargando Datos...</p>"),_e=u('<p style="background-color: rgb(247, 111, 111); padding: 10px 20px;"> </p>'),xe=u("<option> </option>"),Ce=u('<figure class="chartjs-figure svelte-xi2902"><canvas id="barChart"></canvas></figure>'),we=u(`<div><div class="article"><h3 style="font-size: 1.5em; text-transform: none;">Evolución temporal de las tasas de delitos por nivel de cibercriminalidad</h3> <p>Visualiza cómo han cambiado las tasas de delitos a lo largo del tiempo y entre distintas comunidades
						autónomas.</p> <br> <figure class="highcharts-figure svelte-xi2902"><div id="container"><!> <!></div></figure></div> <div class="article" style="margin-top: 0;"><h3 style="font-size: 1.5em; text-transform: none;">Distribución de delitos por nivel de cibercriminalidad en el año seleccionado</h3> <p>Compara el número de delitos en los distintos tipos de cibercriminalidad
						durante un año específico en la comunidad autónoma seleccionada, permitiendo analizar la
						distribución entre Ofensas criminales, ciberseguridad y Investigados arrestado.</p> <div class="graph-container" style="background: none; box-shadow: none; padding: 0.5em 0; margin-top: -1em; font-size: 90%;"><h3 style="font-size: 1.2em; text-transform: none; font-weight: 500;">Selecciona el Año:</h3> <select class="custom-select"><option disabled>Selecciona un año</option><!></select></div> <!></div></div>`),Ae=u('<div class="wrapper"><div class="container"><h2>Gráficas de cybercrime-data</h2> <hr style="width: 55em; animation: loadHrGraph 1s; transition: all 0.3s ease;"> <div class="graph-container" style="background: none; box-shadow: none; padding: 0.5em 0;"><h3>Selecciona la comunidad autónoma:</h3> <select class="custom-select" style="width: 150%;"><option disabled>Selecciona una comunidad</option><!></select></div> <!></div></div>');function Be(Y,J){fe(J,!1);let K="/api/v1/cybercrime-data",g=[],b=_([]),D=_(!0),p=_(""),B=_(!1);const Q=["Andalucia","Aragon","Asturias","Baleares","Canarias","Cantabria","Castilla-La Mancha","Castilla y Leon","Cataluña","Comunitat Valenciana","Extremadura","Galicia","Madrid","Murcia","Navarra","Pais Vasco","La Rioja","Ceuta y Melilla","TOTAL"];let x=_(""),v=_("");function X(){f(p,""),f(B,!0),M()}async function M(){f(D,!0),f(p,"");const a=`${K}?autonomous_community=${encodeURIComponent(t(v))}`;try{console.log(`Solicitando datos a: ${a}`);const e=await fetch(a,{method:"GET"});if(!e.ok)throw new Error(`Error en la respuesta: ${e.status}`);g=await e.json(),console.log(`Datos recibidos: ${g.length} registros para ${t(v)}`),f(b,[...new Set(g.map(l=>l.year))].sort()),Z(),N()}catch(e){console.error(`ERROR al obtener datos de ${a}: ${e}`),f(p,`Error al cargar datos: ${e.message}`)}finally{f(D,!1)}}function Z(){if(g.length===0){f(p,"No hay datos disponibles para la comunidad seleccionada");return}const a=[],e=[],r=[];t(b).forEach(l=>{const i=g.find(E=>String(E.year)===String(l));a.push((i==null?void 0:i.criminal_ofense)??0),e.push((i==null?void 0:i.cybersecurity)??0),r.push((i==null?void 0:i.arrested_investigated)??0)}),Highcharts.chart("container",{chart:{type:"area",backgroundColor:"#052a42",spacing:[30,25,30,25]},title:{text:"Evolución de las Tasas de Delitos",align:"left",style:{color:"#fff",fontWeight:"800"}},subtitle:{text:`Delitos en ${t(v)}`,align:"left",style:{color:"#fff",fontWeight:"bold"}},yAxis:{title:{text:"Número de Delitos",style:{color:"#fff",fontWeight:"800"}},labels:{style:{color:"#fff"}},gridLineColor:"#ffffff33"},xAxis:{categories:t(b),title:{text:"AÑO",style:{color:"#fff",fontWeight:"800"}},labels:{style:{color:"#fff"}}},legend:{layout:"vertical",align:"right",verticalAlign:"middle",itemStyle:{color:"#fff"}},plotOptions:{area:{fillOpacity:.5,marker:{enabled:!1}},series:{label:{connectorAllowed:!1}}},series:[{name:"Ofensa criminal",data:a,color:"#36A2EB"},{name:"Ciberseguridad",data:e,color:"#FFCE56"},{name:"Investigados Arrestados",data:r,color:"#FF6384"}],responsive:{rules:[{condition:{maxWidth:500},chartOptions:{legend:{layout:"horizontal",align:"center",verticalAlign:"bottom"}}}]}})}let w;function N(){var l;const a=t(x)||Math.max(...t(b)),e=g.find(i=>Number(i.year)===Number(a));if(!e)return;const r=(l=document.getElementById("barChart"))==null?void 0:l.getContext("2d");r&&(w&&(w.destroy(),w=null),w=new Chart(r,{type:"pie",data:{labels:["Ofensa Criminal","Ciberseguridad","Investigados arrestados"],datasets:[{label:`${t(v)} - ${a}`,data:[e.criminal_ofense??0,e.cybersecurity??0,e.arrested_investigated??0],backgroundColor:["#36A2EB","#FFCE56","#FF6384"]}]},options:{responsive:!0,plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:"Distribución de delitos por nivel de cibercriminalidad",color:"#fff",font:{size:20,weight:"bold",family:"Arial"}}},scales:{x:{ticks:{color:"#fff"},title:{display:!0,text:"Nivel de cibercriminalidad",color:"#fff"}},y:{ticks:{color:"#fff"},title:{display:!0,text:"Número de Delitos",color:"#fff"}}}}}))}function y(a){return new Promise((e,r)=>{if(document.querySelector(`script[src="${a}"]`))return e();const i=document.createElement("script");i.src=a,i.onload=e,i.onerror=r,document.head.appendChild(i)})}he(async()=>{try{await y("https://code.highcharts.com/highcharts.js"),await y("https://code.highcharts.com/modules/series-label.js"),await y("https://code.highcharts.com/modules/exporting.js"),await y("https://code.highcharts.com/modules/export-data.js"),await y("https://code.highcharts.com/modules/accessibility.js"),await y("https://cdn.jsdelivr.net/npm/chart.js"),await M()}catch(a){f(p,`Error cargando scripts de HighCharts: ${a}`),console.error(a)}}),ve();var j=Ae();de(a=>{var e=ge();ue.title="Graphs - Cybercrime Data",pe(2),m(a,e)});var T=s(j),k=d(s(T),4),A=d(s(k),2);C(()=>{t(v),R(()=>{})});var O=s(A);O.value=O.__value="";var ee=d(O);P(ee,1,()=>Q,H,(a,e)=>{var r=be(),l={},i=s(r,!0);n(r),C(()=>{l!==(l=t(e))&&(r.value=(r.__value=t(e))??""),z(i,t(e))}),m(a,r)}),n(A),n(k);var ae=d(k,2);{var te=a=>{var e=we(),r=s(e),l=d(s(r),6),i=s(l),E=s(i);{var ie=o=>{var c=ye();m(o,c)};S(E,o=>{t(D)&&o(ie)})}var re=d(E,2);{var oe=o=>{var c=_e(),h=s(c,!0);n(c),C(()=>z(h,t(p))),m(o,c)};S(re,o=>{t(p)&&o(oe)})}n(i),n(l),n(r);var G=d(r,2),F=d(s(G),4),$=d(s(F),2);C(()=>{t(x),R(()=>{t(b)})});var I=s($);I.value=I.__value="";var se=d(I);P(se,1,()=>t(b),H,(o,c)=>{var h=xe(),L={},ce=s(h,!0);n(h),C(()=>{L!==(L=t(c))&&(h.value=(h.__value=t(c))??""),z(ce,t(c))}),m(o,h)}),n($),n(F);var ne=d(F,2);{var le=o=>{var c=Ce();V(3,c,()=>U),m(o,c)};S(ne,o=>{t(x)&&o(le)})}n(G),n(e),q($,()=>t(x),o=>f(x,o)),W("change",$,N),V(3,e,()=>U,()=>({duration:400})),m(a,e)};S(ae,a=>{t(B)&&a(te)})}n(T),n(j),q(A,()=>t(v),a=>f(v,a)),W("change",A,X),m(Y,j),me()}export{Be as component};
