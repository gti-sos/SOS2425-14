import{t as E,h as za,a as w}from"../chunks/Cw--0ebe.js";import"../chunks/C5mLL2l5.js";import{p as Ra,t as La,a as Oa,$ as qa,s as n,c as d,n as _,g as m,m as la,r as f,b as h}from"../chunks/LDrxhfq1.js";import{i as B}from"../chunks/BG8tU1X3.js";import{s as C}from"../chunks/crEyKr2S.js";import{t as y,f as v}from"../chunks/IMrtpuJV.js";import{i as Ha}from"../chunks/BwztKqQM.js";import{o as Wa}from"../chunks/C73a-Tmm.js";var Ua=E('<meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0">',1),Va=E('<p style="color: #fff; text-align: center; font-weight: bold;">Cargando datos...</p>'),Ja=E('<p style="color: #fff; text-align: center; font-weight: bold;">Cargando datos...</p>'),Xa=E('<p style="color: #fff; text-align: center; font-weight: bold;">Cargando datos combinados...</p>'),Ya=E('<p style="color: #fff; text-align: center; font-weight: bold;">Cargando datos...</p>'),Ka=E(`<div class="wrapper"><div class="container"><h2 style="text-align: center;">Integraciones <br><i>Francisco Javier</i></h2> <hr style="width: 55em; animation: loadHrGraph 1s; transition: all 0.3s ease;"> <div><div class="article" style="margin-top: 0;"><h3 style="font-size: 1.5em; text-transform: none;">Relación entre Uso del Suelo y Formación Profesional (2021)</h3> <p>Este gráfico tipo burbuja relaciona el uso del suelo (suelo desnudo y superficie arbolada) con 
					la tasa media de matriculación en Formación Profesional en provincias seleccionadas de Andalucía.
					El eje X representa la superficie de suelo, el eje Y la superficie arbolada y el tamaño de cada burbuja
					indica la tasa de FP promedio.</p> <a style="color: #fff;" target="_blank"><i>G15 - ocupied-grand-stats</i></a> <a style="color: #fff; margin-left:1em;" target="_blank"><i>G14-education-data</i></a> <figure class="chartjs-figure svelte-47s6as"><!> <canvas id="g15EduChart"></canvas></figure></div> <div class="article" style="margin-top: 1em;"><h3 style="font-size: 1.5em; text-transform: none;">Accidentes con Animales por Grupo (2023)</h3> <p>Este gráfico muestra cuántos accidentes de tráfico con animales estuvieron relacionados
					con cada grupo animal durante el año 2023. Permite identificar qué tipos de fauna están
					más implicados en este tipo de incidentes según los registros recopilados a nivel
					nacional.</p> <a style="color: #fff;" target="_blank"><i>G20 - accidents-with-animals</i></a> <figure class="chartjs-figure svelte-47s6as"><!> <canvas id="20Chart"></canvas></figure></div> <div class="article"><h3 style="font-size: 1.5em;">Consumo Energético vs Tasa de Matriculación en FP (2021)</h3> <p>Este gráfico compara el consumo total de energía en distintas comunidades autónomas con la
					tasa de matriculación en Formación Profesional. Permite observar si existe alguna relación
					entre desarrollo energético y acceso a estudios técnicos.</p> <a style="color: #fff;" target="_blank"><i>G12 - annual-consumptions</i></a> <a style="color: #fff; margin-left:1em;" target="_blank"><i>G14-education-data</i></a> <figure class="chartjs-figure svelte-47s6as"><!> <canvas id="combinedChart"></canvas></figure></div> <div class="article" style="margin-top: 0;"><h3 style="font-size: 1.5em; text-transform: none;">Superficie Actual de los Parques Nacionales</h3> <p>Este gráfico muestra la superficie actual en hectáreas de los distintos parques nacionales
					de España. Permite comparar el tamaño de cada parque natural y analizar cómo varía su
					extensión a lo largo del territorio nacional.</p> <a style="color: #fff;" target="_blank"><i>G13 - national-parks</i></a> <figure class="chartjs-figure svelte-47s6as"><!> <canvas id="13Chart"></canvas></figure></div> <div class="article" style="margin-top: 2em;"><h3 style="font-size: 1.5em; text-transform: none;">Comparativa Climática de Varias Ciudades (Weather)</h3> <p>Este gráfico de burbujas permite comparar en tiempo real la temperatura, humedad y
					velocidad del viento en cinco ciudades españolas: Sevilla, Madrid, Barcelona, Valencia y
					Bilbao.</p> <a style="color: #fff;" href="https://openweathermap.org/current" target="_blank"><i>API externa - OpenWeatherMap</i></a> <figure class="chartjs-figure svelte-47s6as"><canvas id="externalChart"></canvas></figure></div> <div class="article" style="margin-top: 0;"><h3 style="font-size: 1.5em; text-transform: none;">Temperatura Horaria en Sevilla (AEMET)</h3> <p>Este gráfico de dispersión representa las temperaturas registradas en distintas horas del
					día en Sevilla, según los datos proporcionados por la Agencia Estatal de Meteorología.
					Permite visualizar cómo varía la temperatura a lo largo de la jornada.</p> <a style="color: #fff;" href="https://www.aemet.es/es/eltiempo/prediccion/municipios/sevilla-id41091" target="_blank"><i>AEMET - Predicción Sevilla</i></a> <figure class="chartjs-figure svelte-47s6as"><p id="mensaje" style="color: #fff; text-align: center; font-weight: bold;"></p> <canvas id="aemetChart"></canvas></figure></div> <div class="article" style="margin-top: 0;"><h3 style="font-size: 1.5em; text-transform: none;">Comparativa de Descripciones en Publicaciones APOD (NASA)</h3> <p>Este gráfico muestra la longitud de las descripciones en los resultados de imágenes y
					vídeos de la NASA (Astronomy Picture of the Day), permitiendo una visión del nivel de
					detalle en cada contenido.</p> <a style="color: #fff;" href="https://images-api.nasa.gov" target="_blank"><i>NASA Images API</i></a> <figure class="chartjs-figure svelte-47s6as"><p id="mensaje-nasa" style="color: white; text-align: center; margin-top: 1em;"></p> <canvas id="nasaChart"></canvas></figure></div></div></div></div>`);function ne(ca,da){Ra(da,!1);const Z="https://sos2425-15.onrender.com/api/v1/ocupied-grand-stats/",k="https://sos2425-20.onrender.com/api/v1/accidents-with-animals",N="https://sos2425-12.onrender.com/api/v1/annual-consumptions",S="https://sos2425-13.onrender.com/api/v2/national-parks";let b=la("/api/v1/education-data"),M=[],x=[],g=la(!0);async function fa(){h(g,!0);try{console.log(`Solicitando datos a: ${Z}`);const a=await fetch("/api/g15");if(!a.ok)throw new Error("Error al obtener datos de G15");const e=await a.json();console.log(`Solicitando datos a: ${m(b)}`);const t=await fetch(m(b));if(!t.ok)throw new Error("Error al obtener datos de education-data");const r=await t.json(),o=2021,s=["cadiz","sevilla","granada"].map(i=>{const l=e.find(A=>A.province.toLowerCase()===i&&A.year===o),c=i==="cadiz"||i==="sevilla"||i==="granada"?"Andalucia":null,p=r.find(A=>A.autonomous_community.toLowerCase()===c.toLowerCase()&&A.year===o),Ta=p?(p.basic_fp+p.middle_grade+p.higher_grade)/3:0;return{province:i,x:(l==null?void 0:l.ground)??0,y:(l==null?void 0:l.wooded)??0,r:Ta}});console.log(`Datos recibidos: ${s.length} registros`),ua(s)}catch(a){console.error("Error combinando datos G15 + Education:",a)}finally{h(g,!1)}}let j;function ua(a){var t;const e=(t=document.getElementById("g15EduChart"))==null?void 0:t.getContext("2d");e&&(j&&(j.destroy(),j=null),j=new Chart(e,{type:"bubble",data:{datasets:a.map(r=>({label:r.province.toUpperCase(),data:[{x:r.x,y:r.y,r:r.r}],backgroundColor:"rgba(255, 99, 132, 0.5)"}))},options:{responsive:!0,plugins:{title:{display:!0,text:"Relación entre Suelo y Tasa FP (2021)",color:"#fff",font:{size:20,weight:"bold"}},legend:{labels:{color:"#fff"}}},scales:{x:{title:{display:!0,text:"Superficie de Suelo (ground)",color:"#fff"},ticks:{color:"#fff"}},y:{title:{display:!0,text:"Superficie Arbolada (wooded)",color:"#fff"},ticks:{color:"#fff"}}}}}))}async function pa(){h(g,!0);try{console.log(`Solicitando datos a: ${k}`);const a=await fetch(k,{method:"GET",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`Error en la respuesta: ${a.status}`);M=await a.json(),console.log(`Datos recibidos: ${M.length} registros`),ga()}catch(a){console.error(`ERROR al obtener datos de ${k}: ${a}`),`${a.message}`}finally{h(g,!1)}}let D;function ga(){var s;const e=M.filter(i=>Number(i.anyo)===2023),t={};for(const i of e){const l=i.animal_group;t[l]=(t[l]||0)+1}const r=Object.keys(t).map(i=>`Grupo ${i}`),o=Object.values(t),u=(s=document.getElementById("20Chart"))==null?void 0:s.getContext("2d");u&&(D&&(D.destroy(),D=null),D=new Chart(u,{type:"polarArea",data:{labels:r,datasets:[{label:"Número de accidentes por grupo animal",data:o,backgroundColor:["#36A2EB","#FFCE56","#FF6384","#4BC0C0","#9966FF","#00D98B"]}]},options:{responsive:!0,plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:"Accidentes con Animales por Grupo (2023)",color:"#fff",font:{size:20,weight:"bold"}}}}}))}async function ma(){try{console.log(`Solicitando datos a: ${N}`);const a=await fetch(N);if(!a.ok)throw new Error("Error al obtener datos de G12");const e=await a.json();console.log(`Solicitando datos a: ${m(b)}`);const t=await fetch(m(b));if(!t.ok)throw new Error("Error al obtener datos de education-data");const r=await t.json(),o=2021,s=["Andalucia","Madrid","Cataluña","Galicia","Comunitat Valenciana"].map(i=>{const l=e.find(p=>p.aacc.toLowerCase().includes(i.toLowerCase())&&p.year===o),c=r.find(p=>p.autonomous_community.toLowerCase().includes(i.toLowerCase())&&p.year===o);return{comunidad:i,consumo:(l==null?void 0:l.total_consumption)??0,tasaMatriculacion:(((c==null?void 0:c.basic_fp)??0)+((c==null?void 0:c.middle_grade)??0)+((c==null?void 0:c.higher_grade)??0))*1e4}});console.log(`Datos recibidos: ${s.length} registros`),ha(s)}catch(a){console.error("Error integrando G12 + Education:",a)}finally{}}let I;function ha(a){var u;const e=(u=document.getElementById("combinedChart"))==null?void 0:u.getContext("2d");if(!e)return;I&&(I.destroy(),I=null);const t=a.map(s=>s.comunidad),r=a.map(s=>s.consumo),o=a.map(s=>s.tasaMatriculacion);I=new Chart(e,{type:"bar",data:{labels:t,datasets:[{label:"Consumo Energético (MWh)",data:r,backgroundColor:"rgba(75, 192, 192, 0.6)",yAxisID:"y"},{label:"Tasa de Matriculación en FP (esc. ×10⁴)",data:o,backgroundColor:"rgba(255, 99, 132, 0.6)",yAxisID:"y1"}]},options:{responsive:!0,plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:"Consumo Energético vs Tasa de Matriculación en FP (2021)",color:"#fff",font:{size:20}}},scales:{y:{type:"linear",position:"left",ticks:{color:"#fff"}},y1:{type:"linear",position:"right",grid:{drawOnChartArea:!1},ticks:{color:"#fff"}}}}})}async function ya(){h(g,!0);try{console.log(`Solicitando datos a: ${S}`);const a=await fetch(S,{method:"GET",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`Error en la respuesta: ${a.status}`);x=await a.json(),console.log(`Datos recibidos: ${x.length} parques`),va()}catch(a){console.error(`ERROR al obtener datos de ${S}: ${a}`),`${a.message}`}finally{h(g,!1)}}let P;function va(){var r;if(!x.length)return;const a=(r=document.getElementById("13Chart"))==null?void 0:r.getContext("2d");if(!a)return;P&&(P.destroy(),P=null);const e=x.map(o=>o.national_park),t=x.map(o=>o.current_area);P=new Chart(a,{type:"bar",data:{labels:e,datasets:[{label:"Superficie actual (ha)",data:t,backgroundColor:"#36A2EB"}]},options:{responsive:!0,plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:"Superficie Actual de los Parques Nacionales",color:"#fff",font:{size:20,weight:"bold",family:"Arial"}}},scales:{x:{ticks:{color:"#fff"},title:{display:!0,text:"Parque Nacional",color:"#fff"}},y:{ticks:{color:"#fff"},title:{display:!0,text:"Hectáreas",color:"#fff"}}}}})}let G=[];async function ba(){G=[];try{console.log("Solicitando datos a: /api/openweather");const a=await fetch("/api/openweather");if(!a.ok)throw new Error("Error al obtener datos del servidor proxy");const e=await a.json();for(const t of e)G.push({label:t.name,data:[{x:t.main.temp,y:t.main.humidity,r:Math.max(3,t.wind.speed*2)}],backgroundColor:wa(t.name)});console.log(`Datos recibidos: ${G.length} registros`),Ca()}catch(a){console.error("Error al obtener datos del clima:",a)}}function wa(a){return{Sevilla:"#FF6384",Madrid:"#36A2EB",Barcelona:"#FFCE56",Valencia:"#4BC0C0",Bilbao:"#9966FF"}[a]||"#aaa"}let T;function Ca(){var e;const a=(e=document.getElementById("externalChart"))==null?void 0:e.getContext("2d");a&&(T&&T.destroy(),T=new Chart(a,{type:"bubble",data:{datasets:G},options:{responsive:!0,plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:"Condiciones climáticas en ciudades de España",color:"#fff",font:{size:18,weight:"bold"}}},scales:{x:{title:{display:!0,text:"Temperatura (°C)",color:"#fff"},ticks:{color:"#fff"}},y:{title:{display:!0,text:"Humedad (%)",color:"#fff"},ticks:{color:"#fff"}}}}}))}let z=[];async function Ea(){h(g,!0);try{console.log("Solicitando datos a: /api/aemet");const a=await fetch("/api/aemet");if(!a.ok)throw new Error("Error al obtener los datos del servidor proxy");z=await a.json(),console.log(`Datos recibidos: ${z.length} registros`),xa(z)}catch(a){console.error("Error cargando datos AEMET:",a)}finally{h(g,!1)}}let $;function xa(a){var o,u,s,i,l,c;const e=(l=(i=(s=(u=(o=a==null?void 0:a[0])==null?void 0:o.prediccion)==null?void 0:u.dia)==null?void 0:s[0])==null?void 0:i.temperatura)==null?void 0:l.dato;if(!e||!Array.isArray(e)||e.length===0){console.warn("No hay datos de temperatura disponibles"),mensaje.textContent="No hay datos de temperatura disponibles.";return}const t=e.map(p=>({x:Number(p.hora),y:Number(p.value)})),r=(c=document.getElementById("aemetChart"))==null?void 0:c.getContext("2d");r&&($&&($.destroy(),$=null),$=new Chart(r,{type:"scatter",data:{datasets:[{label:"Temperatura horaria (°C)",data:t,backgroundColor:"#36A2EB"}]},options:{responsive:!0,plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:"Temperatura Horaria en Sevilla",color:"#fff",font:{size:20,weight:"bold"}}},scales:{x:{title:{display:!0,text:"Hora",color:"#fff"},ticks:{color:"#fff"},type:"linear",position:"bottom"},y:{title:{display:!0,text:"Temperatura (°C)",color:"#fff"},ticks:{color:"#fff"}}}}}),mensaje.textContent="")}let R=[];async function Aa(){const a=document.getElementById("mensaje-nasa");a&&(a.textContent="Cargando datos...");try{console.log("Solicitando datos a: /api/nasa"),R=await(await fetch("/api/nasa")).json(),console.log(`Datos recibidos: ${R.length} registros`),_a(R),a&&(a.textContent="")}catch(e){console.error("Error al obtener datos de NASA:",e),a&&(a.textContent="Error al obtener datos de NASA.")}}let F;function _a(a){var u;const e=a.slice(0,5),t=e.map(s=>s.title),r=e.map(s=>s.explanation.length),o=(u=document.getElementById("nasaChart"))==null?void 0:u.getContext("2d");o&&(F&&(F.destroy(),F=null),F=new Chart(o,{type:"bar",data:{labels:t,datasets:[{label:"Longitud de la explicación",data:r,backgroundColor:"#36A2EB"}]},options:{indexAxis:"y",responsive:!0,plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:"Longitud de las descripciones en APOD (NASA)",color:"#fff",font:{size:20,weight:"bold"}}},scales:{x:{ticks:{color:"#fff"},title:{display:!0,text:"Número de caracteres",color:"#fff"}},y:{ticks:{color:"#fff"}}}}}))}function ka(a){return new Promise((e,t)=>{if(document.querySelector(`script[src="${a}"]`))return e();const o=document.createElement("script");o.src=a,o.onload=e,o.onerror=t,document.head.appendChild(o)})}Wa(async()=>{try{await ka("https://cdn.jsdelivr.net/npm/chart.js"),await fa(),await pa(),await ma(),await ya(),await ba(),await Ea(),await Aa()}catch(a){console.error(a)}}),Ha();var L=Ka();za(a=>{var e=Ua();qa.title="Integrations - Francisco Javier",_(2),w(a,e)});var aa=d(L),O=n(d(aa),4),q=d(O),ea=n(d(q),4);C(ea,"href",Z);var ta=n(ea,2),H=n(ta,2),Sa=d(H);{var ja=a=>{var e=Va();w(a,e)};B(Sa,a=>{m(g)&&a(ja)})}_(2),f(H),f(q);var W=n(q,2),oa=n(d(W),4);C(oa,"href",k);var U=n(oa,2),Da=d(U);{var Ia=a=>{var e=Ja();w(a,e)};B(Da,a=>{m(g)&&a(Ia)})}_(2),f(U),f(W);var V=n(W,2),ra=n(d(V),4);C(ra,"href",N);var sa=n(ra,2),J=n(sa,2),Pa=d(J);{var Ga=a=>{var e=Xa();w(a,e)};B(Pa,a=>{m(g)&&a(Ga)})}_(2),f(J),f(V);var X=n(V,2),na=n(d(X),4);C(na,"href",S);var Y=n(na,2),$a=d(Y);{var Fa=a=>{var e=Ya();w(a,e)};B($a,a=>{m(g)&&a(Fa)})}_(2),f(Y),f(X);var K=n(X,2),Ba=n(d(K),6);f(K);var Q=n(K,2),Na=n(d(Q),6);f(Q);var ia=n(Q,2),Ma=n(d(ia),6);f(ia),f(O),f(aa),f(L),La(()=>{C(ta,"href",m(b)),C(sa,"href",m(b))}),y(3,H,()=>v),y(3,U,()=>v),y(3,J,()=>v),y(3,Y,()=>v),y(3,Ba,()=>v),y(3,Na,()=>v),y(3,Ma,()=>v),y(3,O,()=>v,()=>({duration:400})),w(ca,L),Oa()}export{ne as component};
