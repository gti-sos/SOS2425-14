import{t as x,h as gt,a as C}from"../chunks/Cw--0ebe.js";import"../chunks/C5mLL2l5.js";import{p as yt,t as bt,a as vt,$ as Ct,s as c,c as f,n as L,g as m,m as V,r as p,b as W}from"../chunks/LDrxhfq1.js";import{i as H}from"../chunks/BG8tU1X3.js";import{s as w}from"../chunks/crEyKr2S.js";import{t as g,f as y}from"../chunks/IMrtpuJV.js";import{i as wt}from"../chunks/BwztKqQM.js";import{o as xt}from"../chunks/C73a-Tmm.js";var _t=x('<meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0">',1),Et=x('<p style="color: #fff; text-align: center; font-weight: bold;">Cargando datos...</p>'),Ft=x('<p style="color: #fff; text-align: center; font-weight: bold;">Cargando datos...</p>'),kt=x(`<div class="wrapper"><div class="container"><h2 style="text-align: center;">Integraciones <br><i>Pablo</i></h2> <hr style="width: 55em; animation: loadHrGraph 1s; transition: all 0.3s ease;"> <div><div class="article" style="margin-top: 0;"><h3 style="font-size: 1.5em; text-transform: none;">Relación entre Precipitación y Cibercriminalidad (2021)</h3> <p>Este gráfico de columnas relaciona la precipitación anual con la tasa de delitos de cibercrimen en
                    provincias seleccionadas de Andalucía.</p> <a style="color: #fff;" target="_blank"><i>G15 - precipitation-stats</i></a> <a style="color: #fff; margin-left:1em;" target="_blank"><i>G14-cybercrime-data</i></a> <figure class="chartjs-figure svelte-wpvc02"><!> <div id="g15CrimeChart"></div></figure></div> <div class="article" style="margin-top: 3em;"><h3 style="font-size: 1.5em; text-transform: none;">Relación entre Infracciones y Cibercriminalidad por Comunidad (2023)</h3> <p>Este gráfico de barras muestra la relación entre las infracciones (ITV) y los delitos de cibercriminalidad por comunidades en el año 2023.</p> <a style="color: #fff;" target="_blank"><i>G20 - fines-data</i></a> <a style="color: #fff; margin-left:1em;" target="_blank"><i>G14-cybercrime-data</i></a> <figure class="chartjs-figure svelte-wpvc02"><!> <div id="combinedChart"></div></figure></div> <div class="article" style="margin-top: 2em;"><h3 style="font-size: 1.5em; text-transform: none;">Noticias</h3> <p>Este gráfico de burbujas permite comparar en tiempo real las noticias.</p> <a style="color: #fff;" href="https://openweathermap.org/current" target="_blank"><i>API externa - NewsApi</i></a> <figure class="chartjs-figure svelte-wpvc02"><canvas id="externalChart"></canvas></figure></div> <div class="article" style="margin-top: 2em;"><h3 style="font-size: 1.5em; text-transform: none;">Publicaciones de JSONPlaceholder</h3> <p>Este gráfico de barras muestra el número de palabras en el título de cada publicación de JSONPlaceholder.</p> <a style="color: #fff;" href="https://jsonplaceholder.typicode.com" target="_blank"><i>API externa - JSONPlaceholder</i></a> <figure class="chartjs-figure svelte-wpvc02"><canvas id="postChart"></canvas></figure></div> <div class="article" style="margin-top: 2em;"><h3 style="font-size: 1.5em; text-transform: none;">Astronautas en el espacio</h3> <p>Este gráfico de barras muestra el número de astronautas en cada nave espacial actualmente en órbita.</p> <a style="color: #fff;" href="http://api.open-notify.org/astros.json" target="_blank"><i>API externa - Open Notify</i></a> <figure class="chartjs-figure svelte-wpvc02"><canvas id="astronautChart"></canvas></figure></div></div></div></div>`);function Lt(Y,q){yt(q,!1);const $="https://sos2425-15.onrender.com/api/v1/precipitation-stats/",_="https://sos2425-20.onrender.com/api/v1/fines/";let h=V("/api/v1/cybercrime-data"),v=V(!0);async function U(){W(v,!0);try{console.log(`Solicitando datos a: ${$}`);const t=await fetch("/api/g15precipitation");if(!t.ok)throw new Error("Error al obtener datos de G15");const e=await t.json();console.log(`Solicitando datos a: ${m(h)}`);const r=await fetch(m(h));if(!r.ok)throw new Error("Error al obtener datos de cybercrime-data");const s=await r.json(),a=2020,n=["almería","granada","jaén"].map(o=>{const i=e.find(b=>b.province.toLowerCase()===o&&b.year===a),d=o==="almería"||o==="granada"||o==="jaén"?"Andalucia":null,u=s.find(b=>b.autonomous_community.toLowerCase()===(d==null?void 0:d.toLowerCase())&&b.year===a),ht=u?u.cybersecurity/1e4:0;return{province:o,x:(i==null?void 0:i.annual_precipitation)??0,y:(i==null?void 0:i.deviation)??0,r:ht}});console.log(`Datos combinados: ${n.length} registros`),K(n)}catch(t){console.error("Error combinando datos G15 + Criminalidad:",t)}finally{W(v,!1)}}function K(t){Highcharts.chart("g15CrimeChart",{chart:{type:"column",backgroundColor:"#052a42"},title:{text:"Relación entre Precipitación y Cibercriminalidad (2020)",style:{color:"#fff",fontWeight:"bold"}},xAxis:{categories:t.map(e=>e.province),title:{text:"Provincias",style:{color:"#fff"}},labels:{style:{color:"#fff"}}},yAxis:{min:0,title:{text:"Precipitación Anual (mm)",style:{color:"#fff"}},labels:{style:{color:"#fff"}}},tooltip:{pointFormat:"Precipitación: {point.y} mm, Tasa de Cibercriminalidad: {point.r}",style:{color:"#fff"}},series:[{name:"Provincias",data:t.map(e=>({name:e.province,y:e.x,r:e.r})),color:"#36a2eb",dataLabels:{enabled:!0,format:"{point.y} mm",style:{color:"#fff",fontWeight:"bold"}}}],legend:{itemStyle:{color:"#fff"}}})}async function Q(){try{console.log(`Solicitando datos a: ${_}`);const t=await fetch(_);if(!t.ok)throw new Error("Error al obtener datos de API_G20");const e=await t.json();console.log(`Solicitando datos a: ${m(h)}`);const r=await fetch(m(h));if(!r.ok)throw new Error("Error al obtener datos de API_CYBERCRIME");const s=await r.json(),a=2023,n=["Madrid"].map(o=>{const i=e.find(u=>u.city.toLowerCase().includes(o.toLowerCase())&&u.year===a),d=s.find(u=>u.autonomous_community.toLowerCase().includes(o.toLowerCase())&&u.year===a);return{comunidad:o,fines:i?i.itv:0,cybercrime:d?d.criminal_ofense:0}});console.log(`Datos combinados: ${n.length} registros`),X(n)}catch(t){console.error("Error al combinar datos de fines y cybercrime:",t)}finally{}}function X(t){Highcharts.chart("combinedChart",{chart:{type:"bar",backgroundColor:"#052a42"},title:{text:"Infracciones ITV vs Cibercrimen en Madrid (2023)",style:{color:"#fff",fontWeight:"bold"}},xAxis:{categories:["Madrid"],title:{text:null},labels:{style:{color:"#fff"}}},yAxis:{min:0,title:{text:"Cantidad",style:{color:"#fff"}},labels:{style:{color:"#fff"}}},legend:{reversed:!0,itemStyle:{color:"#fff"}},plotOptions:{series:{stacking:"normal",dataLabels:{enabled:!0,style:{color:"#fff",fontWeight:"bold"}}}},tooltip:{shared:!0,style:{color:"#fff"}},series:[{name:"Cibercrimen",data:t.map(e=>e.cybercrime),color:"#ff6384"},{name:"Infracciones ITV",data:t.map(e=>e.fines),color:"#36a2eb"}]})}async function Z(){try{console.log("Solicitando datos a: /api/newsapi");const t=await fetch("/api/newsapi");if(!t.ok)throw new Error("Error al obtener datos del servidor proxy");const e=await t.json(),r=[],s=[],a=[];for(const l of e)for(const n of l.articles){const o=n.title,i=o.split(" ").length;r.push(o),s.push(i),a.push(tt(n.source.name))}console.log(`Noticias procesadas: ${r.length}`),et(r,s,a)}catch(t){console.error("Error al obtener datos de las noticias:",t)}}function tt(t){return{"BBC News":"#FF6384",CNN:"#36A2EB",Reuters:"#FFCE56",TechCrunch:"#4BC0C0",ESPN:"#9966FF"}[t]||"#aaa"}let E;function et(t,e,r){var a;const s=(a=document.getElementById("externalChart"))==null?void 0:a.getContext("2d");s&&(E&&E.destroy(),E=new Chart(s,{type:"bar",data:{labels:t,datasets:[{label:"Nº de palabras en el título",data:e,backgroundColor:r}]},options:{indexAxis:"y",responsive:!0,plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:"Cantidad de palabras por título de noticia",color:"#fff",font:{size:18,weight:"bold"}}},scales:{x:{title:{display:!0,text:"Número de palabras",color:"#fff"},ticks:{color:"#fff"}},y:{ticks:{color:"#fff",callback(l,n){const o=this.getLabelForValue(n);return o.length>60?o.slice(0,57)+"...":o}}}}}}))}async function at(){try{console.log("Solicitando datos a: /api/jsonplaceholder");const t=await fetch("/api/jsonplaceholder");if(!t.ok)throw new Error("Error al obtener datos del servidor proxy");const r=(await t.json()).slice(0,10),s=[],a=[],l=[];for(const n of r){const o=n.title,i=o.split(" ").length;s.push(o),a.push(i),l.push(ot(n.id))}console.log(`Posts procesados: ${s.length}`),rt(s,a,l)}catch(t){console.error("Error al obtener los datos de JSONPlaceholder:",t)}}function ot(t){const e=["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF5733","#C70039","#900C3F","#581845"];return e[t%e.length]}let F;function rt(t,e,r){var a;const s=(a=document.getElementById("postChart"))==null?void 0:a.getContext("2d");s&&(F&&F.destroy(),F=new Chart(s,{type:"bar",data:{labels:t,datasets:[{label:"Nº de palabras en el cuerpo",data:e,backgroundColor:r}]},options:{indexAxis:"y",responsive:!0,plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:"Cantidad de palabras en los cuerpos de posts",color:"#fff",font:{size:18,weight:"bold"}}},scales:{x:{title:{display:!0,text:"Número de palabras",color:"#fff"},ticks:{color:"#fff"}},y:{ticks:{color:"#fff",callback(l,n){const o=this.getLabelForValue(n);return o.length>60?o.slice(0,57)+"...":o}}}}}}))}async function st(){try{console.log("Solicitando datos a: /api/opennotify");const t=await fetch("/api/opennotify",{method:"GET"});if(!t.ok)throw new Error("Error al obtener datos del servidor proxy");const e=await t.json(),r=[],s=[],a=[],l={};for(const i of e.people){r.push(i.name);const d=i.craft;l[d]=(l[d]||0)+1,a.push(it(d))}const n=Object.keys(l),o=Object.values(l);console.log(`Astronautas procesados: ${r.length}`),nt(n,o,a)}catch(t){console.error("Error al obtener los datos de astronautas:",t)}}let k;function nt(t,e,r){var a;const s=(a=document.getElementById("astronautChart"))==null?void 0:a.getContext("2d");s&&(k&&k.destroy(),k=new Chart(s,{type:"doughnut",data:{labels:t,datasets:[{label:"Número de astronautas por nave",data:e,backgroundColor:r}]},options:{responsive:!0,plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:"Distribución de astronautas por nave",color:"#fff",font:{size:18,weight:"bold"}}}}}))}function it(t){return{ISS:"#FF6384",Tiangong:"#FFC300"}[t]||"#FFCE56"}function B(t){return new Promise((e,r)=>{if(document.querySelector(`script[src="${t}"]`))return e();const a=document.createElement("script");a.src=t,a.onload=e,a.onerror=r,document.head.appendChild(a)})}xt(async()=>{try{await B("https://code.highcharts.com/highcharts.js"),await B("https://cdn.jsdelivr.net/npm/chart.js"),await U(),await Q(),await Z(),await at(),await st()}catch(t){console.error(t)}}),wt();var A=kt();gt(t=>{var e=_t();Ct.title="Integrations - Pablo Dominguez",L(2),C(t,e)});var R=f(A),P=c(f(R),4),I=f(P),z=c(f(I),4);w(z,"href",$);var O=c(z,2),j=c(O,2),ct=f(j);{var lt=t=>{var e=Et();C(t,e)};H(ct,t=>{m(v)&&t(lt)})}L(2),p(j),p(I);var N=c(I,2),T=c(f(N),4);w(T,"href",_);var M=c(T,2),S=c(M,2),dt=f(S);{var ft=t=>{var e=Ft();C(t,e)};H(dt,t=>{m(v)&&t(ft)})}L(2),p(S),p(N);var D=c(N,2),pt=c(f(D),6);p(D);var G=c(D,2),ut=c(f(G),6);p(G);var J=c(G,2),mt=c(f(J),6);p(J),p(P),p(R),p(A),bt(()=>{w(O,"href",m(h)),w(M,"href",m(h))}),g(3,j,()=>y),g(3,S,()=>y),g(3,pt,()=>y),g(3,ut,()=>y),g(3,mt,()=>y),g(3,P,()=>y,()=>({duration:400})),C(Y,A),vt()}export{Lt as component};
