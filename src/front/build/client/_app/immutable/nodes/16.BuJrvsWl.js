import{t as h,h as vt,a as v}from"../chunks/Cw--0ebe.js";import"../chunks/C5mLL2l5.js";import{p as ht,t as _,a as ft,$ as gt,s as o,c as d,b as u,m as G,n as yt,g as n,r as p,aw as _t}from"../chunks/LDrxhfq1.js";import{s as b}from"../chunks/1neYngIx.js";import{i as f}from"../chunks/BG8tU1X3.js";import{s as y}from"../chunks/crEyKr2S.js";import{t as wt,f as bt}from"../chunks/IMrtpuJV.js";import{b as Et}from"../chunks/Cji-WUv_.js";import{i as xt}from"../chunks/BwztKqQM.js";import{o as At}from"../chunks/C73a-Tmm.js";var jt=h('<meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <link href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.7.20/c3.min.css" rel="stylesheet"> <link href="https://unpkg.com/vis-timeline@latest/styles/vis-timeline-graph2d.min.css" rel="stylesheet">',1),Ct=h("<p>Cargando datos...</p>"),Dt=h('<p style="color: red"> </p>'),Gt=h("<p>Cargando datos...</p>"),$t=h('<p style="color: red"> </p>'),Pt=h("<p>Cargando datos...</p>"),kt=h('<p style="color: red"> </p>'),Tt=h("<p>Cargando datos...</p>"),St=h('<p style="color: red"> </p>'),It=h("<p>Cargando datos...</p>"),Rt=h('<p style="color: red"> </p>'),Nt=h("<p>Cargando datos...</p>"),Ot=h('<p style="color: red"> </p>'),zt=h("<p>Cargando datos...</p>"),Lt=h('<p style="color: red"> </p>'),Mt=h("<p>Cargando datos...</p>"),Ft=h('<p style="color: red"> </p>'),Wt=h('<div class="wrapper"><div class="container"><h2 style="text-align: center;">Integraciones <br><i>Jaime Duffy Panés</i></h2> <hr style="width: 100%; animation: loadHrGraph 1s; transition: all 0.3s ease;"> <div><div class="article"><h3 style="font-size: 1.5em; text-transform: none;">Widget: Distribución de ayudas DANA por municipios</h3> <p>Este gráfico representa cómo se reparte la ayuda por la dana para cada municipio.</p> <a style="color: #fff;" target="_blank"><i>G18-dana-grants-subsidies-stats</i></a> <div class="chart-container svelte-13lr82f"><figure class="highcharts-figure"><div id="container"></div> <!> <!></figure></div></div> <div class="article"><h3 style="font-size: 1.5em; text-transform: none;">Integración: Número de multas por tasa de paro</h3> <p>Este gráfico nos muestra el número de multas de las comunidades autónomas junto con la tasa de paro.</p> <a style="color: #fff; margin-right: 1rem;" target="_blank"><i>G10-radars-stats</i></a> <a style="color: #fff;" target="_blank"><i>API: Datos de Empleo</i></a> <div class="chart-container svelte-13lr82f"><div id="chart10" style="max-width: 800px; margin: auto;"></div> <!> <!></div></div> <div class="article"><h3 style="font-size: 1.5em; text-transform: none;">Integración: Número de proyectos y tasa de actividad</h3> <p>Este gráfico mustra el numero de proyectos y la tasa de actividad en andalucía según los años.</p> <a style="color: #fff; margin-right: 1rem;" target="_blank"><i>G13-water-supply-improvements</i></a> <a style="color: #fff;" target="_blank"><i>API: Datos de Empleo</i></a> <div class="chart-container svelte-13lr82f"><div id="andaluciaChart" style="max-width: 700px; margin: auto;"></div> <!> <!></div></div> <div class="article"><h3 style="font-size: 1.5em; text-transform: none;">Widget: Distribución de Estudiantes por Grado Universitario</h3> <p>Este gráfico en formato donut muestra la proporción de estudiantes matriculados en los distintos grados universitarios, destacando los seis con mayor volumen. Los grados restantes se agrupan en la categoría “Otras” para facilitar la visualización comparativa.</p> <a style="color: #fff; margin-right: 1rem;" target="_blank"><i>G17-university-academic-performance</i></a> <div class="chart-container svelte-13lr82f"><div id="chart17" style="max-width: 600px; margin: auto;"></div> <!> <!></div></div> <div class="article"><h3 style="font-size: 1.5em; text-transform: none;">Widget: Comparativa de Solicitudes de Autonomía y Dependencia por Comunidad Autónoma</h3> <p>Este gráfico de barras muestra la comparación entre el número de solicitudes de autonomía y de dependencia realizadas por diferentes comunidades autónomas en los años 2023 y 2024. Permite visualizar la relación entre ambas necesidades sociales y observar la distribución geográfica del apoyo solicitado.</p> <a style="color: #fff; margin-right: 1rem;" target="_blank"><i>G11-autonomy-dependence-applications</i></a> <div class="chart-container svelte-13lr82f"><div id="chart11" style="max-width: 600px; margin: auto;"></div> <!> <!></div></div> <div class="article"><h3>Widget API externa: Comparativa de contenido de azúcar por fruta</h3> <p>Este gráfico muestra la cantidad de azúcar (en gramos) contenida en diferentes frutas. <a style="color: #fff; margin-right: 1rem;" target="_blank"><i>Frutas API</i></a></p><div class="chart-container svelte-13lr82f"><div style="height: 400px;"></div> <!> <!></div></div> <div class="article"><h3>Widget API externa: Distribución de los países más poblados del mundo</h3> <p>Este gráfico representa la distribución demográfica de los países más poblados del mundo.</p> <a style="color: #fff; margin-right: 1rem;" target="_blank"><i>Countries API</i></a> <div class="chart-container svelte-13lr82f"><div id="chartcountries"></div> <!> <!></div></div> <div class="article"><h3>Widget API externa: Distribución de los países más poblados del mundo</h3> <p>Este gráfico representa la distribución demográfica de los países más poblados del mundo.</p> <a style="color: #fff; margin-right: 1rem;" target="_blank"><i>Countries API</i></a> <div class="chart-container svelte-13lr82f"><div id="chartcountries"></div> <!> <!></div></div></div></div></div>');function Zt(ja,Ca){ht(Ca,!1);const S="https://sos2425-18.onrender.com/api/v2/dana-grants-subsidies-stats",C="https://sos2425-17.onrender.com/api/v2/university-academic-performance",I="https://sos2425-11.onrender.com/api/v1/autonomy-dependence-applications",D="https://sos2425-13.onrender.com/api/v1/water-supply-improvements",R="https://sos2425-10.onrender.com/api/v1/radars-stats";let $=G("/api/v1/employment-data");const N="https://restcountries.com/v3.1/all";let Y=G("/api/v1/proxy/fruits"),Da="https://disease.sh/v3/covid-19/countries",A=[],E=[],P=[],j=[],k=[],T=[],O=[],m=G(!0),c=G("");function w(a){return new Promise((t,e)=>{if(document.querySelector(`script[src="${a}"]`))return t();const r=document.createElement("script");r.src=a,r.onload=t,r.onerror=e,document.head.appendChild(r)})}async function Ga(){u(m,!0),u(c,""),E=[];try{console.log(`Solicitando datos a: ${I}`);let a=await fetch(I,{method:"GET",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`Error en la respuesta: ${a.status}`);E=await a.json(),console.log(`Datos recibidos: ${E.length} registros`),Na()}catch(a){console.error(`ERROR G11: ${a}`),u(c,`Error al cargar datos G11: ${a.message}`)}finally{u(m,!1)}}async function $a(){u(m,!0),u(c,""),P=[],O=[];try{let a=await fetch(n($),{method:"GET",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`Error en la respuesta: ${a.status}`);O=await a.json(),console.log(`Solicitando datos a: ${D}`);let e=await fetch(D,{method:"GET",headers:{Accept:"application/json"}});if(!e.ok)throw new Error(`Error en la respuesta: ${e.status}`);let i=await e.json();if(i.length===0){if(console.warn("No hay datos. Cargando datos iniciales..."),!(await fetch(`${D}/loadInitialData`,{method:"GET"})).ok)throw new Error("No se pudo cargar datos iniciales");if(await new Promise(s=>setTimeout(s,1e3)),e=await fetch(D,{method:"GET",headers:{Accept:"application/json"}}),!e.ok)throw new Error("Error al obtener datos tras la carga inicial");i=await e.json()}P=i,console.log(`Datos recibidos: ${P.length} registros`),Ra()}catch(a){console.error(`ERROR G13: ${a}`),u(c,`Error al cargar datos G13: ${a.message}`)}finally{u(m,!1)}}async function Pa(){u(m,!0),u(c,""),A=[];try{console.log(`Solicitando datos a: ${C}`);let a=await fetch(C,{method:"GET",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`Error en la respuesta: ${a.status}`);let t=await a.json();if(t.length===0){if(console.warn("No hay datos. Cargando datos iniciales..."),!(await fetch(`${C}/loadInitialData`,{method:"GET"})).ok)throw new Error("No se pudo cargar datos iniciales");if(await new Promise(i=>setTimeout(i,1e3)),a=await fetch(C,{method:"GET",headers:{Accept:"application/json"}}),!a.ok)throw new Error("Error al obtener datos tras la carga inicial");t=await a.json()}A=t,console.log(`Datos recibidos: ${A.length} registros`),Ia()}catch(a){console.error(`ERROR G17: ${a}`),u(c,`Error al cargar datos G17: ${a.message}`)}finally{u(m,!1)}}async function ka(){u(m,!0),u(c,""),j=[],T=[];try{let a=await fetch(n($),{method:"GET",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`Error en la respuesta: ${a.status}`);T=await a.json(),console.log(`Solicitando datos a: ${R}`);const e=await fetch(R,{method:"GET",headers:{Accept:"application/json"}});if(!e.ok)throw new Error(`Error en la respuesta: ${e.status}`);j=await e.json(),console.log(`Datos recibidos: ${j.length} registros`),Oa()}catch(a){console.error(`ERROR G10: ${a}`),u(c,`Error al cargar datos G10: ${a.message}`),u(m,!1)}}async function Ta(){u(m,!0),u(c,"");try{console.log(`Solicitando datos a: ${S}`);const a=await fetch(S,{method:"GET",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`Error en la respuesta: ${a.status}`);k=await a.json(),console.log(`Datos recibidos: ${k.length} registros`),Sa()}catch(a){console.error(`ERROR al obtener datos: ${a}`),u(c,`Error al cargar datos: ${a.message}`)}finally{u(m,!1)}}async function Sa(){console.log("Estructura de los primeros datos:",JSON.stringify(k[0],null,2));const a={};k.forEach(i=>{const r=i.mun_name,s=i.amt_granted;a[r]||(a[r]=0),a[r]+=s}),console.log("Datos agrupados por municipio:",a);const t=Object.entries(a).map(([i,r])=>({name:i,y:r})).sort((i,r)=>r.y-i.y);if(console.log("Datos preparados para el gráfico:",t),t.length===0){u(c,"No se pudieron encontrar datos válidos de municipios y cantidades");return}let e=t.slice(0,10);if(t.length>10){const r=t.slice(10).reduce((s,l)=>s+l.y,0);e.push({name:"Otros municipios",y:r})}Highcharts.chart("container",{chart:{type:"pie",backgroundColor:"rgba(255, 255, 255, 0.8)"},title:{text:"Distribución de ayudas por municipios",align:"center",style:{fontWeight:"bold",fontSize:"18px"}},subtitle:{text:"Fuente: G18-dana-grants-subsidies-stats",align:"center"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.percentage:.1f}%",style:{fontSize:"12px"}},showInLegend:!0}},tooltip:{pointFormat:"{series.name}: <b>{point.y:.0f}€</b> ({point.percentage:.1f}%)"},legend:{enabled:!0,layout:"vertical",align:"right",verticalAlign:"middle"},accessibility:{point:{valueSuffix:"€"}},series:[{name:"Importe total",colorByPoint:!0,data:e}],credits:{enabled:!0,text:"G18-dana-grants-subsidies-stats"}})}function Ia(){if(!Array.isArray(A)||A.length===0){u(c,"No hay datos disponibles de universidades para mostrar el gráfico.");return}const a={};A.forEach(s=>{const l=s.degree||"Desconocido";a[l]||(a[l]=0),a[l]+=s.cohortStudents||0});const t=Object.entries(a).sort((s,l)=>l[1]-s[1]),e=t.slice(0,6),i=t.slice(6).reduce((s,[,l])=>s+l,0);i>0&&e.push(["Otras",i]);const r=e.map(([s,l])=>[s,l]);c3.generate({bindto:"#chart17",data:{type:"donut",columns:r},donut:{title:"Estudiantes por universidad"}})}async function Ra(){await _t();const a={};O.forEach(r=>{var s;if(((s=r.autonomous_community)==null?void 0:s.toLowerCase())==="andalucía"&&r.education_level==="TOTAL"){const l=r.year.toString();a[l]||(a[l]={activity_rate:null,project_count:null}),a[l].activity_rate=r.activity_rate}}),P.forEach(r=>{var s,l;if(((s=r.autonomous_community)==null?void 0:s.toLowerCase())==="andalucía"||((l=r.autonomous_community)==null?void 0:l.toLowerCase())==="andalucia"){const g=r.year.toString();a[g]||(a[g]={activity_rate:null,project_count:null}),a[g].project_count=r.project_count}});const t=Object.keys(a).sort(),e=["Tasa de Actividad (%)"],i=["Número de Proyectos"];t.forEach(r=>{const s=a[r];e.push(s.activity_rate??0),i.push(s.project_count??0)}),c3.generate({bindto:"#andaluciaChart",data:{x:"x",columns:[["x",...t],e,i],types:{"Tasa de Actividad (%)":"area-spline","Número de Proyectos":"area-spline"},labels:!0},axis:{x:{type:"category",label:"Año"},y:{label:"Valores"}},title:{text:"Evolución de Proyectos y Tasa de Actividad en Andalucía"},legend:{position:"right"}})}function Na(){if(!Array.isArray(E)||E.length===0){u(c,"No hay datos disponibles para mostrar el gráfico.");return}const a=[...new Set(E.map(i=>`${i.place} ${i.year}`))],t=["Autonomía"],e=["Dependencia"];a.forEach(i=>{const[r,s]=i.split(/ (?=\d{4}$)/),l=E.find(g=>g.place===r&&g.year.toString()===s);t.push((l==null?void 0:l.request)||0),e.push((l==null?void 0:l.dependent_population)||0)}),c3.generate({bindto:"#chart11",data:{x:"x",columns:[["x",...a],t,e],type:"bar",labels:!0},axis:{x:{type:"category",label:{text:"Comunidad y Año",position:"outer-center"},tick:{rotate:45,multiline:!1}},y:{label:{text:"Solicitudes",position:"outer-middle"}}},title:{text:"Comparativa de Solicitudes de Autonomía y Dependencia por Comunidad Autónoma y Año"},legend:{position:"right"},tooltip:{grouped:!1}})}function Oa(){if(j.length===0||T.length===0){u(c,"No hay datos disponibles para mostrar el gráfico");return}const a={Madrid:"Madrid (Comunidad de)",Navarra:"Navarra (Comunidad Foral de)"};function t(s){return a[s]||s}const e=[["x"],["Tasa de Paro (%)"]],i=[];[...new Set(j.map(s=>t(s.autonomousCommunity)))].forEach(s=>{const l=j.filter(x=>t(x.autonomousCommunity)===s).reduce((x,mt)=>x+(mt.complaint||0),0),g=T.find(x=>t(x.autonomous_community)===s&&x.year===2023&&x.education_level==="TOTAL");g&&(i.push(s),e[0].push(l),e[1].push(g.unemployment_rate))}),console.log("Datos:",e),c3.generate({bindto:"#chart10",data:{xs:{"Tasa de Paro (%)":"x"},columns:e,type:"scatter",labels:!0},axis:{x:{label:"Número de multas",tick:{fit:!1}},y:{label:"Tasa de paro (%)"}},tooltip:{format:{title(s,l){return i[l]},value(s,l,g){return`${g==="x"?"Multas":"Paro"}: ${s}`}}},title:{text:"Relación entre tasa de paro (2023) y número de multas por Comunidad Autónoma"},legend:{position:"right"}})}async function za(){let a=await fetch(N,{method:"GET",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`Error en la respuesta: ${a.status}`);const e=(await a.json()).map(i=>[i.name.common,i.population]).sort((i,r)=>r[1]-i[1]).slice(0,6);c3.generate({bindto:"#chartcountries",data:{columns:e,type:"pie"},title:{text:"Top 6 países por población"}})}let z=G();async function La(){let a=await fetch(n(Y),{method:"GET",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`Error en la respuesta: ${a.status}`);const t=await a.json(),e=new vis.DataSet(t.map((r,s)=>({x:s,y:r.nutritions.sugar,label:r.name,content:r.name}))),i={start:-1,end:t.length,drawPoints:{style:"circle"},shaded:{orientation:"bottom"},dataAxis:{left:{title:{text:"Azúcar (g)"}}},orientation:"bottom"};new vis.Graph2d(n(z),e,i)}let Ma;async function Fa(){let a=await fetch(Da,{method:"GET",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`Error en la respuesta: ${a.status}`);const t=await a.json(),e=new vis.DataSet(t.filter(r=>r.population&&r.cases).map((r,s)=>({x:r.population,y:r.cases,label:r.country,content:r.country}))),i={style:"points",drawPoints:{style:"circle",size:5},dataAxis:{left:{title:{text:"Casos totales"}},bottom:{title:{text:"Población total"}}},orientation:"bottom",showMajorLabels:!0,showMinorLabels:!0,shaded:!1,width:"100%",height:"400px"};new vis.Graph2d(Ma,e,i)}At(async()=>{try{await w("https://code.highcharts.com/highcharts.js"),await w("https://code.highcharts.com/modules/heatmap.js"),await w("https://code.highcharts.com/modules/exporting.js"),await w("https://code.highcharts.com/modules/export-data.js"),await w("https://code.highcharts.com/modules/accessibility.js"),await w("https://cdnjs.cloudflare.com/ajax/libs/d3/5.16.0/d3.min.js"),await w("https://cdnjs.cloudflare.com/ajax/libs/c3/0.7.20/c3.min.js"),await w("https://unpkg.com/vis-timeline@latest/standalone/umd/vis-timeline-graph2d.min.js"),await Ta(),await $a(),await ka(),await Pa(),await Ga(),await La(),await za(),await Fa()}catch(a){u(c,`Error cargando scripts de Highcharts: ${a}`),console.error(a)}}),xt();var L=Wt();vt(a=>{var t=jt();gt.title="Integrations - Jaime Duffy Panés",yt(6),v(a,t)});var K=d(L),M=o(d(K),4),F=d(M),Q=o(d(F),4);y(Q,"href",S);var X=o(Q,2),Z=d(X),aa=o(d(Z),2);{var Wa=a=>{var t=Ct();v(a,t)};f(aa,a=>{n(m)&&a(Wa)})}var qa=o(aa,2);{var Ua=a=>{var t=Dt(),e=d(t,!0);p(t),_(()=>b(e,n(c))),v(a,t)};f(qa,a=>{n(c)&&a(Ua)})}p(Z),p(X),p(F);var W=o(F,2),ta=o(d(W),4);y(ta,"href",R);var ea=o(ta,2),ra=o(ea,2),oa=o(d(ra),2);{var Ha=a=>{var t=Gt();v(a,t)};f(oa,a=>{n(m)&&a(Ha)})}var Ja=o(oa,2);{var Va=a=>{var t=$t(),e=d(t,!0);p(t),_(()=>b(e,n(c))),v(a,t)};f(Ja,a=>{n(c)&&a(Va)})}p(ra),p(W);var q=o(W,2),sa=o(d(q),4);y(sa,"href",D);var ia=o(sa,2),na=o(ia,2),ca=o(d(na),2);{var Ba=a=>{var t=Pt();v(a,t)};f(ca,a=>{n(m)&&a(Ba)})}var Ya=o(ca,2);{var Ka=a=>{var t=kt(),e=d(t,!0);p(t),_(()=>b(e,n(c))),v(a,t)};f(Ya,a=>{n(c)&&a(Ka)})}p(na),p(q);var U=o(q,2),la=o(d(U),4);y(la,"href",C);var da=o(la,2),pa=o(d(da),2);{var Qa=a=>{var t=Tt();v(a,t)};f(pa,a=>{n(m)&&a(Qa)})}var Xa=o(pa,2);{var Za=a=>{var t=St(),e=d(t,!0);p(t),_(()=>b(e,n(c))),v(a,t)};f(Xa,a=>{n(c)&&a(Za)})}p(da),p(U);var H=o(U,2),ua=o(d(H),4);y(ua,"href",I);var ma=o(ua,2),va=o(d(ma),2);{var at=a=>{var t=It();v(a,t)};f(va,a=>{n(m)&&a(at)})}var tt=o(va,2);{var et=a=>{var t=Rt(),e=d(t,!0);p(t),_(()=>b(e,n(c))),v(a,t)};f(tt,a=>{n(c)&&a(et)})}p(ma),p(H);var J=o(H,2),V=o(d(J),2),rt=o(d(V));p(V);var ha=o(V),fa=d(ha);Et(fa,a=>u(z,a),()=>n(z));var ga=o(fa,2);{var ot=a=>{var t=Nt();v(a,t)};f(ga,a=>{n(m)&&a(ot)})}var st=o(ga,2);{var it=a=>{var t=Ot(),e=d(t,!0);p(t),_(()=>b(e,n(c))),v(a,t)};f(st,a=>{n(c)&&a(it)})}p(ha),p(J);var B=o(J,2),ya=o(d(B),4);y(ya,"href",N);var _a=o(ya,2),wa=o(d(_a),2);{var nt=a=>{var t=zt();v(a,t)};f(wa,a=>{n(m)&&a(nt)})}var ct=o(wa,2);{var lt=a=>{var t=Lt(),e=d(t,!0);p(t),_(()=>b(e,n(c))),v(a,t)};f(ct,a=>{n(c)&&a(lt)})}p(_a),p(B);var ba=o(B,2),Ea=o(d(ba),4);y(Ea,"href",N);var xa=o(Ea,2),Aa=o(d(xa),2);{var dt=a=>{var t=Mt();v(a,t)};f(Aa,a=>{n(m)&&a(dt)})}var pt=o(Aa,2);{var ut=a=>{var t=Ft(),e=d(t,!0);p(t),_(()=>b(e,n(c))),v(a,t)};f(pt,a=>{n(c)&&a(ut)})}p(xa),p(ba),p(M),p(K),p(L),_(()=>{y(ea,"href",n($)),y(ia,"href",n($)),y(rt,"href",n(Y))}),wt(3,M,()=>bt,()=>({duration:400})),v(ja,L),ft()}export{Zt as component};
