import{t as O,h as ve,a as j}from"../chunks/DaiKAr2_.js";import"../chunks/j32MlntO.js";import{v as be,w as ye,$ as he,c as p,b as e,m as k,s,r as m,h as a,x as ee,y as c,n as ge}from"../chunks/C8gLBHYj.js";import{e as D,s as q}from"../chunks/r9gLMdC5.js";import{i as B}from"../chunks/DPajP3yk.js";import{e as Ee,i as De}from"../chunks/BQYhnL-Z.js";import{r as l}from"../chunks/DLjR3o-x.js";import{t as we,b as d,p as te,f as xe}from"../chunks/DhfokzEC.js";import{i as $e}from"../chunks/BEwWrvZW.js";import{o as Ce}from"../chunks/K_54QM3B.js";import{g as Te}from"../chunks/CnWt8w9j.js";var Ae=O('<p class="info-message"> </p>'),Re=O('<form class="create-form"><input placeholder="Comunidad Autónoma" required> <input type="number" placeholder="Año" required> <input placeholder="Delitos Informáticos" required> <input placeholder="Delitos contra la Ciberseguridad" required> <input placeholder="Detenidos / Investigados" required> <button type="submit" class="submit">Crear</button> <button type="button" class="cancel">Cancelar</button></form>'),ke=O('<form class="create-form"><input type="number" placeholder="Desde año"> <input type="number" placeholder="Hasta año"> <input type="number" placeholder="Año exacto"> <input type="text" placeholder="Comunidad autónoma"> <input type="text" placeholder="Delitos informáticos exacto"> <input type="number" placeholder="Delitos inf. desde"> <input type="number" placeholder="Delitos inf. hasta"> <input type="text" placeholder="Ciberseguridad exacto"> <input type="number" placeholder="Ciberseguridad desde"> <input type="number" placeholder="Ciberseguridad hasta"> <input type="text" placeholder="Detenidos exacto"> <input type="number" placeholder="Detenidos desde"> <input type="number" placeholder="Detenidos hasta"> <input type="number" placeholder="Limitar a..."> <input type="number" placeholder="Comenzar desde..."> <button class="btn" type="submit">Buscar</button></form>'),qe=O('<tr><td> </td><td> </td><td> </td><td> </td><td> </td><td class="actions"><button class="btn-circle" title="Editar Registro"><i class="fas fa-pen"></i></button> <button class="btn-circle" title="Eliminar Registro"><i class="fas fa-times"></i></button></td></tr>'),Ie=O('<div class="wrapper dash"><div class="container dash"><!> <div class="header"><h3>Datos de ciberdelincuencia</h3> <div class="actions"><button class="btn"><i class="fas fa-search"></i> Búsqueda</button> <button class="btn"><i class="fas fa-plus"></i> Nuevo registro</button> <button class="btn"><i class="fas fa-sync-alt"></i> Recargar los datos iniciales</button> <button class="btn"><i class="fas fa-trash-alt"></i> Eliminar todos los datos</button></div></div> <!> <!> <div class="seeker"></div> <div class="table-container"><table><thead><tr><th>Comunidad Autónoma</th><th>Año</th><th>Delitos Informáticos</th><th>Delitos Ciberseguridad</th><th>Detenidos / Investigados</th><th>Acciones</th></tr></thead></table> <div class="scroll-body"><table><tbody></tbody></table></div></div></div></div>');function Ge(re,ae){be(ae,!1);let $="/api/v1/cybercrime-data",y=k([]),o=k(""),C=k(!1),I=k(!1),f=k({autonomous_community:"",year:"",criminal_ofense:"",cybersecurity:"",arrested_investigated:""}),r=k({from:"",to:"",year:"",autonomous_community:"",criminal_ofense:"",criminal_ofense_from:"",criminal_ofense_to:"",cybersecurity:"",cybersecurity_from:"",cybersecurity_to:"",arrested_investigated:"",arrested_investigated_from:"",arrested_investigated_to:"",limit:"",offset:""});async function T(){try{const i=await fetch($);if(!i.ok){i.status===404?a(o,"No se encontraron datos de crimen cibernético."):i.status===500?a(o,"Error del servidor. Intenta más tarde."):a(o,"Error inesperado"),a(y,[]);return}a(y,await i.json())}catch(i){console.error("[GET] Error cargando datos:",i),a(o,"No se pudo conectar con el servidor."),a(y,[])}setTimeout(()=>a(o,""),2e3)}function ie(){a(I,!e(I)),a(C,!1),e(I)||(a(r,{from:"",to:"",year:"",autonomous_community:"",criminal_ofense:"",criminal_ofense_from:"",criminal_ofense_to:"",cybersecurity:"",cybersecurity_from:"",cybersecurity_to:"",arrested_investigated:"",arrested_investigated_from:"",arrested_investigated_to:"",limit:"",offset:""}),a(o,""),T())}function oe(){a(C,!e(C)),a(I,!1)}async function se(){const i=new URLSearchParams;for(const[t,u]of Object.entries(e(r)))u!==""&&u!==null&&u!==void 0&&i.append(t,u);try{const t=await fetch(`${$}?${i.toString()}`);if(!t.ok){t.status===400?a(o,"Parámetros de búsqueda no válidos."):t.status===500?a(o,"Error interno del servidor al buscar."):a(o,"Error inesperado"),a(y,[]);return}a(y,await t.json()),e(y).length===0?a(o,"No se encontraron resultados para tu búsqueda."):a(o,`Se encontraron ${e(y).length} resultados.`)}catch(t){console.error("[SEARCH] Error al buscar:",t),a(o,"No se pudo conectar con el servidor."),a(y,[])}setTimeout(()=>a(o,""),2e3)}async function ne(){try{const i=await fetch($,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e(f))}),t=await i.json();i.status===201?(a(o,"Registro creado correctamente"),a(C,!1),ce(),await T()):i.status===400?a(o,`Datos inválidos: ${t.error||"Revisa los campos."}`):i.status===409?a(o,"Ya existe un registro con esos identificadores."):a(o,`Error inesperado (${i.status}) al procesar la petición.`)}catch(i){console.error("[CREATE] Error:",i),a(o,"No se pudo conectar con el servidor.")}setTimeout(()=>a(o,""),2e3)}function ce(){a(f,{autonomous_community:"",year:"",criminal_ofense:"",cybersecurity:"",arrested_investigated:""})}async function le(){const i=`${$}/loadInitialData`;try{const t=await fetch(i);if(!t.ok)throw new Error(`Error ${t.status}`);a(o,"Datos iniciales cargados."),await T()}catch(t){console.error("[LOAD INITIAL DATA] Error:",t),a(o,"Error al cargar los datos iniciales.")}setTimeout(()=>{a(o,"")},2e3)}async function de(){if(confirm("¿Estás seguro de que quieres eliminar todos los registros de crimen cibernético?")){try{const t=await fetch($,{method:"DELETE"});t.status===200?(a(o,"Todos los registros de crimen cibernético han sido eliminados."),await T()):t.status===404?a(o,"No hay registros de crimen cibernético que eliminar."):a(o,"Error al eliminar los registros de crimen cibernético.")}catch(t){console.error("[DELETE] Error eliminando registros de crimen cibernético:",t),a(o,"Error al eliminar los registros de crimen cibernético.")}setTimeout(()=>{a(o,"")},2e3)}}async function ue(i,t){if(confirm(`¿Estás seguro de que quieres eliminar el registro de crimen cibernético en ${i} (${t})?`)){try{const _=await fetch(`${$}/${i}/${t}`,{method:"DELETE"});_.status===200?(a(o,`Registro de crimen cibernético en ${i} (${t}) eliminado correctamente.`),await T()):_.status===404?a(o,"Registro de crimen cibernético no encontrado."):a(o,"Error al eliminar el registro de crimen cibernético.")}catch(_){console.error("[DELETE] Error eliminando el registro de crimen cibernético:",_),a(o,"Error al eliminar el registro de crimen cibernético.")}setTimeout(()=>{a(o,"")},2e3)}}Ce(async()=>{await T()}),$e();var P=Ie();ve(i=>{he.title="Datos de Ciberdelincuencia"});var H=p(P),U=p(H);{var me=i=>{var t=Ae(),u=p(t,!0);m(t),ee(()=>q(u,e(o))),we(3,t,()=>xe,()=>({duration:300})),j(i,t)};B(U,i=>{e(o)&&i(me)})}var F=s(U,2),z=s(p(F),2),G=p(z),J=s(G,2),M=s(J,2),fe=s(M,2);m(z),m(F);var Y=s(F,2);{var pe=i=>{var t=Re(),u=p(t);l(u);var _=s(u,2);l(_);var h=s(_,2);l(h);var b=s(h,2);l(b);var g=s(b,2);l(g);var E=s(g,4);m(t),d(u,()=>e(f).autonomous_community,v=>c(f,e(f).autonomous_community=v)),d(_,()=>e(f).year,v=>c(f,e(f).year=v)),d(h,()=>e(f).criminal_ofense,v=>c(f,e(f).criminal_ofense=v)),d(b,()=>e(f).cybersecurity,v=>c(f,e(f).cybersecurity=v)),d(g,()=>e(f).arrested_investigated,v=>c(f,e(f).arrested_investigated=v)),D("click",E,()=>a(C,!1)),D("submit",t,te(ne)),j(i,t)};B(Y,i=>{e(C)&&i(pe)})}var K=s(Y,2);{var _e=i=>{var t=ke(),u=p(t);l(u);var _=s(u,2);l(_);var h=s(_,2);l(h);var b=s(h,2);l(b);var g=s(b,2);l(g);var E=s(g,2);l(E);var v=s(E,2);l(v);var w=s(v,2);l(w);var N=s(w,2);l(N);var x=s(N,2);l(x);var L=s(x,2);l(L);var A=s(L,2);l(A);var R=s(A,2);l(R);var S=s(R,2);l(S);var Z=s(S,2);l(Z),ge(2),m(t),d(u,()=>e(r).from,n=>c(r,e(r).from=n)),d(_,()=>e(r).to,n=>c(r,e(r).to=n)),d(h,()=>e(r).year,n=>c(r,e(r).year=n)),d(b,()=>e(r).autonomous_community,n=>c(r,e(r).autonomous_community=n)),d(g,()=>e(r).criminal_ofense,n=>c(r,e(r).criminal_ofense=n)),d(E,()=>e(r).criminal_ofense_from,n=>c(r,e(r).criminal_ofense_from=n)),d(v,()=>e(r).criminal_ofense_to,n=>c(r,e(r).criminal_ofense_to=n)),d(w,()=>e(r).cybersecurity,n=>c(r,e(r).cybersecurity=n)),d(N,()=>e(r).cybersecurity_from,n=>c(r,e(r).cybersecurity_from=n)),d(x,()=>e(r).cybersecurity_to,n=>c(r,e(r).cybersecurity_to=n)),d(L,()=>e(r).arrested_investigated,n=>c(r,e(r).arrested_investigated=n)),d(A,()=>e(r).arrested_investigated_from,n=>c(r,e(r).arrested_investigated_from=n)),d(R,()=>e(r).arrested_investigated_to,n=>c(r,e(r).arrested_investigated_to=n)),d(S,()=>e(r).limit,n=>c(r,e(r).limit=n)),d(Z,()=>e(r).offset,n=>c(r,e(r).offset=n)),D("submit",t,te(se)),j(i,t)};B(K,i=>{e(I)&&i(_e)})}var Q=s(K,4),V=s(p(Q),2),W=p(V),X=p(W);Ee(X,5,()=>e(y),De,(i,t)=>{var u=qe(),_=p(u),h=p(_,!0);m(_);var b=s(_),g=p(b,!0);m(b);var E=s(b),v=p(E,!0);m(E);var w=s(E),N=p(w,!0);m(w);var x=s(w),L=p(x,!0);m(x);var A=s(x),R=p(A),S=s(R,2);m(A),m(u),ee(()=>{q(h,e(t).autonomous_community),q(g,e(t).year),q(v,e(t).criminal_ofense),q(N,e(t).cybersecurity),q(L,e(t).arrested_investigated)}),D("click",R,()=>Te(`/cybercrime/edit/${encodeURIComponent(e(t).autonomous_community)}/${e(t).year}`)),D("click",S,()=>ue(e(t).autonomous_community,e(t).year)),j(i,u)}),m(X),m(W),m(V),m(Q),m(H),m(P),D("click",G,ie),D("click",J,oe),D("click",M,le),D("click",fe,de),j(re,P),ye()}export{Ge as component};
