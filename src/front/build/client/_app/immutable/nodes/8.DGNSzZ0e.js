import{t as oa,h as za,a as ea}from"../chunks/C0k3Nw9y.js";import"../chunks/DPNYAhEg.js";import{I as $a,v as Ja,w as Ya,$ as Ka,c as v,s as a,b as t,m as ta,r as u,h as i,x as K,B as ra,y as c,n as Qa,a as Wa}from"../chunks/cdyx5pLP.js";import{e as q,s as Q}from"../chunks/dBgfGCkZ.js";import{i as da}from"../chunks/CEmQKR9v.js";import{e as Xa,i as Za}from"../chunks/D1tosopV.js";import{r as d}from"../chunks/CXYTPRs_.js";import{t as at}from"../chunks/1VidrSLw.js";import{t as tt,f as et,b as f,p as Ra}from"../chunks/CYTxZMWJ.js";import{b as na}from"../chunks/1GCY7V5u.js";import{i as ot}from"../chunks/BZ6f0h1O.js";import{o as it}from"../chunks/CV6rVgxM.js";import{g as rt}from"../chunks/C4SidvwX.js";function Da(O,fa,M,h,r,y){var P=O.__className;if($a||P!==M||P===void 0){var s=at(M,h,y);(!$a||s!==O.getAttribute("class"))&&(s==null?O.removeAttribute("class"):O.className=s),O.__className=M}else if(y&&r!==y)for(var o in y){var x=!!y[o];(r==null||x!==!!r[o])&&O.classList.toggle(o,x)}return y}var nt=oa('<p class="info-message"> </p>'),lt=oa('<form class="create-form"><select name="autonomous_community" required><option disabled selected>Comunidad autónoma</option><option>Andalucía</option><option>Aragón</option><option>Asturias</option><option>Baleares</option><option>Canarias</option><option>Cantabria</option><option>Castilla y León</option><option>Castilla-La Mancha</option><option>Cataluña</option><option>Ceuta y Melilla</option><option>Comunitat Valenciana</option><option>Extremadura</option><option>Galicia</option><option>La Rioja</option><option>Madrid</option><option>Murcia</option><option>Navarra</option><option>País Vasco</option><option>TOTAL</option></select> <input type="number" placeholder="Año" required> <select name="education_level" required><option disabled selected>Nivel educativo</option><option>Educación superior (SUP)</option><option>Secundaria (SEC)</option><option>Inferior a secundaria (INF)</option><option>Total (TOTAL)</option></select> <input type="number" step="0.01" placeholder="Tasa actividad" required> <input type="number" step="0.01" placeholder="Tasa empleo" required> <input type="number" step="0.01" placeholder="Tasa paro" required> <button type="submit" class="submit">Crear</button> <button type="button" class="cancel">Cancelar</button></form>'),st=oa('<form class="create-form"><input type="number" placeholder="Desde año"> <input type="number" placeholder="Hasta año"> <input type="number" placeholder="Año exacto"> <select name="autonomous_community"><option disabled selected>Comunidad autónoma</option><option>Andalucía</option><option>Aragón</option><option>Asturias</option><option>Baleares</option><option>Canarias</option><option>Cantabria</option><option>Castilla y León</option><option>Castilla-La Mancha</option><option>Cataluña</option><option>Ceuta y Melilla</option><option>Comunitat Valenciana</option><option>Extremadura</option><option>Galicia</option><option>La Rioja</option><option>Madrid</option><option>Murcia</option><option>Navarra</option><option>País Vasco</option><option>TOTAL</option></select> <select name="education_level"><option disabled selected>Nivel educativo</option><option>Educación superior (SUP)</option><option>Secundaria (SEC)</option><option>Inferior a secundaria (INF)</option><option>Total (TOTAL)</option></select> <input type="number" placeholder="Tasa actividad min"> <input type="number" placeholder="Tasa actividad max"> <input type="number" placeholder="Tasa empleo min"> <input type="number" placeholder="Tasa empleo max"> <input type="number" placeholder="Tasa paro min"> <input type="number" placeholder="Tasa paro max"> <input type="number" placeholder="Limitar a..."> <input type="number" placeholder="Comenzar desde..."> <button class="btn" type="submit">Buscar</button></form>'),ut=oa('<tr><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td class="actions"><button class="btn-circle" title="Editar Registro"><i class="fas fa-pen"></i></button>  <button class="btn-circle" title="Eliminar Registro"><i class="fas fa-times"></i></button></td></tr>'),pt=oa('<div class="wrapper dash"><div class="container dash"><!> <div class="header"><h3>Datos de empleo</h3> <div class="actions"><button class="btn"><i class="fas fa-search"></i> Buscar</button> <button class="btn"><i class="fas fa-plus"></i> Nuevo registro</button> <button class="btn"><i class="fas fa-sync-alt"></i> Recargar</button> <button class="btn"><i class="fas fa-trash-alt"></i> Eliminar</button></div></div> <!> <!> <div class="seeker"></div> <div class="table-container"><table><thead><tr><th>Comunidad Autónoma</th><th>Año</th><th>Nivel educativo</th><th>Tasa de actividad</th><th>Tasa de empleo</th><th>Tasa de paro</th><th>Acciones</th></tr></thead></table> <div class="scroll-body"><table><tbody></tbody></table></div></div></div></div>');function Mt(O,fa){Ja(fa,!1);let M="/api/v1/employment-data",h=ta([]),r=ta(""),y=ta(!1),P=ta(!1),s=ta({autonomous_community:"",year:"",education_level:"",activity_rate:"",employment_rate:"",unemployment_rate:""}),o=ta({from:"",to:"",year:"",autonomous_community:"",education_level:"",activity_rateMin:"",activity_rateMax:"",employment_rateMin:"",employment_rateMax:"",unemployment_rateMin:"",unemployment_rateMax:"",limit:"",offset:""});async function x(){try{const n=await fetch(M);if(!n.ok){n.status===404?i(r,"No se encontraron datos de empleo."):n.status===500?i(r,"Error del servidor. Intenta más tarde."):i(r,"Error inesperado"),i(h,[]);return}i(h,await n.json())}catch(n){console.error("[GET] Error cargando datos:",n),i(r,"No se pudo conectar con el servidor."),i(h,[])}setTimeout(()=>i(r,""),2e3)}function Ia(){i(P,!t(P)),i(y,!1),t(P)||(i(o,{from:"",to:"",year:"",autonomous_community:"",education_level:"",activity_rateMin:"",activity_rateMax:"",employment_rateMin:"",employment_rateMax:"",unemployment_rateMin:"",unemployment_rateMax:"",limit:"",offset:""}),i(r,""),x())}function Sa(){i(y,!t(y)),i(P,!1)}async function qa(){const n=new URLSearchParams;for(const[e,p]of Object.entries(t(o)))p!==""&&p!==null&&p!==void 0&&n.append(e,p);try{const e=await fetch(`${M}?${n.toString()}`);if(!e.ok){e.status===400?i(r,"Parámetros de búsqueda no válidos."):e.status===500?i(r,"Error interno del servidor al buscar."):i(r,"Error inesperado"),i(h,[]);return}i(h,await e.json()),t(h).length===0?i(r,"No se encontraron resultados para tu búsqueda."):i(r,`Se encontraron ${t(h).length} resultados.`)}catch(e){console.error("[SEARCH] Error al buscar:",e),i(r,"No se pudo conectar con el servidor."),i(h,[])}setTimeout(()=>i(r,""),2e3)}async function Oa(){try{const n=await fetch(M,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t(s))}),e=await n.json();n.status===201?(i(r,"Registro creado correctamente"),i(y,!1),Pa(),await x()):n.status===400?i(r,"Datos inválidos: revisa los campos."):n.status===409?i(r,"Ya existe un registro con esos identificadores."):i(r,"Error inesperado al procesar la petición.")}catch(n){console.error("[CREATE] Error:",n),i(r,"No se pudo conectar con el servidor.")}setTimeout(()=>i(r,""),2e3)}function Pa(){i(s,{autonomous_community:"",year:"",education_level:"",activity_rate:"",employment_rate:"",unemployment_rate:""})}async function ka(){const n=`${M}/loadInitialData`;try{const e=await fetch(n);if(!e.ok)throw new Error(`Error ${e.status}`);i(r,"Datos iniciales cargados."),await x()}catch(e){console.error("[LOAD INITIAL DATA] Error:",e),i(r,"Error al cargar los datos iniciales.")}setTimeout(()=>{i(r,"")},2e3)}async function ja(){if(confirm("¿Estás seguro de que quieres eliminar todos los registros?")){try{const e=await fetch(M,{method:"DELETE"});e.status===200?(i(r,"Todos los registros han sido eliminados."),await x()):e.status===404?i(r,"No hay registros que eliminar."):i(r,"Error al eliminar")}catch(e){console.error("[DELETE] Error deleting records:",e),i(r,"Error al eliminar los registros.")}setTimeout(()=>{i(r,"")},2e3)}}async function Va(n,e,p){try{const _=await fetch(`${M}/${n}/${e}/${p}`,{method:"DELETE"});_.status===200?(i(r,`Registro de ${n} (${e}, ${p}) eliminado correctamente.`),await x()):_.status===404?i(r,"Registro no encontrado."):i(r,"Error al eliminar")}catch(_){console.error("[DELETE] Error deleting record:",_),i(r,"Error al eliminar el registro.")}setTimeout(()=>{i(r,"")},2e3)}it(async()=>{await x()}),ot();var la=pt();za(n=>{Ka.title="Datos de Empleo"});var ya=v(la),ba=v(ya);{var Ba=n=>{var e=nt(),p=v(e,!0);u(e),K(()=>Q(p,t(r))),tt(3,e,()=>et,()=>({duration:300})),ea(n,e)};da(ba,n=>{t(r)&&n(Ba)})}var sa=a(ba,2),ha=a(v(sa),2),Ea=v(ha),Ta=a(Ea,2),ga=a(Ta,2),Fa=a(ga,2);u(ha),u(sa);var Ca=a(sa,2);{var Ua=n=>{var e=lt(),p=v(e);K(()=>{t(s),ra(()=>{})});var _=v(p);_.value=_.__value="";var N=a(_);N.value=N.__value="Andalucía";var b=a(N);b.value=b.__value="Aragón";var k=a(b);k.value=k.__value="Asturias";var E=a(k);E.value=E.__value="Baleares";var w=a(E);w.value=w.__value="Canarias";var T=a(w);T.value=T.__value="Cantabria";var $=a(T);$.value=$.__value="Castilla y León";var g=a($);g.value=g.__value="Castilla-La Mancha";var R=a(g);R.value=R.__value="Cataluña";var C=a(R);C.value=C.__value="Ceuta y Melilla";var D=a(C);D.value=D.__value="Comunitat Valenciana";var A=a(D);A.value=A.__value="Extremadura";var L=a(A);L.value=L.__value="Galicia";var I=a(L);I.value=I.__value="La Rioja";var V=a(I);V.value=V.__value="Madrid";var B=a(V);B.value=B.__value="Murcia";var F=a(B);F.value=F.__value="Navarra";var U=a(F);U.value=U.__value="País Vasco";var W=a(U);W.value=W.__value="TOTAL",u(p);var G=a(p,2);d(G);var j=a(G,2);K(()=>{t(s),ra(()=>{})});var H=v(j);H.value=H.__value="";var X=a(H);X.value=X.__value="SUP";var S=a(X);S.value=S.__value="SEC";var Z=a(S);Z.value=Z.__value="INF";var aa=a(Z);aa.value=aa.__value="TOTAL",u(j);var z=a(j,2);d(z);var J=a(z,2);d(J);var Y=a(J,2);d(Y);var ia=a(Y,4);u(e),na(p,()=>t(s).autonomous_community,m=>c(s,t(s).autonomous_community=m)),f(G,()=>t(s).year,m=>c(s,t(s).year=m)),na(j,()=>t(s).education_level,m=>c(s,t(s).education_level=m)),f(z,()=>t(s).activity_rate,m=>c(s,t(s).activity_rate=m)),f(J,()=>t(s).employment_rate,m=>c(s,t(s).employment_rate=m)),f(Y,()=>t(s).unemployment_rate,m=>c(s,t(s).unemployment_rate=m)),q("click",ia,()=>i(y,!1)),q("submit",e,Ra(Oa)),ea(n,e)};da(Ca,n=>{t(y)&&n(Ua)})}var Ma=a(Ca,2);{var Ga=n=>{var e=st(),p=v(e);d(p);var _=a(p,2);d(_);var N=a(_,2);d(N);var b=a(N,2);K(()=>{t(o),ra(()=>{})});let k;var E=v(b);E.value=E.__value="";var w=a(E);w.value=w.__value="Andalucía";var T=a(w);T.value=T.__value="Aragón";var $=a(T);$.value=$.__value="Asturias";var g=a($);g.value=g.__value="Baleares";var R=a(g);R.value=R.__value="Canarias";var C=a(R);C.value=C.__value="Cantabria";var D=a(C);D.value=D.__value="Castilla y León";var A=a(D);A.value=A.__value="Castilla-La Mancha";var L=a(A);L.value=L.__value="Cataluña";var I=a(L);I.value=I.__value="Ceuta y Melilla";var V=a(I);V.value=V.__value="Comunitat Valenciana";var B=a(V);B.value=B.__value="Extremadura";var F=a(B);F.value=F.__value="Galicia";var U=a(F);U.value=U.__value="La Rioja";var W=a(U);W.value=W.__value="Madrid";var G=a(W);G.value=G.__value="Murcia";var j=a(G);j.value=j.__value="Navarra";var H=a(j);H.value=H.__value="País Vasco";var X=a(H);X.value=X.__value="TOTAL",u(b);var S=a(b,2);K(()=>{t(o),ra(()=>{})});let Z;var aa=v(S);aa.value=aa.__value="";var z=a(aa);z.value=z.__value="SUP";var J=a(z);J.value=J.__value="SEC";var Y=a(J);Y.value=Y.__value="INF";var ia=a(Y);ia.value=ia.__value="TOTAL",u(S);var m=a(S,2);d(m);var ua=a(m,2);d(ua);var pa=a(ua,2);d(pa);var va=a(pa,2);d(va);var ca=a(va,2);d(ca);var _a=a(ca,2);d(_a);var ma=a(_a,2);d(ma);var wa=a(ma,2);d(wa),Qa(2),u(e),K((l,Ha)=>{k=Da(b,1,"",null,k,l),Z=Da(S,1,"",null,Z,Ha)},[()=>({empty:t(o).autonomous_community===""}),()=>({empty:t(o).education_level===""})],Wa),f(p,()=>t(o).from,l=>c(o,t(o).from=l)),f(_,()=>t(o).to,l=>c(o,t(o).to=l)),f(N,()=>t(o).year,l=>c(o,t(o).year=l)),na(b,()=>t(o).autonomous_community,l=>c(o,t(o).autonomous_community=l)),na(S,()=>t(o).education_level,l=>c(o,t(o).education_level=l)),f(m,()=>t(o).activity_rateMin,l=>c(o,t(o).activity_rateMin=l)),f(ua,()=>t(o).activity_rateMax,l=>c(o,t(o).activity_rateMax=l)),f(pa,()=>t(o).employment_rateMin,l=>c(o,t(o).employment_rateMin=l)),f(va,()=>t(o).employment_rateMax,l=>c(o,t(o).employment_rateMax=l)),f(ca,()=>t(o).unemployment_rateMin,l=>c(o,t(o).unemployment_rateMin=l)),f(_a,()=>t(o).unemployment_rateMax,l=>c(o,t(o).unemployment_rateMax=l)),f(ma,()=>t(o).limit,l=>c(o,t(o).limit=l)),f(wa,()=>t(o).offset,l=>c(o,t(o).offset=l)),q("submit",e,Ra(qa)),ea(n,e)};da(Ma,n=>{t(P)&&n(Ga)})}var Aa=a(Ma,4),La=a(v(Aa),2),xa=v(La),Na=v(xa);Xa(Na,5,()=>t(h),Za,(n,e)=>{var p=ut(),_=v(p),N=v(_,!0);u(_);var b=a(_),k=v(b,!0);u(b);var E=a(b),w=v(E,!0);u(E);var T=a(E),$=v(T,!0);u(T);var g=a(T),R=v(g,!0);u(g);var C=a(g),D=v(C,!0);u(C);var A=a(C),L=v(A),I=a(L,2);u(A),u(p),K(()=>{Q(N,t(e).autonomous_community),Q(k,t(e).year),Q(w,t(e).education_level),Q($,t(e).activity_rate),Q(R,t(e).employment_rate),Q(D,t(e).unemployment_rate)}),q("click",L,()=>rt(`/employment/edit/${encodeURIComponent(t(e).autonomous_community)}/${t(e).year}/${encodeURIComponent(t(e).education_level)}`)),q("click",I,()=>Va(t(e).autonomous_community,t(e).year,t(e).education_level)),ea(n,p)}),u(Na),u(xa),u(La),u(Aa),u(ya),u(la),q("click",Ea,Ia),q("click",Ta,Sa),q("click",ga,ka),q("click",Fa,ja),ea(O,la),Ya()}export{Mt as component};
