import{t as F,h as he,a as P}from"../chunks/Dv6fXY4X.js";import"../chunks/BzeH2q7d.js";import{t as ve,v as be,$ as ge,c as _,s,b as e,m as q,r as p,h as r,w as ee,x as c,y as ye}from"../chunks/DlljSLY3.js";import{e as w,s as C}from"../chunks/4MEhUbmR.js";import{i as M}from"../chunks/Dl4PlIxG.js";import{e as Ee,i as we}from"../chunks/Cw84kVwo.js";import{r as l}from"../chunks/CCAt2STN.js";import{t as $e,f as De,b as u,p as te}from"../chunks/Ck9kENiN.js";import{i as xe}from"../chunks/B8P2WNBa.js";import{o as Te}from"../chunks/DRvqIi7_.js";import{g as Re}from"../chunks/B--KP6qa.js";var ke=F('<p class="info-message"> </p>'),Ae=F('<form class="create-form"><input placeholder="Comunidad Aut√≥noma" required> <input type="number" placeholder="A√±o" required> <input type="number" placeholder="Formaci√≥n Profesional B√°sica" required step="any"> <input type="number" placeholder="Grado Medio" required step="any"> <input type="number" placeholder="Grado Superior" required step="any"> <button type="submit" class="submit">Crear</button> <button type="button" class="cancel">Cancelar</button></form>'),qe=F('<form class="create-form"><input type="number" placeholder="Desde a√±o"> <input type="number" placeholder="Hasta a√±o"> <input type="number" placeholder="A√±o exacto"> <input type="text" placeholder="Comunidad aut√≥noma"> <input type="number" placeholder="Formaci√≥n Profesional B√°sica exacto" step="any"> <input type="number" placeholder="Formaci√≥n Prof. B√°sica desde" step="any"> <input type="number" placeholder="Formaci√≥n Prof. B√°sica hasta" step="any"> <input type="number" placeholder="Grado Medio exacto" step="any"> <input type="number" placeholder="Grado Medio desde" step="any"> <input type="number" placeholder="Grado Medio hasta" step="any"> <input type="number" placeholder="Grado Superior exacto" step="any"> <input type="number" placeholder="Grado Superior desde" step="any"> <input type="number" placeholder="Grado Superior hasta" step="any"> <input type="number" placeholder="Limitar a..."> <input type="number" placeholder="Comenzar desde..."> <button class="btn" type="submit">Buscar</button></form>'),Ce=F('<tr><td> </td><td> </td><td> </td><td> </td><td> </td><td class="actions"><button class="btn-circle" title="Editar Registro"><i class="fas fa-pen"></i></button> <button class="btn-circle" title="Eliminar Registro"><i class="fas fa-times"></i></button></td></tr>'),Ge=F('<div class="wrapper dash"><div class="container dash"><!> <div class="header"><h3>Datos de Educaci√≥n</h3> <div class="actions"><button class="btn"><i class="fas fa-search"></i> B√∫squeda</button> <button class="btn"><i class="fas fa-plus"></i> Nuevo registro</button> <button class="btn"><i class="fas fa-sync-alt"></i> Recargar los datos iniciales</button> <button class="btn"><i class="fas fa-trash-alt"></i> Eliminar todos los datos</button></div></div> <!> <!> <div class="seeker"></div> <div class="table-container"><table><thead><tr><th>Comunidad Aut√≥noma</th><th>A√±o</th><th>Formaci√≥n Profesional B√°sica</th><th>Grado Medio</th><th>Grado Superior</th><th>Acciones</th></tr></thead></table> <div class="scroll-body"><table><tbody></tbody></table></div></div></div></div>');function Ue(re,ae){ve(ae,!1);let $="/api/v1/education-data",b=q([]),i=q(""),T=q(!1),G=q(!1),f=q({autonomous_community:"",year:"",basic_fp:"",middle_grade:"",higher_grade:""}),t=q({from:"",to:"",year:"",autonomous_community:"",basic_fp_from:"",basic_fp_to:"",middle_grade_from:"",middle_grade_to:"",higher_grade_from:"",higher_grade_to:"",limit:"",offset:""});async function R(){try{const o=await fetch($);if(!o.ok){o.status===404?r(i,"No se encontraron datos de educaci√≥n."):o.status===500?r(i,"Error del servidor. Intenta m√°s tarde."):r(i,"Error inesperado"),r(b,[]);return}r(b,await o.json())}catch(o){console.error("[GET] Error cargando datos:",o),r(i,"No se pudo conectar con el servidor."),r(b,[])}setTimeout(()=>r(i,""),2e3)}function oe(){r(G,!e(G)),r(T,!1),e(G)||(r(t,{from:"",to:"",year:"",autonomous_community:"",basic_fp:"",middle_grade:"",higher_grade:"",basic_fp_from:"",basic_fp_to:"",middle_grade_from:"",middle_grade_to:"",higher_grade_from:"",higher_grade_to:"",limit:"",offset:""}),r(i,""),R())}function ie(){r(T,!e(T)),r(G,!1)}async function se(){const o=new URLSearchParams;for(const[a,d]of Object.entries(e(t)))d!==""&&d!==null&&d!==void 0&&o.append(a,d);try{const a=await fetch(`${$}?${o.toString()}`);if(!a.ok){a.status===400?r(i,"Par√°metros de b√∫squeda no v√°lidos."):a.status===500?r(i,"Error interno del servidor al buscar."):r(i,"Error inesperado"),r(b,[]);return}r(b,await a.json()),e(b).length===0?r(i,"No se encontraron resultados para tu b√∫squeda."):r(i,`Se encontraron ${e(b).length} resultados.`)}catch(a){console.error("[SEARCH] Error al buscar:",a),r(i,"No se pudo conectar con el servidor."),r(b,[])}setTimeout(()=>r(i,""),2e3)}async function ne(){try{const o=await fetch($,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e(f))}),a=await o.json();o.status===201?(r(i,"Registro creado correctamente"),r(T,!1),de(),await R()):o.status===400?r(i,`Datos inv√°lidos: ${a.error||"Revisa los campos."}`):o.status===409?r(i,"Ya existe un registro con esos identificadores."):r(i,`Error inesperado (${o.status}) al procesar la petici√≥n.`)}catch(o){console.error("[CREATE] Error:",o),r(i,"No se pudo conectar con el servidor.")}setTimeout(()=>r(i,""),2e3)}function de(){r(f,{autonomous_community:"",year:"",basic_fp:"",middle_grade:"",higher_grade:""})}async function ce(){const o=`${$}/loadInitialData?reset=true`,a=`${$}/loadInitialData`;try{if(e(b).length>0){if(!confirm("There are existing records. Do you want to reload the initial data and reset everything?"))return;const m=await fetch(o);if(!m.ok)throw new Error(`Error ${m.status}`);r(i,"üîÑ Initial data reloaded with reset.")}else{const d=await fetch(a);if(!d.ok)throw new Error(`Error ${d.status}`);r(i,"üì• Initial data loaded.")}await R()}catch(d){console.error("[LOAD INITIAL DATA] Error:",d),r(i,"‚ùå Error loading initial data.")}setTimeout(()=>{r(i,"")},3e3)}async function le(){if(confirm("¬øEst√°s seguro de que quieres eliminar todos los registros de educaci√≥n?")){try{const a=await fetch($,{method:"DELETE"});a.status===200?(r(i,"Todos los registros de educaci√≥n han sido eliminados."),await R()):a.status===404?r(i,"No hay registros de educaci√≥n que eliminar."):r(i,"Error al eliminar los registros de educaci√≥n.")}catch(a){console.error("[DELETE] Error eliminando registros de educaci√≥n:",a),r(i,"Error al eliminar los registros de educaci√≥n.")}setTimeout(()=>{r(i,"")},2e3)}}async function ue(o,a){if(confirm(`¬øEst√°s seguro de que quieres eliminar el registro de educaci√≥n en ${o} (${a})?`)){try{const m=await fetch(`${$}/${o}/${a}`,{method:"DELETE"});m.status===200?(r(i,`Registro de educaci√≥n en ${o} (${a}) eliminado correctamente.`),await R()):m.status===404?r(i,"Registro de educaci√≥n no encontrado."):r(i,"Error al eliminar el registro de educaci√≥n.")}catch(m){console.error("[DELETE] Error eliminando el registro de educaci√≥n:",m),r(i,"Error al eliminar el registro de educaci√≥n.")}setTimeout(()=>{r(i,"")},2e3)}}Te(async()=>{await R()}),xe();var L=Ge();he(o=>{ge.title="Datos de Educaci√≥n"});var j=_(L),O=_(j);{var me=o=>{var a=ke(),d=_(a,!0);p(a),ee(()=>C(d,e(i))),$e(3,a,()=>De,()=>({duration:300})),P(o,a)};M(O,o=>{e(i)&&o(me)})}var B=s(O,2),H=s(_(B),2),U=_(H),z=s(U,2),J=s(z,2),pe=s(J,2);p(H),p(B);var Y=s(B,2);{var fe=o=>{var a=Ae(),d=_(a);l(d);var m=s(d,2);l(m);var g=s(m,2);l(g);var v=s(g,2);l(v);var y=s(v,2);l(y);var E=s(y,4);p(a),u(d,()=>e(f).autonomous_community,h=>c(f,e(f).autonomous_community=h)),u(m,()=>e(f).year,h=>c(f,e(f).year=h)),u(g,()=>e(f).basic_fp,h=>c(f,e(f).basic_fp=h)),u(v,()=>e(f).middle_grade,h=>c(f,e(f).middle_grade=h)),u(y,()=>e(f).higher_grade,h=>c(f,e(f).higher_grade=h)),w("click",E,()=>r(T,!1)),w("submit",a,te(ne)),P(o,a)};M(Y,o=>{e(T)&&o(fe)})}var K=s(Y,2);{var _e=o=>{var a=qe(),d=_(a);l(d);var m=s(d,2);l(m);var g=s(m,2);l(g);var v=s(g,2);l(v);var y=s(v,2);l(y);var E=s(y,2);l(E);var h=s(E,2);l(h);var D=s(h,2);l(D);var I=s(D,2);l(I);var x=s(I,2);l(x);var S=s(x,2);l(S);var k=s(S,2);l(k);var A=s(k,2);l(A);var N=s(A,2);l(N);var Z=s(N,2);l(Z),ye(2),p(a),u(d,()=>e(t).from,n=>c(t,e(t).from=n)),u(m,()=>e(t).to,n=>c(t,e(t).to=n)),u(g,()=>e(t).year,n=>c(t,e(t).year=n)),u(v,()=>e(t).autonomous_community,n=>c(t,e(t).autonomous_community=n)),u(y,()=>e(t).basic_fp,n=>c(t,e(t).basic_fp=n)),u(E,()=>e(t).basic_fp_from,n=>c(t,e(t).basic_fp_from=n)),u(h,()=>e(t).basic_fp_to,n=>c(t,e(t).basic_fp_to=n)),u(D,()=>e(t).middle_grade,n=>c(t,e(t).middle_grade=n)),u(I,()=>e(t).middle_grade_from,n=>c(t,e(t).middle_grade_from=n)),u(x,()=>e(t).middle_grade_to,n=>c(t,e(t).middle_grade_to=n)),u(S,()=>e(t).higher_grade,n=>c(t,e(t).higher_grade=n)),u(k,()=>e(t).higher_grade_from,n=>c(t,e(t).higher_grade_from=n)),u(A,()=>e(t).higher_grade_to,n=>c(t,e(t).higher_grade_to=n)),u(N,()=>e(t).limit,n=>c(t,e(t).limit=n)),u(Z,()=>e(t).offset,n=>c(t,e(t).offset=n)),w("submit",a,te(se)),P(o,a)};M(K,o=>{e(G)&&o(_e)})}var Q=s(K,4),V=s(_(Q),2),W=_(V),X=_(W);Ee(X,5,()=>e(b),we,(o,a)=>{var d=Ce(),m=_(d),g=_(m,!0);p(m);var v=s(m),y=_(v,!0);p(v);var E=s(v),h=_(E,!0);p(E);var D=s(E),I=_(D,!0);p(D);var x=s(D),S=_(x,!0);p(x);var k=s(x),A=_(k),N=s(A,2);p(k),p(d),ee(()=>{C(g,e(a).autonomous_community),C(y,e(a).year),C(h,e(a).basic_fp),C(I,e(a).middle_grade),C(S,e(a).higher_grade)}),w("click",A,()=>Re(`/education/edit/${encodeURIComponent(e(a).autonomous_community)}/${e(a).year}`)),w("click",N,()=>ue(e(a).autonomous_community,e(a).year)),P(o,d)}),p(X),p(W),p(V),p(Q),p(j),p(L),w("click",U,oe),w("click",z,ie),w("click",J,ce),w("click",pe,le),P(re,L),be()}export{Ue as component};
