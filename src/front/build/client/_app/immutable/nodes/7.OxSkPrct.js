import{t as L,h as ft,a as S}from"../chunks/tvbMF9Pj.js";import"../chunks/V6KxLFIZ.js";import{t as yt,v as bt,$ as ht,c as m,s as i,b as t,m as k,r as u,h as a,w as j,B as Et,x as d,y as gt}from"../chunks/gUvyREcO.js";import{e as A,s as q}from"../chunks/wr67jiHF.js";import{i as F}from"../chunks/DoNM67fw.js";import{e as Tt,i as xt}from"../chunks/Dg7488E7.js";import{r as p}from"../chunks/5kF7woBx.js";import{t as Mt,f as $t}from"../chunks/DQyGuE4Y.js";import{b as v,p as tt}from"../chunks/CQDDud96.js";import{b as wt}from"../chunks/nEcg0J-M.js";import{i as Dt}from"../chunks/DdSIFJQO.js";import{o as At}from"../chunks/WRe_eenc.js";import{g as qt}from"../chunks/DDgU0adY.js";var Ct=L('<p class="info-message"> </p>'),Nt=L('<form class="create-form"><input placeholder="Comunidad Autónoma" required> <input type="number" placeholder="Año" required> <select required><option disabled selected>Nivel educativo</option><option>Educación superior (SUP)</option><option>Secundaria (SEC)</option><option>Inferior a secundaria (INF)</option><option>Total (TOTAL)</option></select> <input type="number" step="0.01" placeholder="Tasa actividad" required> <input type="number" step="0.01" placeholder="Tasa empleo" required> <input type="number" step="0.01" placeholder="Tasa paro" required> <button type="submit" class="submit">Crear</button> <button type="button" class="cancel">Cancelar</button></form>'),Rt=L('<form class="create-form"><input type="number" placeholder="Desde año"> <input type="number" placeholder="Hasta año"> <input type="number" placeholder="Año exacto"> <input type="text" placeholder="Comunidad autónoma"> <input type="text" placeholder="Nivel educativo"> <input type="number" placeholder="Tasa actividad min"> <input type="number" placeholder="Tasa actividad max"> <input type="number" placeholder="Tasa empleo min"> <input type="number" placeholder="Tasa empleo max"> <input type="number" placeholder="Tasa paro min"> <input type="number" placeholder="Tasa paro max"> <input type="number" placeholder="Limitar a..."> <input type="number" placeholder="Comenzar desde..."> <button class="btn" type="submit">Buscar</button></form>'),kt=L('<tr><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td class="actions"><button class="btn-circle" title="Editar Registro"><i class="fas fa-pen"></i></button>  <button class="btn-circle" title="Eliminar Registro"><i class="fas fa-times"></i></button></td></tr>'),It=L('<div class="wrapper dash"><div class="container dash"><!> <div class="header"><h3>Datos de empleo</h3> <div class="actions"><button class="btn"><i class="fas fa-search"></i> Búsqueda</button> <button class="btn"><i class="fas fa-plus"></i> Nuevo registro</button> <button class="btn"><i class="fas fa-sync-alt"></i> Recargar los datos iniciales</button> <button class="btn"><i class="fas fa-trash-alt"></i> Eliminar todos los datos</button></div></div> <!> <!> <div class="seeker"></div> <div class="table-container"><table><thead><tr><th>Comunidad Autónoma</th><th>Año</th><th>Nivel educativo</th><th>Tasa de actividad</th><th>Tasa de empleo</th><th>Tasa de paro</th><th>Acciones</th></tr></thead></table> <div class="scroll-body"><table><tbody></tbody></table></div></div></div></div>');function Kt(et,at){yt(at,!1);let C="/api/v1/employment-data",T=k([]),n=k(""),N=k(!1),I=k(!1),c=k({autonomous_community:"",year:"",education_level:"",activity_rate:"",employment_rate:"",unemployment_rate:""}),r=k({from:"",to:"",year:"",autonomous_community:"",education_level:"",activity_rateMin:"",activity_rateMax:"",employment_rateMin:"",employment_rateMax:"",unemployment_rateMin:"",unemployment_rateMax:"",limit:"",offset:""});async function R(){try{const o=await fetch(C);if(!o.ok){o.status===404?a(n,"No se encontraron datos de empleo."):o.status===500?a(n,"Error del servidor. Intenta más tarde."):a(n,"Error inesperado"),a(T,[]);return}a(T,await o.json())}catch(o){console.error("[GET] Error cargando datos:",o),a(n,"No se pudo conectar con el servidor."),a(T,[])}setTimeout(()=>a(n,""),2e3)}function rt(){a(I,!t(I)),a(N,!1),t(I)||(a(r,{from:"",to:"",year:"",autonomous_community:"",education_level:"",activity_rateMin:"",activity_rateMax:"",employment_rateMin:"",employment_rateMax:"",unemployment_rateMin:"",unemployment_rateMax:"",limit:"",offset:""}),a(n,""),R())}function ot(){a(N,!t(N)),a(I,!1)}async function it(){const o=new URLSearchParams;for(const[e,l]of Object.entries(t(r)))l!==""&&l!==null&&l!==void 0&&o.append(e,l);try{const e=await fetch(`${C}?${o.toString()}`);if(!e.ok){e.status===400?a(n,"Parámetros de búsqueda no válidos."):e.status===500?a(n,"Error interno del servidor al buscar."):a(n,"Error inesperado"),a(T,[]);return}a(T,await e.json()),t(T).length===0?a(n,"No se encontraron resultados para tu búsqueda."):a(n,`Se encontraron ${t(T).length} resultados.`)}catch(e){console.error("[SEARCH] Error al buscar:",e),a(n,"No se pudo conectar con el servidor."),a(T,[])}setTimeout(()=>a(n,""),2e3)}async function nt(){try{const o=await fetch(C,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t(c))}),e=await o.json();o.status===201?(a(n,"Registro creado correctamente"),a(N,!1),st(),await R()):o.status===400?a(n,"Datos inválidos: revisa los campos."):o.status===409?a(n,"Ya existe un registro con esos identificadores."):a(n,"Error inesperado al procesar la petición.")}catch(o){console.error("[CREATE] Error:",o),a(n,"No se pudo conectar con el servidor.")}setTimeout(()=>a(n,""),2e3)}function st(){a(c,{autonomous_community:"",year:"",education_level:"",activity_rate:"",employment_rate:"",unemployment_rate:""})}async function lt(){const o=`${C}/loadInitialData`;try{const e=await fetch(o);if(!e.ok)throw new Error(`Error ${e.status}`);a(n,"Datos iniciales cargados."),await R()}catch(e){console.error("[LOAD INITIAL DATA] Error:",e),a(n,"Error al cargar los datos iniciales.")}setTimeout(()=>{a(n,"")},2e3)}async function ct(){if(confirm("¿Estás seguro de que quieres eliminar todos los registros?")){try{const e=await fetch(C,{method:"DELETE"});e.status===200?(a(n,"Todos los registros han sido eliminados."),await R()):e.status===404?a(n,"No hay registros que eliminar."):a(n,"Error al eliminar")}catch(e){console.error("[DELETE] Error deleting records:",e),a(n,"Error al eliminar los registros.")}setTimeout(()=>{a(n,"")},2e3)}}async function ut(o,e,l){if(confirm(`¿Estás seguro de que quieres eliminar el registro de ${o} (${e}, ${l})?`)){try{const f=await fetch(`${C}/${o}/${e}/${l}`,{method:"DELETE"});f.status===200?(a(n,`Registro de ${o} (${e}, ${l}) eliminado correctamente.`),await R()):f.status===404?a(n,"Registro no encontrado."):a(n,"Error al eliminar")}catch(f){console.error("[DELETE] Error deleting record:",f),a(n,"Error al eliminar el registro.")}setTimeout(()=>{a(n,"")},2e3)}}At(async()=>{await R()}),Dt();var O=It();ft(o=>{ht.title="Datos de Empleo"});var U=m(O),B=m(U);{var mt=o=>{var e=Ct(),l=m(e,!0);u(e),j(()=>q(l,t(n))),Mt(3,e,()=>$t,()=>({duration:300})),S(o,e)};F(B,o=>{t(n)&&o(mt)})}var P=i(B,2),H=i(m(P),2),z=m(H),G=i(z,2),J=i(G,2),dt=i(J,2);u(H),u(P);var Y=i(P,2);{var pt=o=>{var e=Nt(),l=m(e);p(l);var y=i(l,2);p(y);var f=i(y,2);j(()=>{t(c),Et(()=>{})});var b=m(f);b.value=b.__value="";var x=i(b);x.value=x.__value="SUP";var h=i(x);h.value=h.__value="SEC";var M=i(h);M.value=M.__value="INF";var g=i(M);g.value=g.__value="TOTAL",u(f);var $=i(f,2);p($);var E=i($,2);p(E);var w=i(E,2);p(w);var D=i(w,4);u(e),v(l,()=>t(c).autonomous_community,_=>d(c,t(c).autonomous_community=_)),v(y,()=>t(c).year,_=>d(c,t(c).year=_)),wt(f,()=>t(c).education_level,_=>d(c,t(c).education_level=_)),v($,()=>t(c).activity_rate,_=>d(c,t(c).activity_rate=_)),v(E,()=>t(c).employment_rate,_=>d(c,t(c).employment_rate=_)),v(w,()=>t(c).unemployment_rate,_=>d(c,t(c).unemployment_rate=_)),A("click",D,()=>a(N,!1)),A("submit",e,tt(nt)),S(o,e)};F(Y,o=>{t(N)&&o(pt)})}var K=i(Y,2);{var vt=o=>{var e=Rt(),l=m(e);p(l);var y=i(l,2);p(y);var f=i(y,2);p(f);var b=i(f,2);p(b);var x=i(b,2);p(x);var h=i(x,2);p(h);var M=i(h,2);p(M);var g=i(M,2);p(g);var $=i(g,2);p($);var E=i($,2);p(E);var w=i(E,2);p(w);var D=i(w,2);p(D);var _=i(D,2);p(_),gt(2),u(e),v(l,()=>t(r).from,s=>d(r,t(r).from=s)),v(y,()=>t(r).to,s=>d(r,t(r).to=s)),v(f,()=>t(r).year,s=>d(r,t(r).year=s)),v(b,()=>t(r).autonomous_community,s=>d(r,t(r).autonomous_community=s)),v(x,()=>t(r).education_level,s=>d(r,t(r).education_level=s)),v(h,()=>t(r).activity_rateMin,s=>d(r,t(r).activity_rateMin=s)),v(M,()=>t(r).activity_rateMax,s=>d(r,t(r).activity_rateMax=s)),v(g,()=>t(r).employment_rateMin,s=>d(r,t(r).employment_rateMin=s)),v($,()=>t(r).employment_rateMax,s=>d(r,t(r).employment_rateMax=s)),v(E,()=>t(r).unemployment_rateMin,s=>d(r,t(r).unemployment_rateMin=s)),v(w,()=>t(r).unemployment_rateMax,s=>d(r,t(r).unemployment_rateMax=s)),v(D,()=>t(r).limit,s=>d(r,t(r).limit=s)),v(_,()=>t(r).offset,s=>d(r,t(r).offset=s)),A("submit",e,tt(it)),S(o,e)};F(K,o=>{t(I)&&o(vt)})}var Q=i(K,4),V=i(m(Q),2),W=m(V),X=m(W);Tt(X,5,()=>t(T),xt,(o,e)=>{var l=kt(),y=m(l),f=m(y,!0);u(y);var b=i(y),x=m(b,!0);u(b);var h=i(b),M=m(h,!0);u(h);var g=i(h),$=m(g,!0);u(g);var E=i(g),w=m(E,!0);u(E);var D=i(E),_=m(D,!0);u(D);var s=i(D),Z=m(s),_t=i(Z,2);u(s),u(l),j(()=>{q(f,t(e).autonomous_community),q(x,t(e).year),q(M,t(e).education_level),q($,t(e).activity_rate),q(w,t(e).employment_rate),q(_,t(e).unemployment_rate)}),A("click",Z,()=>qt(`/employment/edit/${encodeURIComponent(t(e).autonomous_community)}/${t(e).year}/${encodeURIComponent(t(e).education_level)}`)),A("click",_t,()=>ut(t(e).autonomous_community,t(e).year,t(e).education_level)),S(o,l)}),u(X),u(W),u(V),u(Q),u(U),u(O),A("click",z,rt),A("click",G,ot),A("click",J,lt),A("click",dt,ct),S(et,O),bt()}export{Kt as component};
