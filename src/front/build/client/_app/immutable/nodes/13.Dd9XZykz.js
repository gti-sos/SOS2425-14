import{t as u,h as V,a as m}from"../chunks/CcBKTLYU.js";import"../chunks/BQvSbhnN.js";import{p as J,t as y,g as r,a as Q,$ as Y,s as h,c as l,b as i,m as b,n as Z,i as K,r as n}from"../chunks/B9KnJm2w.js";import{e as X,s as O}from"../chunks/b-klYKnl.js";import{i as E}from"../chunks/DRx51zI4.js";import{e as aa,i as ea}from"../chunks/CVAR8tF5.js";import{s as ta}from"../chunks/D_AC4_dt.js";import{b as oa}from"../chunks/CmRUGO1p.js";import{i as ra}from"../chunks/B7KipWS9.js";import{o as ia}from"../chunks/BKuOihLL.js";var sa=u('<meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0">',1),na=u("<option> </option>"),ca=u("<p>Cargando datos...</p>"),la=u('<p style="color: red"> </p>'),da=u('<img alt="Gráfica de tasa de paro">'),pa=u('<div class="wrapper"><div class="container"><h2>Gráficas de employment-data</h2> <hr style="width: 100%; animation: loadHrGraph 1s;"> <div class="graph-container"><h3>Selecciona la comunidad autónmoma:</h3> <select class="custom-select"></select></div> <div class="article"><h3>Gráfica de la tasa de empleo</h3> <p>Esta gráfica permite visualizar los datos de empleo por año y nivel educativo. Puedes seleccionar la comunidad autónoma en específico.</p></div> <div class="graph-container"><figure class="highcharts-figure svelte-t3krpg"><div id="container"></div> <!> <!></figure></div> <div class="article"><h3>Gráfica de la tasa de paro</h3> <p>Esta gráfica permite visualizar la tasa de paro por años según la comunidad autónoma elegida.</p></div> <div class="graph-container"><!></div></div></div>');function Ca(P,D){J(D,!1);let M="/api/v1/employment-data",p=[],_=["INF","SEC","SUP","TOTAL"],g=[],x=b(!0),c=b("");const R=["Andalucía","Aragón","Asturias","Baleares","Canarias","Cantabria","Castilla-La Mancha","Castilla y León","Cataluña","Comunitat Valenciana","Extremadura","Galicia","Madrid","Murcia","Navarra","País Vasco","La Rioja","Ceuta y Melilla","TOTAL"];let C=b(""),d=b("Andalucía");function v(a){return new Promise((e,o)=>{if(document.querySelector(`script[src="${a}"]`))return e();const t=document.createElement("script");t.src=a,t.onload=e,t.onerror=o,document.head.appendChild(t)})}async function T(){i(x,!0),i(c,"");const a=`${M}?autonomous_community=${encodeURIComponent(r(d))}`;try{console.log(`Solicitando datos a: ${a}`);const e=await fetch(a,{method:"GET"});if(!e.ok)throw new Error(`Error en la respuesta: ${e.status}`);p=await e.json(),console.log(`Datos recibidos: ${p.length} registros para ${r(d)}`),g=[...new Set(p.map(s=>s.year))].sort(),U(),B()}catch(e){console.error(`ERROR al obtener datos de ${a}: ${e}`),i(c,`Error al cargar datos: ${e.message}`)}finally{i(x,!1)}}function U(){if(p.length===0){console.log("No hay datos para mostrar"),i(c,"No hay datos disponibles para la comunidad seleccionada");return}const a=[];if(_.forEach((e,o)=>{g.forEach((s,t)=>{const N=p.find(L=>L.education_level===e&&L.year===s);N&&a.push([t,o,N.employment_rate])})}),a.length===0){console.error("No se encontraron puntos de datos para el gráfico"),i(c,"No hay datos disponibles para generar el gráfico para la comunidad seleccionada");return}console.log(`Generando gráfico con ${a.length} puntos de datos`),Highcharts.chart("container",{chart:{type:"heatmap",marginTop:40,marginBottom:80,plotBorderWidth:1},title:{text:`Tasa de empleo por nivel educativo en ${r(d)}`,style:{fontSize:"1.2em"}},xAxis:{categories:g.map(String),title:{text:"Año"}},yAxis:{categories:_,title:{text:"Nivel Educativo"},reversed:!0},colorAxis:{min:40,max:100,minColor:"#e0bbff",maxColor:"#5f4b8b"},legend:{align:"right",layout:"vertical",margin:0,verticalAlign:"top",y:25,symbolHeight:280},tooltip:{formatter(){return`<b>Año: ${g[this.point.x]}</b><br><b>Nivel educativo: ${_[this.point.y]}</b><br><b>Tasa de empleo: ${this.point.value.toFixed(2)}%</b>`}},series:[{name:"Tasa de empleo",borderWidth:0,data:a,dataLabels:{enabled:!0,color:"#ffffff"}}],responsive:{rules:[{condition:{maxWidth:500},chartOptions:{yAxis:{labels:{style:{fontSize:"10px"}}},legend:{align:"center",verticalAlign:"bottom",layout:"horizontal",y:0}}}]}})}function z(){i(c,""),T()}function B(){const a={};p.forEach(t=>{t.education_level==="TOTAL"&&!a[t.year]&&(a[t.year]=t.unemployment_rate)});const e=Object.keys(a),o=Object.values(a).map(t=>parseFloat(t.toFixed(2))),s={type:"bar",data:{labels:e,datasets:[{label:"Tasa de paro (%)",data:o,backgroundColor:"rgba(138, 43, 226, 0.7)"}]},options:{title:{display:!0,text:`Tasa de paro en ${r(d)} por año`},scales:{yAxes:[{ticks:{beginAtZero:!0,max:30}}]}}};i(C,`https://quickchart.io/chart?w=500&h=300&c=${encodeURIComponent(JSON.stringify(s))}`)}ia(async()=>{try{await v("https://code.highcharts.com/highcharts.js"),await v("https://code.highcharts.com/modules/heatmap.js"),await v("https://code.highcharts.com/modules/exporting.js"),await v("https://code.highcharts.com/modules/export-data.js"),await v("https://code.highcharts.com/modules/accessibility.js"),await T()}catch(a){i(c,`Error cargando scripts de Highcharts: ${a}`),console.error(a)}}),ra();var A=pa();V(a=>{var e=sa();Y.title="Graphs - Employment Data",Z(2),m(a,e)});var S=l(A),$=h(l(S),4),f=h(l($),2);y(()=>{r(d),K(()=>{})}),aa(f,5,()=>R,ea,(a,e)=>{var o=na(),s={},t=l(o,!0);n(o),y(()=>{s!==(s=r(e))&&(o.value=(o.__value=r(e))??""),O(t,r(e))}),m(a,o)}),n(f),n($);var w=h($,4),j=l(w),k=h(l(j),2);{var F=a=>{var e=ca();m(a,e)};E(k,a=>{r(x)&&a(F)})}var I=h(k,2);{var H=a=>{var e=la(),o=l(e,!0);n(e),y(()=>O(o,r(c))),m(a,e)};E(I,a=>{r(c)&&a(H)})}n(j),n(w);var G=h(w,4),q=l(G);{var W=a=>{var e=da();y(()=>ta(e,"src",r(C))),m(a,e)};E(q,a=>{r(C)&&a(W)})}n(G),n(S),n(A),oa(f,()=>r(d),a=>i(d,a)),X("change",f,z),m(P,A),Q()}export{Ca as component};
