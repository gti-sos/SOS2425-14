import{t as g,h as Ge,a as u}from"../chunks/BgiXASfF.js";import"../chunks/BIROYZXv.js";import{p as Ie,a as Se,$ as Te,s,c as n,n as b,g as j,m as Ne,r as l,b as c}from"../chunks/CpQaROA0.js";import{i as F}from"../chunks/D1Iy4rpg.js";import{s as z}from"../chunks/DpvMPi6q.js";import{t as f,f as p}from"../chunks/ByJhS31L.js";import{i as Pe}from"../chunks/CZQ4deT6.js";import{o as Me}from"../chunks/BXqaL1Zo.js";var Re=g('<meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0">',1),qe=g('<p style="color: #fff; text-align: center; font-weight: bold;">Cargando datos...</p>'),Oe=g('<p style="color: #fff; text-align: center; font-weight: bold;">Cargando datos...</p>'),Le=g('<p style="color: #fff; text-align: center; font-weight: bold;">Cargando datos...</p>'),He=g('<p style="color: #fff; text-align: center; font-weight: bold;">Cargando datos...</p>'),Ue=g(`<div class="wrapper"><div class="container"><h2 style="text-align: center;">Integraciones <br><i>Francisco Javier</i></h2> <hr style="width: 100%; animation: loadHrGraph 1s; transition: all 0.3s ease;"> <div><div class="article" style="margin-top: 0;"><h3 style="font-size: 1.5em; text-transform: none;">Distribución del Uso del Suelo en Cádiz</h3> <p>Este gráfico representa cómo se reparte la superficie de la provincia de Cádiz entre
					distintos usos del suelo: superficie cultivada, pastos, terreno forestal y superficie no
					agraria. La visualización permite observar de forma clara qué tipo de aprovechamiento
					predomina en el territorio durante el año seleccionado.</p> <a style="color: #fff;" target="_blank"><i>G15 - ocupied-grand-stats</i></a> <figure class="chartjs-figure svelte-47s6as"><!> <canvas id="15Chart"></canvas></figure></div> <div class="article" style="margin-top: 1em;"><h3 style="font-size: 1.5em; text-transform: none;">Accidentes con Animales por Grupo (2023)</h3> <p>Este gráfico muestra cuántos accidentes de tráfico con animales estuvieron relacionados
					con cada grupo animal durante el año 2023. Permite identificar qué tipos de fauna están
					más implicados en este tipo de incidentes según los registros recopilados a nivel
					nacional.</p> <a style="color: #fff;" target="_blank"><i>G20 - accidents-with-animals</i></a> <figure class="chartjs-figure svelte-47s6as"><!> <canvas id="20Chart"></canvas></figure></div> <div class="article" style="margin-top: 0;"><h3 style="font-size: 1.5em; text-transform: none;">Distribución del Consumo Energético por Fuente</h3> <p>Este gráfico radar muestra cómo se reparte el consumo energético entre electricidad, gas y
					otras fuentes en Andalucía durante el año 2021. Esta visualización permite comparar
					fácilmente las prioridades energéticas regionales y su evolución temporal.</p> <a style="color: #fff;" target="_blank"><i>G12 - annual-consumptions</i></a> <figure class="chartjs-figure svelte-47s6as"><!> <canvas id="12Chart"></canvas></figure></div> <div class="article" style="margin-top: 0;"><h3 style="font-size: 1.5em; text-transform: none;">Superficie Actual de los Parques Nacionales</h3> <p>Este gráfico muestra la superficie actual en hectáreas de los distintos parques nacionales
					de España. Permite comparar el tamaño de cada parque natural y analizar cómo varía su
					extensión a lo largo del territorio nacional.</p> <a style="color: #fff;" target="_blank"><i>G13 - national-parks</i></a> <figure class="chartjs-figure svelte-47s6as"><!> <canvas id="13Chart"></canvas></figure></div> <div class="article" style="margin-top: 2em;"><h3>Comparativa Climática de Varias Ciudades</h3> <p>Este gráfico de burbujas permite comparar en tiempo real la temperatura, humedad y
					velocidad del viento en cinco ciudades españolas: Sevilla, Madrid, Barcelona, Valencia y
					Bilbao.</p> <a style="color: #fff;" href="https://openweathermap.org/current" target="_blank"><i>API externa - OpenWeatherMap</i></a> <figure class="chartjs-figure svelte-47s6as"><canvas id="externalChart"></canvas></figure></div> <div class="article" style="margin-top: 0;"><h3 style="font-size: 1.5em; text-transform: none;">Temperatura Horaria en Sevilla (AEMET)</h3> <p>Este gráfico de dispersión representa las temperaturas registradas en distintas horas del
					día en Sevilla, según los datos proporcionados por la Agencia Estatal de Meteorología.
					Permite visualizar cómo varía la temperatura a lo largo de la jornada.</p> <a style="color: #fff;" href="https://www.aemet.es/es/eltiempo/prediccion/municipios/sevilla-id41091" target="_blank"><i>AEMET - Predicción Sevilla</i></a> <figure class="chartjs-figure svelte-47s6as"><p id="mensaje" style="color: #fff; text-align: center; font-weight: bold;"></p> <canvas id="aemetChart"></canvas></figure></div></div></div></div>`);function ea(se,ie){Ie(ie,!1);const C="https://sos2425-15.onrender.com/api/v1/ocupied-grand-stats/",w="https://sos2425-20.onrender.com/api/v1/accidents-with-animals",E="https://sos2425-12.onrender.com/api/v1/annual-consumptions",x="https://sos2425-13.onrender.com/api/v2/national-parks";let D=[],G=[],I=[],m=[],i=Ne(!0);async function ne(){c(i,!0);try{console.log(`Solicitando datos a: ${C}`);const e=await fetch(C,{method:"GET",headers:{Accept:"application/json"}});if(!e.ok)throw new Error(`Error en la respuesta: ${e.status}`);D=await e.json(),console.log(`Datos recibidos: ${D.length} registros`),ce()}catch(e){console.error(`ERROR al obtener datos de ${C}: ${e}`),`${e.message}`}finally{c(i,!1)}}let _,Y=2021,le="cadiz";function ce(){var t;const e=D.find(o=>Number(o.year)===Number(Y)&&o.province.toLowerCase()===le.toLowerCase());if(!e)return;const a=(t=document.getElementById("15Chart"))==null?void 0:t.getContext("2d");a&&(_&&(_.destroy(),_=null),_=new Chart(a,{type:"doughnut",data:{labels:["Ground","Grass","Wooded","Non Agrarian Surface"],datasets:[{label:`${e.province.toUpperCase()} - ${Y}`,data:[e.ground??0,e.grass??0,e.wooded??0,e.non_agrarian_surface??0],backgroundColor:["#36A2EB","#FFCE56","#FF6384","#4BC0C0"]}]},options:{responsive:!0,plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:"Distribución del Uso del Suelo en Cádiz",color:"#fff",font:{size:20,weight:"bold",family:"Arial"}}}}}))}async function de(){c(i,!0);try{console.log(`Solicitando datos a: ${w}`);const e=await fetch(w,{method:"GET",headers:{Accept:"application/json"}});if(!e.ok)throw new Error(`Error en la respuesta: ${e.status}`);G=await e.json(),console.log(`Datos recibidos: ${G.length} registros`),fe()}catch(e){console.error(`ERROR al obtener datos de ${w}: ${e}`),`${e.message}`}finally{c(i,!1)}}let A;function fe(){var v;const a=G.filter(d=>Number(d.anyo)===2023),t={};for(const d of a){const y=d.animal_group;t[y]=(t[y]||0)+1}const o=Object.keys(t).map(d=>`Grupo ${d}`),r=Object.values(t),h=(v=document.getElementById("20Chart"))==null?void 0:v.getContext("2d");h&&(A&&(A.destroy(),A=null),A=new Chart(h,{type:"polarArea",data:{labels:o,datasets:[{label:"Número de accidentes por grupo animal",data:r,backgroundColor:["#36A2EB","#FFCE56","#FF6384","#4BC0C0","#9966FF","#00D98B"]}]},options:{responsive:!0,plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:"Accidentes con Animales por Grupo (2023)",color:"#fff",font:{size:20,weight:"bold"}}}}}))}async function pe(){c(i,!0);try{console.log(`Solicitando datos a: ${E}`);const e=await fetch(E,{method:"GET",headers:{Accept:"application/json"}});if(!e.ok)throw new Error(`Error en la respuesta: ${e.status}`);I=await e.json(),console.log(`Datos recibidos: ${I.length} registros`),ge()}catch(e){console.error(`ERROR al obtener datos de ${E}: ${e}`),`${e.message}`}finally{c(i,!1)}}let $,K=2021,ue="Andalucía";function ge(){var t;const e=I.find(o=>Number(o.year)===Number(K)&&o.aacc.toLowerCase().includes(ue.toLowerCase()));if(!e)return;const a=(t=document.getElementById("12Chart"))==null?void 0:t.getContext("2d");a&&($&&($.destroy(),$=null),$=new Chart(a,{type:"radar",data:{labels:["Electricidad","Gas","Otros"],datasets:[{label:`${e.aacc} - ${K}`,data:[e.electricity??0,e.gas??0,e.other??0],backgroundColor:"rgba(54, 162, 235, 0.2)",borderColor:"#36A2EB",pointBackgroundColor:"#fff",pointBorderColor:"#36A2EB"}]},options:{responsive:!0,plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:"Distribución del Consumo Energético",color:"#fff",font:{size:20,weight:"bold",family:"Arial"}}},scales:{r:{pointLabels:{color:"#fff"},grid:{color:"rgba(255,255,255,0.2)"},angleLines:{color:"rgba(255,255,255,0.2)"},ticks:{color:"#fff",beginAtZero:!0}}}}}))}async function me(){c(i,!0);try{console.log(`Solicitando datos a: ${x}`);const e=await fetch(x,{method:"GET",headers:{Accept:"application/json"}});if(!e.ok)throw new Error(`Error en la respuesta: ${e.status}`);m=await e.json(),console.log(`Datos recibidos: ${m.length} parques`),he()}catch(e){console.error(`ERROR al obtener datos de ${x}: ${e}`),`${e.message}`}finally{c(i,!1)}}let k;function he(){var o;if(!m.length)return;const e=(o=document.getElementById("13Chart"))==null?void 0:o.getContext("2d");if(!e)return;k&&(k.destroy(),k=null);const a=m.map(r=>r.national_park),t=m.map(r=>r.current_area);k=new Chart(e,{type:"bar",data:{labels:a,datasets:[{label:"Superficie actual (ha)",data:t,backgroundColor:"#36A2EB"}]},options:{responsive:!0,plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:"Superficie Actual de los Parques Nacionales",color:"#fff",font:{size:20,weight:"bold",family:"Arial"}}},scales:{x:{ticks:{color:"#fff"},title:{display:!0,text:"Parque Nacional",color:"#fff"}},y:{ticks:{color:"#fff"},title:{display:!0,text:"Hectáreas",color:"#fff"}}}}})}let S=[];async function ve(){const e=["Sevilla","Madrid","Barcelona","Valencia","Bilbao"],a="55118ddd755b760e6675758a815cbb0d";S=[];for(const t of e)try{const o=await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${t}&units=metric&appid=${a}`),r=await o.json();o.ok?S.push({label:t,data:[{x:r.main.temp,y:r.main.humidity,r:Math.max(3,r.wind.speed*2)}],backgroundColor:ye(t)}):console.warn(`Error obteniendo datos para ${t}:`,r==null?void 0:r.message)}catch(o){console.error(`Error con ${t}:`,o)}be()}function ye(e){return{Sevilla:"#FF6384",Madrid:"#36A2EB",Barcelona:"#FFCE56",Valencia:"#4BC0C0",Bilbao:"#9966FF"}[e]||"#aaa"}let T;function be(){var a;const e=(a=document.getElementById("externalChart"))==null?void 0:a.getContext("2d");e&&(T&&T.destroy(),T=new Chart(e,{type:"bubble",data:{datasets:S},options:{responsive:!0,plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:"Condiciones climáticas en ciudades de España",color:"#fff",font:{size:18,weight:"bold"}}},scales:{x:{title:{display:!0,text:"Temperatura (°C)",color:"#fff"},ticks:{color:"#fff"}},y:{title:{display:!0,text:"Humedad (%)",color:"#fff"},ticks:{color:"#fff"}}}}}))}let N=[];async function Ce(){c(i,!0);try{const e=await fetch("/api/aemet");if(!e.ok)throw new Error("Error al obtener los datos del servidor proxy");N=await e.json(),console.log(N),we(N)}catch(e){console.error("Error cargando datos AEMET:",e)}finally{c(i,!1)}}let B;function we(e){var r,h,v,d,y,re;const a=(y=(d=(v=(h=(r=e==null?void 0:e[0])==null?void 0:r.prediccion)==null?void 0:h.dia)==null?void 0:v[0])==null?void 0:d.temperatura)==null?void 0:y.dato;if(!a||!Array.isArray(a)||a.length===0){console.warn("No hay datos de temperatura disponibles"),mensaje.textContent="No hay datos de temperatura disponibles.";return}const t=a.map(oe=>({x:Number(oe.hora),y:Number(oe.value)})),o=(re=document.getElementById("aemetChart"))==null?void 0:re.getContext("2d");o&&(B&&(B.destroy(),B=null),B=new Chart(o,{type:"scatter",data:{datasets:[{label:"Temperatura horaria (°C)",data:t,backgroundColor:"#36A2EB"}]},options:{responsive:!0,plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:"Temperatura Horaria en Sevilla",color:"#fff",font:{size:20,weight:"bold"}}},scales:{x:{title:{display:!0,text:"Hora",color:"#fff"},ticks:{color:"#fff"},type:"linear",position:"bottom"},y:{title:{display:!0,text:"Temperatura (°C)",color:"#fff"},ticks:{color:"#fff"}}}}}),mensaje.textContent="")}function Ee(e){return new Promise((a,t)=>{if(document.querySelector(`script[src="${e}"]`))return a();const r=document.createElement("script");r.src=e,r.onload=a,r.onerror=t,document.head.appendChild(r)})}Me(async()=>{try{await Ee("https://cdn.jsdelivr.net/npm/chart.js"),await ne(),await de(),await pe(),await me(),await ve(),await Ce()}catch(e){console.error(e)}}),Pe();var P=Ue();Ge(e=>{var a=Re();Te.title="Integrations - Francisco Javier",b(2),u(e,a)});var Z=n(P),M=s(n(Z),4),R=n(M),Q=s(n(R),4);z(Q,"href",C);var q=s(Q,2),xe=n(q);{var _e=e=>{var a=qe();u(e,a)};F(xe,e=>{j(i)&&e(_e)})}b(2),l(q),l(R);var O=s(R,2),X=s(n(O),4);z(X,"href",w);var L=s(X,2),Ae=n(L);{var $e=e=>{var a=Oe();u(e,a)};F(Ae,e=>{j(i)&&e($e)})}b(2),l(L),l(O);var H=s(O,2),ee=s(n(H),4);z(ee,"href",E);var U=s(ee,2),ke=n(U);{var Be=e=>{var a=Le();u(e,a)};F(ke,e=>{j(i)&&e(Be)})}b(2),l(U),l(H);var V=s(H,2),ae=s(n(V),4);z(ae,"href",x);var W=s(ae,2),je=n(W);{var Fe=e=>{var a=He();u(e,a)};F(je,e=>{j(i)&&e(Fe)})}b(2),l(W),l(V);var J=s(V,2),ze=s(n(J),6);l(J);var te=s(J,2),De=s(n(te),6);l(te),l(M),l(Z),l(P),f(3,q,()=>p),f(3,L,()=>p),f(3,U,()=>p),f(3,W,()=>p),f(3,ze,()=>p),f(3,De,()=>p),f(3,M,()=>p,()=>({duration:400})),u(se,P),Se()}export{ea as component};
