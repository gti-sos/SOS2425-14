import{t as O,h as ve,a as j}from"../chunks/BgiXASfF.js";import"../chunks/BIROYZXv.js";import{p as be,a as ye,$ as he,c as p,g as e,m as k,s,r as m,b as a,t as ee,d as l,n as ge}from"../chunks/CpQaROA0.js";import{e as D,s as I}from"../chunks/D1bc0aDY.js";import{i as B}from"../chunks/D1Iy4rpg.js";import{e as Ee,i as De}from"../chunks/DFFJoz1F.js";import{r as d}from"../chunks/DpvMPi6q.js";import{t as we,f as xe}from"../chunks/ByJhS31L.js";import{b as u,p as te}from"../chunks/B3q-S7L_.js";import{i as Ce}from"../chunks/CZQ4deT6.js";import{o as $e}from"../chunks/BXqaL1Zo.js";import{g as Te}from"../chunks/DZiRAjQP.js";var Ae=O('<p class="info-message"> </p>'),Re=O('<form class="create-form"><input placeholder="Comunidad Autónoma" required> <input type="number" placeholder="Año" required> <input placeholder="Delitos Informáticos" required> <input placeholder="Delitos contra la Ciberseguridad" required> <input placeholder="Detenidos / Investigados" required> <button type="submit" class="submit">Crear</button> <button type="button" class="cancel">Cancelar</button></form>'),ke=O('<form class="create-form"><input type="number" placeholder="Desde año"> <input type="number" placeholder="Hasta año"> <input type="number" placeholder="Año exacto"> <input type="text" placeholder="Comunidad autónoma"> <input type="text" placeholder="Delitos informáticos exacto"> <input type="number" placeholder="Delitos inf. desde"> <input type="number" placeholder="Delitos inf. hasta"> <input type="text" placeholder="Ciberseguridad exacto"> <input type="number" placeholder="Ciberseguridad desde"> <input type="number" placeholder="Ciberseguridad hasta"> <input type="text" placeholder="Detenidos exacto"> <input type="number" placeholder="Detenidos desde"> <input type="number" placeholder="Detenidos hasta"> <input type="number" placeholder="Limitar a..."> <input type="number" placeholder="Comenzar desde..."> <button class="btn" type="submit">Buscar</button></form>'),Ie=O('<tr><td> </td><td> </td><td> </td><td> </td><td> </td><td class="actions"><button class="btn-circle" title="Editar Registro"><i class="fas fa-pen"></i></button> <button class="btn-circle" title="Eliminar Registro"><i class="fas fa-times"></i></button></td></tr>'),qe=O('<div class="wrapper dash"><div class="container dash"><!> <div class="header"><h3>Datos de ciberdelincuencia</h3> <div class="actions"><button class="btn"><i class="fas fa-search"></i> Buscar</button> <button class="btn"><i class="fas fa-plus"></i> Nuevo registro</button> <button class="btn"><i class="fas fa-sync-alt"></i> Recargar</button> <button class="btn"><i class="fas fa-trash-alt"></i> Eliminar</button></div></div> <!> <!> <div class="seeker"></div> <div class="table-container"><table><thead><tr><th>Comunidad Autónoma</th><th>Año</th><th>Delitos Informáticos</th><th>Delitos Ciberseguridad</th><th>Detenidos / Investigados</th><th>Acciones</th></tr></thead></table> <div class="scroll-body"><table><tbody></tbody></table></div></div></div></div>');function Je(re,ae){be(ae,!1);let C="/api/v1/cybercrime-data",y=k([]),o=k(""),$=k(!1),q=k(!1),f=k({autonomous_community:"",year:"",criminal_ofense:"",cybersecurity:"",arrested_investigated:""}),r=k({from:"",to:"",year:"",autonomous_community:"",criminal_ofense:"",criminal_ofense_from:"",criminal_ofense_to:"",cybersecurity:"",cybersecurity_from:"",cybersecurity_to:"",arrested_investigated:"",arrested_investigated_from:"",arrested_investigated_to:"",limit:"",offset:""});async function T(){try{const i=await fetch(C);if(!i.ok){i.status===404?a(o,"No se encontraron datos de crimen cibernético."):i.status===500?a(o,"Error del servidor. Intenta más tarde."):a(o,"Error inesperado"),a(y,[]);return}a(y,await i.json())}catch(i){console.error("[GET] Error cargando datos:",i),a(o,"No se pudo conectar con el servidor."),a(y,[])}setTimeout(()=>a(o,""),2e3)}function ie(){a(q,!e(q)),a($,!1),e(q)||(a(r,{from:"",to:"",year:"",autonomous_community:"",criminal_ofense:"",criminal_ofense_from:"",criminal_ofense_to:"",cybersecurity:"",cybersecurity_from:"",cybersecurity_to:"",arrested_investigated:"",arrested_investigated_from:"",arrested_investigated_to:"",limit:"",offset:""}),a(o,""),T())}function oe(){a($,!e($)),a(q,!1)}async function se(){const i=new URLSearchParams;for(const[t,c]of Object.entries(e(r)))c!==""&&c!==null&&c!==void 0&&i.append(t,c);try{const t=await fetch(`${C}?${i.toString()}`);if(!t.ok){t.status===400?a(o,"Parámetros de búsqueda no válidos."):t.status===500?a(o,"Error interno del servidor al buscar."):a(o,"Error inesperado"),a(y,[]);return}a(y,await t.json()),e(y).length===0?a(o,"No se encontraron resultados para tu búsqueda."):a(o,`Se encontraron ${e(y).length} resultados.`)}catch(t){console.error("[SEARCH] Error al buscar:",t),a(o,"No se pudo conectar con el servidor."),a(y,[])}setTimeout(()=>a(o,""),2e3)}async function ne(){try{const i=await fetch(C,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e(f))}),t=await i.json();i.status===201?(a(o,"Registro creado correctamente"),a($,!1),ce(),await T()):i.status===400?a(o,`Datos inválidos: ${t.error||"Revisa los campos."}`):i.status===409?a(o,"Ya existe un registro con esos identificadores."):a(o,`Error inesperado (${i.status}) al procesar la petición.`)}catch(i){console.error("[CREATE] Error:",i),a(o,"No se pudo conectar con el servidor.")}setTimeout(()=>a(o,""),2e3)}function ce(){a(f,{autonomous_community:"",year:"",criminal_ofense:"",cybersecurity:"",arrested_investigated:""})}async function le(){const i=`${C}/loadInitialData`;try{const t=await fetch(i);if(!t.ok)throw new Error(`Error ${t.status}`);a(o,"Datos iniciales cargados."),await T()}catch(t){console.error("[LOAD INITIAL DATA] Error:",t),a(o,"Error al cargar los datos iniciales.")}setTimeout(()=>{a(o,"")},2e3)}async function de(){if(confirm("¿Estás seguro de que quieres eliminar todos los registros de crimen cibernético?")){try{const t=await fetch(C,{method:"DELETE"});t.status===200?(a(o,"Todos los registros de crimen cibernético han sido eliminados."),await T()):t.status===404?a(o,"No hay registros de crimen cibernético que eliminar."):a(o,"Error al eliminar los registros de crimen cibernético.")}catch(t){console.error("[DELETE] Error eliminando registros de crimen cibernético:",t),a(o,"Error al eliminar los registros de crimen cibernético.")}setTimeout(()=>{a(o,"")},2e3)}}async function ue(i,t){try{const c=await fetch(`${C}/${i}/${t}`,{method:"DELETE"});c.status===200?(a(o,`Registro de crimen cibernético en ${i} (${t}) eliminado correctamente.`),await T()):c.status===404?a(o,"Registro de crimen cibernético no encontrado."):a(o,"Error al eliminar el registro de crimen cibernético.")}catch(c){console.error("[DELETE] Error eliminando el registro de crimen cibernético:",c),a(o,"Error al eliminar el registro de crimen cibernético.")}setTimeout(()=>{a(o,"")},2e3)}$e(async()=>{await T()}),Ce();var P=qe();ve(i=>{he.title="Datos de Ciberdelincuencia"});var H=p(P),U=p(H);{var me=i=>{var t=Ae(),c=p(t,!0);m(t),ee(()=>I(c,e(o))),we(3,t,()=>xe,()=>({duration:300})),j(i,t)};B(U,i=>{e(o)&&i(me)})}var F=s(U,2),z=s(p(F),2),G=p(z),J=s(G,2),M=s(J,2),fe=s(M,2);m(z),m(F);var Y=s(F,2);{var pe=i=>{var t=Re(),c=p(t);d(c);var v=s(c,2);d(v);var h=s(v,2);d(h);var b=s(h,2);d(b);var g=s(b,2);d(g);var E=s(g,4);m(t),u(c,()=>e(f).autonomous_community,_=>l(f,e(f).autonomous_community=_)),u(v,()=>e(f).year,_=>l(f,e(f).year=_)),u(h,()=>e(f).criminal_ofense,_=>l(f,e(f).criminal_ofense=_)),u(b,()=>e(f).cybersecurity,_=>l(f,e(f).cybersecurity=_)),u(g,()=>e(f).arrested_investigated,_=>l(f,e(f).arrested_investigated=_)),D("click",E,()=>a($,!1)),D("submit",t,te(ne)),j(i,t)};B(Y,i=>{e($)&&i(pe)})}var K=s(Y,2);{var _e=i=>{var t=ke(),c=p(t);d(c);var v=s(c,2);d(v);var h=s(v,2);d(h);var b=s(h,2);d(b);var g=s(b,2);d(g);var E=s(g,2);d(E);var _=s(E,2);d(_);var w=s(_,2);d(w);var N=s(w,2);d(N);var x=s(N,2);d(x);var L=s(x,2);d(L);var A=s(L,2);d(A);var R=s(A,2);d(R);var S=s(R,2);d(S);var Z=s(S,2);d(Z),ge(2),m(t),u(c,()=>e(r).from,n=>l(r,e(r).from=n)),u(v,()=>e(r).to,n=>l(r,e(r).to=n)),u(h,()=>e(r).year,n=>l(r,e(r).year=n)),u(b,()=>e(r).autonomous_community,n=>l(r,e(r).autonomous_community=n)),u(g,()=>e(r).criminal_ofense,n=>l(r,e(r).criminal_ofense=n)),u(E,()=>e(r).criminal_ofense_from,n=>l(r,e(r).criminal_ofense_from=n)),u(_,()=>e(r).criminal_ofense_to,n=>l(r,e(r).criminal_ofense_to=n)),u(w,()=>e(r).cybersecurity,n=>l(r,e(r).cybersecurity=n)),u(N,()=>e(r).cybersecurity_from,n=>l(r,e(r).cybersecurity_from=n)),u(x,()=>e(r).cybersecurity_to,n=>l(r,e(r).cybersecurity_to=n)),u(L,()=>e(r).arrested_investigated,n=>l(r,e(r).arrested_investigated=n)),u(A,()=>e(r).arrested_investigated_from,n=>l(r,e(r).arrested_investigated_from=n)),u(R,()=>e(r).arrested_investigated_to,n=>l(r,e(r).arrested_investigated_to=n)),u(S,()=>e(r).limit,n=>l(r,e(r).limit=n)),u(Z,()=>e(r).offset,n=>l(r,e(r).offset=n)),D("submit",t,te(se)),j(i,t)};B(K,i=>{e(q)&&i(_e)})}var Q=s(K,4),V=s(p(Q),2),W=p(V),X=p(W);Ee(X,5,()=>e(y),De,(i,t)=>{var c=Ie(),v=p(c),h=p(v,!0);m(v);var b=s(v),g=p(b,!0);m(b);var E=s(b),_=p(E,!0);m(E);var w=s(E),N=p(w,!0);m(w);var x=s(w),L=p(x,!0);m(x);var A=s(x),R=p(A),S=s(R,2);m(A),m(c),ee(()=>{I(h,e(t).autonomous_community),I(g,e(t).year),I(_,e(t).criminal_ofense),I(N,e(t).cybersecurity),I(L,e(t).arrested_investigated)}),D("click",R,()=>Te(`/cybercrime/edit/${encodeURIComponent(e(t).autonomous_community)}/${e(t).year}`)),D("click",S,()=>ue(e(t).autonomous_community,e(t).year)),j(i,c)}),m(X),m(W),m(V),m(Q),m(H),m(P),D("click",G,ie),D("click",J,oe),D("click",M,le),D("click",fe,de),j(re,P),ye()}export{Je as component};
