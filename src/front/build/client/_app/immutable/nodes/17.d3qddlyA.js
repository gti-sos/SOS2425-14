import{t as v,h as X,a as h}from"../chunks/Cw--0ebe.js";import"../chunks/C5mLL2l5.js";import{p as Z,t as ee,a as te,$ as ae,s as n,c as l,n as G,g as s,m as F,r as f,b as W}from"../chunks/LDrxhfq1.js";import{i as M}from"../chunks/BG8tU1X3.js";import{s as u}from"../chunks/crEyKr2S.js";import{t as I,f as D}from"../chunks/IMrtpuJV.js";import{i as oe}from"../chunks/BwztKqQM.js";import{o as re}from"../chunks/C73a-Tmm.js";var ie=v('<meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0">',1),ne=v('<p style="color: #fff; text-align: center; font-weight: bold;">Cargando datos...</p>'),se=v('<p style="color: #fff; text-align: center; font-weight: bold;">Cargando datos...</p>'),ce=v(`<div class="wrapper"><div class="container"><h2 style="text-align: center;">Integraciones <br><i>Pablo</i></h2> <hr style="width: 55em; animation: loadHrGraph 1s; transition: all 0.3s ease;"> <div><div class="article" style="margin-top: 0;"><h3 style="font-size: 1.5em; text-transform: none;">Relación entre Precipitación y Cibercriminalidad (2021)</h3> <p>Este gráfico de columnas relaciona la precipitación anual con la tasa de delitos de cibercrimen en
                    provincias seleccionadas de Andalucía.</p> <a style="color: #fff;" target="_blank"><i>G15 - precipitation-stats</i></a> <a style="color: #fff; margin-left:1em;" target="_blank"><i>G14-cybercrime-data</i></a> <figure class="chartjs-figure svelte-wpvc02"><!> <div id="g15CrimeChart"></div></figure></div> <div class="article" style="margin-top: 3em;"><h3 style="font-size: 1.5em; text-transform: none;">Relación entre Infracciones y Cibercriminalidad por Comunidad (2023)</h3> <p>Este gráfico de barras muestra la relación entre las infracciones (ITV) y los delitos de cibercriminalidad por comunidades en el año 2023.</p> <a style="color: #fff;" target="_blank"><i>G20 - fines-data</i></a> <a style="color: #fff; margin-left:1em;" target="_blank"><i>G14-cybercrime-data</i></a> <figure class="chartjs-figure svelte-wpvc02"><!> <div id="combinedChart"></div></figure></div></div></div></div>`);function he(z,H){Z(H,!1);const P="https://sos2425-15.onrender.com/api/v1/precipitation-stats/",C="https://sos2425-20.onrender.com/api/v1/fines/";let d=F("/api/v1/cybercrime-data"),b=F(!0);async function T(){W(b,!0);try{console.log(`Solicitando datos a: ${P}`);const e=await fetch("/api/g15precipitation");if(!e.ok)throw new Error("Error al obtener datos de G15");const t=await e.json();console.log(`Solicitando datos a: ${s(d)}`);const c=await fetch(s(d));if(!c.ok)throw new Error("Error al obtener datos de cybercrime-data");const g=await c.json(),a=2020,p=["almería","granada","jaén"].map(o=>{const r=t.find(y=>y.province.toLowerCase()===o&&y.year===a),m=o==="almería"||o==="granada"||o==="jaén"?"Andalucia":null,i=g.find(y=>y.autonomous_community.toLowerCase()===(m==null?void 0:m.toLowerCase())&&y.year===a),Q=i?i.cybersecurity/1e4:0;return{province:o,x:(r==null?void 0:r.annual_precipitation)??0,y:(r==null?void 0:r.deviation)??0,r:Q}});console.log(`Datos combinados: ${p.length} registros`),B(p)}catch(e){console.error("Error combinando datos G15 + Criminalidad:",e)}finally{W(b,!1)}}function B(e){Highcharts.chart("g15CrimeChart",{chart:{type:"column",backgroundColor:"#052a42"},title:{text:"Relación entre Precipitación y Cibercriminalidad (2020)",style:{color:"#fff",fontWeight:"bold"}},xAxis:{categories:e.map(t=>t.province),title:{text:"Provincias",style:{color:"#fff"}},labels:{style:{color:"#fff"}}},yAxis:{min:0,title:{text:"Precipitación Anual (mm)",style:{color:"#fff"}},labels:{style:{color:"#fff"}}},tooltip:{pointFormat:"Precipitación: {point.y} mm, Tasa de Cibercriminalidad: {point.r}",style:{color:"#fff"}},series:[{name:"Provincias",data:e.map(t=>({name:t.province,y:t.x,r:t.r})),color:"#36a2eb",dataLabels:{enabled:!0,format:"{point.y} mm",style:{color:"#fff",fontWeight:"bold"}}}],legend:{itemStyle:{color:"#fff"}}})}async function Y(){try{console.log(`Solicitando datos a: ${C}`);const e=await fetch(C);if(!e.ok)throw new Error("Error al obtener datos de API_G20");const t=await e.json();console.log(`Solicitando datos a: ${s(d)}`);const c=await fetch(s(d));if(!c.ok)throw new Error("Error al obtener datos de API_CYBERCRIME");const g=await c.json(),a=2023,p=["Madrid","Andalucia"].map(o=>{const r=t.find(i=>i.city.toLowerCase().includes(o.toLowerCase())&&i.year===a),m=g.find(i=>i.autonomous_community.toLowerCase().includes(o.toLowerCase())&&i.year===a);return{comunidad:o,fines:r?r.itv:0,cybercrime:m?m.criminal_ofense:0}});console.log(`Datos combinados: ${p.length} registros`),q(p)}catch(e){console.error("Error al combinar datos de fines y cybercrime:",e)}finally{}}function q(e){Highcharts.chart("combinedChart",{chart:{type:"bar",backgroundColor:"#052a42"},title:{text:"Infracciones vs Delitos Cibernéticos por Comunidad (2023)",style:{color:"#fff",fontWeight:"bold"}},xAxis:{categories:e.map(t=>t.comunidad),title:{text:"Comunidades",style:{color:"#fff"}},labels:{style:{color:"#fff"}}},yAxis:[{min:0,title:{text:"Infracciones (Fines)",style:{color:"#fff"}},labels:{style:{color:"#fff"}}},{min:0,title:{text:"Delitos Cibernéticos (Cybercrime)",style:{color:"#fff"}},labels:{style:{color:"#fff"}},opposite:!0}],tooltip:{pointFormat:"Infracciones: {point.y} mm, Delitos Cibernéticos: {point.r}",style:{color:"#fff"}},series:[{name:"Infracciones",data:e.map(t=>t.fines),color:"#36a2eb",dataLabels:{enabled:!0,format:"{point.y} ",style:{color:"#fff",fontWeight:"bold"}}},{name:"Delitos Cibernéticos",data:e.map(t=>t.cybercrime),color:"#ff6384",dataLabels:{enabled:!0,format:"{point.y} ",style:{color:"#fff",fontWeight:"bold"}}}],legend:{itemStyle:{color:"#fff"}}})}function U(e){return new Promise((t,c)=>{if(document.querySelector(`script[src="${e}"]`))return t();const a=document.createElement("script");a.src=e,a.onload=t,a.onerror=c,document.head.appendChild(a)})}re(async()=>{try{await U("https://code.highcharts.com/highcharts.js"),await T(),await Y()}catch(e){console.error(e)}}),oe();var w=ce();X(e=>{var t=ie();ae.title="Integrations - Pablo Dominguez",G(2),h(e,t)});var k=l(w),_=n(l(k),4),x=l(_),L=n(l(x),4);u(L,"href",P);var R=n(L,2),E=n(R,2),V=l(E);{var J=e=>{var t=ne();h(e,t)};M(V,e=>{s(b)&&e(J)})}G(2),f(E),f(x);var S=n(x,2),j=n(l(S),4);u(j,"href",C);var $=n(j,2),A=n($,2),K=l(A);{var N=e=>{var t=se();h(e,t)};M(K,e=>{s(b)&&e(N)})}G(2),f(A),f(S),f(_),f(k),f(w),ee(()=>{u(R,"href",s(d)),u($,"href",s(d))}),I(3,E,()=>D),I(3,A,()=>D),I(3,_,()=>D,()=>({duration:400})),h(z,w),te()}export{he as component};
