import{t as h,h as Me,a as m}from"../chunks/BgiXASfF.js";import"../chunks/BIROYZXv.js";import{p as Re,a as Le,$ as Oe,s as r,c as i,n as b,g as S,m as qe,r as l,b as c}from"../chunks/CpQaROA0.js";import{i as D}from"../chunks/D1Iy4rpg.js";import{s as I}from"../chunks/DpvMPi6q.js";import{t as u,f as g}from"../chunks/ByJhS31L.js";import{i as He}from"../chunks/CZQ4deT6.js";import{o as Ue}from"../chunks/BXqaL1Zo.js";var We=h('<meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0">',1),Ve=h('<p style="color: #fff; text-align: center; font-weight: bold;">Cargando datos...</p>'),Je=h('<p style="color: #fff; text-align: center; font-weight: bold;">Cargando datos...</p>'),Ye=h('<p style="color: #fff; text-align: center; font-weight: bold;">Cargando datos...</p>'),Ze=h('<p style="color: #fff; text-align: center; font-weight: bold;">Cargando datos...</p>'),Ke=h(`<div class="wrapper"><div class="container"><h2 style="text-align: center;">Integraciones <br><i>Francisco Javier</i></h2> <hr style="width: 100%; animation: loadHrGraph 1s; transition: all 0.3s ease;"> <div><div class="article" style="margin-top: 0;"><h3 style="font-size: 1.5em; text-transform: none;">Distribución del Uso del Suelo en Cádiz</h3> <p>Este gráfico representa cómo se reparte la superficie de la provincia de Cádiz entre
					distintos usos del suelo: superficie cultivada, pastos, terreno forestal y superficie no
					agraria. La visualización permite observar de forma clara qué tipo de aprovechamiento
					predomina en el territorio durante el año seleccionado.</p> <a style="color: #fff;" target="_blank"><i>G15 - ocupied-grand-stats</i></a> <figure class="chartjs-figure svelte-47s6as"><!> <canvas id="15Chart"></canvas></figure></div> <div class="article" style="margin-top: 1em;"><h3 style="font-size: 1.5em; text-transform: none;">Accidentes con Animales por Grupo (2023)</h3> <p>Este gráfico muestra cuántos accidentes de tráfico con animales estuvieron relacionados
					con cada grupo animal durante el año 2023. Permite identificar qué tipos de fauna están
					más implicados en este tipo de incidentes según los registros recopilados a nivel
					nacional.</p> <a style="color: #fff;" target="_blank"><i>G20 - accidents-with-animals</i></a> <figure class="chartjs-figure svelte-47s6as"><!> <canvas id="20Chart"></canvas></figure></div> <div class="article" style="margin-top: 0;"><h3 style="font-size: 1.5em; text-transform: none;">Distribución del Consumo Energético por Fuente</h3> <p>Este gráfico radar muestra cómo se reparte el consumo energético entre electricidad, gas y
					otras fuentes en Andalucía durante el año 2021. Esta visualización permite comparar
					fácilmente las prioridades energéticas regionales y su evolución temporal.</p> <a style="color: #fff;" target="_blank"><i>G12 - annual-consumptions</i></a> <figure class="chartjs-figure svelte-47s6as"><!> <canvas id="12Chart"></canvas></figure></div> <div class="article" style="margin-top: 0;"><h3 style="font-size: 1.5em; text-transform: none;">Superficie Actual de los Parques Nacionales</h3> <p>Este gráfico muestra la superficie actual en hectáreas de los distintos parques nacionales
					de España. Permite comparar el tamaño de cada parque natural y analizar cómo varía su
					extensión a lo largo del territorio nacional.</p> <a style="color: #fff;" target="_blank"><i>G13 - national-parks</i></a> <figure class="chartjs-figure svelte-47s6as"><!> <canvas id="13Chart"></canvas></figure></div> <div class="article" style="margin-top: 2em;"><h3>Comparativa Climática de Varias Ciudades</h3> <p>Este gráfico de burbujas permite comparar en tiempo real la temperatura, humedad y
					velocidad del viento en cinco ciudades españolas: Sevilla, Madrid, Barcelona, Valencia y
					Bilbao.</p> <a style="color: #fff;" href="https://openweathermap.org/current" target="_blank"><i>API externa - OpenWeatherMap</i></a> <figure class="chartjs-figure svelte-47s6as"><canvas id="externalChart"></canvas></figure></div> <div class="article" style="margin-top: 0;"><h3 style="font-size: 1.5em; text-transform: none;">Temperatura Horaria en Sevilla (AEMET)</h3> <p>Este gráfico de dispersión representa las temperaturas registradas en distintas horas del
					día en Sevilla, según los datos proporcionados por la Agencia Estatal de Meteorología.
					Permite visualizar cómo varía la temperatura a lo largo de la jornada.</p> <a style="color: #fff;" href="https://www.aemet.es/es/eltiempo/prediccion/municipios/sevilla-id41091" target="_blank"><i>AEMET - Predicción Sevilla</i></a> <figure class="chartjs-figure svelte-47s6as"><p id="mensaje" style="color: #fff; text-align: center; font-weight: bold;"></p> <canvas id="aemetChart"></canvas></figure></div> <div class="article" style="margin-top: 0;"><h3 style="font-size: 1.5em; text-transform: none;">Comparativa de Descripciones en Publicaciones APOD (NASA)</h3> <p>Este gráfico muestra la longitud de las descripciones en los resultados de imágenes y
					vídeos de la NASA (Astronomy Picture of the Day), permitiendo una visión del nivel de
					detalle en cada contenido.</p> <a style="color: #fff;" href="https://images-api.nasa.gov" target="_blank"><i>NASA Images API</i></a> <figure class="chartjs-figure svelte-47s6as"><p id="mensaje-nasa" style="color: white; text-align: center; margin-top: 1em;"></p> <canvas id="nasaChart"></canvas></figure></div></div></div></div>`);function na(le,ce){Re(ce,!1);const C="https://sos2425-15.onrender.com/api/v1/ocupied-grand-stats/",w="https://sos2425-20.onrender.com/api/v1/accidents-with-animals",E="https://sos2425-12.onrender.com/api/v1/annual-consumptions",x="https://sos2425-13.onrender.com/api/v2/national-parks";let N=[],z=[],F=[],v=[],n=qe(!0);async function de(){c(n,!0);try{console.log(`Solicitando datos a: ${C}`);const e=await fetch(C,{method:"GET",headers:{Accept:"application/json"}});if(!e.ok)throw new Error(`Error en la respuesta: ${e.status}`);N=await e.json(),console.log(`Datos recibidos: ${N.length} registros`),pe()}catch(e){console.error(`ERROR al obtener datos de ${C}: ${e}`),`${e.message}`}finally{c(n,!1)}}let A,Z=2021,fe="cadiz";function pe(){var t;const e=N.find(o=>Number(o.year)===Number(Z)&&o.province.toLowerCase()===fe.toLowerCase());if(!e)return;const a=(t=document.getElementById("15Chart"))==null?void 0:t.getContext("2d");a&&(A&&(A.destroy(),A=null),A=new Chart(a,{type:"doughnut",data:{labels:["Ground","Grass","Wooded","Non Agrarian Surface"],datasets:[{label:`${e.province.toUpperCase()} - ${Z}`,data:[e.ground??0,e.grass??0,e.wooded??0,e.non_agrarian_surface??0],backgroundColor:["#36A2EB","#FFCE56","#FF6384","#4BC0C0"]}]},options:{responsive:!0,plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:"Distribución del Uso del Suelo en Cádiz",color:"#fff",font:{size:20,weight:"bold",family:"Arial"}}}}}))}async function ue(){c(n,!0);try{console.log(`Solicitando datos a: ${w}`);const e=await fetch(w,{method:"GET",headers:{Accept:"application/json"}});if(!e.ok)throw new Error(`Error en la respuesta: ${e.status}`);z=await e.json(),console.log(`Datos recibidos: ${z.length} registros`),ge()}catch(e){console.error(`ERROR al obtener datos de ${w}: ${e}`),`${e.message}`}finally{c(n,!1)}}let _;function ge(){var d;const a=z.filter(p=>Number(p.anyo)===2023),t={};for(const p of a){const y=p.animal_group;t[y]=(t[y]||0)+1}const o=Object.keys(t).map(p=>`Grupo ${p}`),s=Object.values(t),f=(d=document.getElementById("20Chart"))==null?void 0:d.getContext("2d");f&&(_&&(_.destroy(),_=null),_=new Chart(f,{type:"polarArea",data:{labels:o,datasets:[{label:"Número de accidentes por grupo animal",data:s,backgroundColor:["#36A2EB","#FFCE56","#FF6384","#4BC0C0","#9966FF","#00D98B"]}]},options:{responsive:!0,plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:"Accidentes con Animales por Grupo (2023)",color:"#fff",font:{size:20,weight:"bold"}}}}}))}async function me(){c(n,!0);try{console.log(`Solicitando datos a: ${E}`);const e=await fetch(E,{method:"GET",headers:{Accept:"application/json"}});if(!e.ok)throw new Error(`Error en la respuesta: ${e.status}`);F=await e.json(),console.log(`Datos recibidos: ${F.length} registros`),ve()}catch(e){console.error(`ERROR al obtener datos de ${E}: ${e}`),`${e.message}`}finally{c(n,!1)}}let k,K=2021,he="Andalucía";function ve(){var t;const e=F.find(o=>Number(o.year)===Number(K)&&o.aacc.toLowerCase().includes(he.toLowerCase()));if(!e)return;const a=(t=document.getElementById("12Chart"))==null?void 0:t.getContext("2d");a&&(k&&(k.destroy(),k=null),k=new Chart(a,{type:"radar",data:{labels:["Electricidad","Gas","Otros"],datasets:[{label:`${e.aacc} - ${K}`,data:[e.electricity??0,e.gas??0,e.other??0],backgroundColor:"rgba(54, 162, 235, 0.2)",borderColor:"#36A2EB",pointBackgroundColor:"#fff",pointBorderColor:"#36A2EB"}]},options:{responsive:!0,plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:"Distribución del Consumo Energético",color:"#fff",font:{size:20,weight:"bold",family:"Arial"}}},scales:{r:{pointLabels:{color:"#fff"},grid:{color:"rgba(255,255,255,0.2)"},angleLines:{color:"rgba(255,255,255,0.2)"},ticks:{color:"#fff",beginAtZero:!0}}}}}))}async function ye(){c(n,!0);try{console.log(`Solicitando datos a: ${x}`);const e=await fetch(x,{method:"GET",headers:{Accept:"application/json"}});if(!e.ok)throw new Error(`Error en la respuesta: ${e.status}`);v=await e.json(),console.log(`Datos recibidos: ${v.length} parques`),be()}catch(e){console.error(`ERROR al obtener datos de ${x}: ${e}`),`${e.message}`}finally{c(n,!1)}}let $;function be(){var o;if(!v.length)return;const e=(o=document.getElementById("13Chart"))==null?void 0:o.getContext("2d");if(!e)return;$&&($.destroy(),$=null);const a=v.map(s=>s.national_park),t=v.map(s=>s.current_area);$=new Chart(e,{type:"bar",data:{labels:a,datasets:[{label:"Superficie actual (ha)",data:t,backgroundColor:"#36A2EB"}]},options:{responsive:!0,plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:"Superficie Actual de los Parques Nacionales",color:"#fff",font:{size:20,weight:"bold",family:"Arial"}}},scales:{x:{ticks:{color:"#fff"},title:{display:!0,text:"Parque Nacional",color:"#fff"}},y:{ticks:{color:"#fff"},title:{display:!0,text:"Hectáreas",color:"#fff"}}}}})}let G=[];async function Ce(){G=[];try{const e=await fetch("/api/openweather");if(!e.ok)throw new Error("Error al obtener datos del servidor proxy");const a=await e.json();for(const t of a)G.push({label:t.name,data:[{x:t.main.temp,y:t.main.humidity,r:Math.max(3,t.wind.speed*2)}],backgroundColor:we(t.name)});Ee()}catch(e){console.error("Error al obtener datos del clima:",e)}}function we(e){return{Sevilla:"#FF6384",Madrid:"#36A2EB",Barcelona:"#FFCE56",Valencia:"#4BC0C0",Bilbao:"#9966FF"}[e]||"#aaa"}let P;function Ee(){var a;const e=(a=document.getElementById("externalChart"))==null?void 0:a.getContext("2d");e&&(P&&P.destroy(),P=new Chart(e,{type:"bubble",data:{datasets:G},options:{responsive:!0,plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:"Condiciones climáticas en ciudades de España",color:"#fff",font:{size:18,weight:"bold"}}},scales:{x:{title:{display:!0,text:"Temperatura (°C)",color:"#fff"},ticks:{color:"#fff"}},y:{title:{display:!0,text:"Humedad (%)",color:"#fff"},ticks:{color:"#fff"}}}}}))}let Q=[];async function xe(){c(n,!0);try{const e=await fetch("/api/aemet");if(!e.ok)throw new Error("Error al obtener los datos del servidor proxy");Q=await e.json(),Ae(Q)}catch(e){console.error("Error cargando datos AEMET:",e)}finally{c(n,!1)}}let j;function Ae(e){var s,f,d,p,y,ne;const a=(y=(p=(d=(f=(s=e==null?void 0:e[0])==null?void 0:s.prediccion)==null?void 0:f.dia)==null?void 0:d[0])==null?void 0:p.temperatura)==null?void 0:y.dato;if(!a||!Array.isArray(a)||a.length===0){console.warn("No hay datos de temperatura disponibles"),mensaje.textContent="No hay datos de temperatura disponibles.";return}const t=a.map(ie=>({x:Number(ie.hora),y:Number(ie.value)})),o=(ne=document.getElementById("aemetChart"))==null?void 0:ne.getContext("2d");o&&(j&&(j.destroy(),j=null),j=new Chart(o,{type:"scatter",data:{datasets:[{label:"Temperatura horaria (°C)",data:t,backgroundColor:"#36A2EB"}]},options:{responsive:!0,plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:"Temperatura Horaria en Sevilla",color:"#fff",font:{size:20,weight:"bold"}}},scales:{x:{title:{display:!0,text:"Hora",color:"#fff"},ticks:{color:"#fff"},type:"linear",position:"bottom"},y:{title:{display:!0,text:"Temperatura (°C)",color:"#fff"},ticks:{color:"#fff"}}}}}),mensaje.textContent="")}let X=[];async function _e(){const e=document.getElementById("mensaje-nasa");e&&(e.textContent="Cargando datos...");try{X=await(await fetch("/api/nasa")).json(),ke(X),e&&(e.textContent="")}catch(a){console.error("Error al obtener datos de NASA:",a),e&&(e.textContent="Error al obtener datos de NASA.")}}let B;function ke(e){var f;const a=e.slice(0,5),t=a.map(d=>d.title),o=a.map(d=>d.explanation.length),s=(f=document.getElementById("nasaChart"))==null?void 0:f.getContext("2d");s&&(B&&(B.destroy(),B=null),B=new Chart(s,{type:"bar",data:{labels:t,datasets:[{label:"Longitud de la explicación",data:o,backgroundColor:"#36A2EB"}]},options:{indexAxis:"y",responsive:!0,plugins:{legend:{labels:{color:"#fff"}},title:{display:!0,text:"Longitud de las descripciones en APOD (NASA)",color:"#fff",font:{size:20,weight:"bold"}}},scales:{x:{ticks:{color:"#fff"},title:{display:!0,text:"Número de caracteres",color:"#fff"}},y:{ticks:{color:"#fff"}}}}}))}function $e(e){return new Promise((a,t)=>{if(document.querySelector(`script[src="${e}"]`))return a();const s=document.createElement("script");s.src=e,s.onload=a,s.onerror=t,document.head.appendChild(s)})}Ue(async()=>{try{await $e("https://cdn.jsdelivr.net/npm/chart.js"),await de(),await ue(),await me(),await ye(),await Ce(),await xe(),await _e()}catch(e){console.error(e)}}),He();var T=Ke();Me(e=>{var a=We();Oe.title="Integrations - Francisco Javier",b(2),m(e,a)});var ee=i(T),M=r(i(ee),4),R=i(M),ae=r(i(R),4);I(ae,"href",C);var L=r(ae,2),je=i(L);{var Be=e=>{var a=Ve();m(e,a)};D(je,e=>{S(n)&&e(Be)})}b(2),l(L),l(R);var O=r(R,2),te=r(i(O),4);I(te,"href",w);var q=r(te,2),Se=i(q);{var De=e=>{var a=Je();m(e,a)};D(Se,e=>{S(n)&&e(De)})}b(2),l(q),l(O);var H=r(O,2),re=r(i(H),4);I(re,"href",E);var U=r(re,2),Ie=i(U);{var Ne=e=>{var a=Ye();m(e,a)};D(Ie,e=>{S(n)&&e(Ne)})}b(2),l(U),l(H);var W=r(H,2),oe=r(i(W),4);I(oe,"href",x);var V=r(oe,2),ze=i(V);{var Fe=e=>{var a=Ze();m(e,a)};D(ze,e=>{S(n)&&e(Fe)})}b(2),l(V),l(W);var J=r(W,2),Ge=r(i(J),6);l(J);var Y=r(J,2),Pe=r(i(Y),6);l(Y);var se=r(Y,2),Te=r(i(se),6);l(se),l(M),l(ee),l(T),u(3,L,()=>g),u(3,q,()=>g),u(3,U,()=>g),u(3,V,()=>g),u(3,Ge,()=>g),u(3,Pe,()=>g),u(3,Te,()=>g),u(3,M,()=>g,()=>({duration:400})),m(le,T),Le()}export{na as component};
