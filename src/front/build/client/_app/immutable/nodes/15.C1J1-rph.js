import{t as f,h as Oa,a as h}from"../chunks/CcBKTLYU.js";import"../chunks/BQvSbhnN.js";import{p as za,t as j,a as La,$ as Ma,s as n,c as d,b as l,m as F,n as qa,g as p,r as u,aw as Fa}from"../chunks/B9KnJm2w.js";import{s as G}from"../chunks/b-klYKnl.js";import{i as g}from"../chunks/DRx51zI4.js";import{s as b}from"../chunks/D_AC4_dt.js";import{t as Wa,f as Ha}from"../chunks/PRg3Qw8M.js";import{i as Ja}from"../chunks/B7KipWS9.js";import{o as Ua}from"../chunks/BKuOihLL.js";var Ba=f('<meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <link href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.7.20/c3.min.css" rel="stylesheet">',1),Va=f("<p>Cargando datos...</p>"),Ya=f('<p style="color: red"> </p>'),Ka=f("<p>Cargando datos...</p>"),Qa=f('<p style="color: red"> </p>'),Xa=f("<p>Cargando datos...</p>"),Za=f('<p style="color: red"> </p>'),at=f("<p>Cargando datos...</p>"),tt=f('<p style="color: red"> </p>'),et=f("<p>Cargando datos...</p>"),ot=f('<p style="color: red"> </p>'),rt=f('<div class="wrapper"><div class="container"><h2 style="text-align: center;">Integraciones <br><i>Jaime Duffy Panés</i></h2> <hr style="width: 100%; animation: loadHrGraph 1s; transition: all 0.3s ease;"> <div><div class="article"><h3 style="font-size: 1.5em; text-transform: none;">Widget: Distribución de ayudas DANA por municipios</h3> <p>Este gráfico representa cómo se reparte la ayuda por la dana para cada municipio.</p> <a style="color: #fff;" target="_blank"><i>G18-dana-grants-subsidies-stats</i></a> <div class="chart-container svelte-sihtrb"><figure class="highcharts-figure"><div id="container"></div> <!> <!></figure></div></div> <div class="article"><h3 style="font-size: 1.5em; text-transform: none;">Integración: Número de multas por tasa de paro</h3> <p>Este gráfico nos muestra el número de multas de las comunidades autónomas junto con la tasa de paro.</p> <a style="color: #fff; margin-right: 1rem;" target="_blank"><i>G10-radars-stats</i></a> <a style="color: #fff;" target="_blank"><i>API: Datos de Empleo</i></a> <div class="chart-container svelte-sihtrb"><div id="chart10" style="max-width: 800px; margin: auto;"></div> <!> <!></div></div> <div class="article"><h3 style="font-size: 1.5em; text-transform: none;">Integración: Número de proyectos y tasa de actividad</h3> <p>Este gráfico mustra el numero de proyectos y la tasa de actividad en andalucía según los años.</p> <a style="color: #fff; margin-right: 1rem;" target="_blank"><i>G13-water-supply-improvements</i></a> <a style="color: #fff;" target="_blank"><i>API: Datos de Empleo</i></a> <div class="chart-container svelte-sihtrb"><div id="andaluciaChart" style="max-width: 700px; margin: auto;"></div> <!> <!></div></div> <div class="article"><h3 style="font-size: 1.5em; text-transform: none;">Widget: Distribución de Estudiantes por Grado Universitario</h3> <p>Este gráfico en formato donut muestra la proporción de estudiantes matriculados en los distintos grados universitarios, destacando los seis con mayor volumen. Los grados restantes se agrupan en la categoría “Otras” para facilitar la visualización comparativa.</p> <a style="color: #fff; margin-right: 1rem;" target="_blank"><i>G17-university-academic-performance</i></a> <div class="chart-container svelte-sihtrb"><div id="chart17" style="max-width: 600px; margin: auto;"></div> <!> <!></div></div> <div class="article"><h3 style="font-size: 1.5em; text-transform: none;">Widget: Comparativa de Solicitudes de Autonomía y Dependencia por Comunidad Autónoma</h3> <p>Este gráfico de barras muestra la comparación entre el número de solicitudes de autonomía y de dependencia realizadas por diferentes comunidades autónomas en los años 2023 y 2024. Permite visualizar la relación entre ambas necesidades sociales y observar la distribución geográfica del apoyo solicitado.</p> <a style="color: #fff; margin-right: 1rem;" target="_blank"><i>G11-autonomy-dependence-applications</i></a> <div class="chart-container svelte-sihtrb"><div id="chart11" style="max-width: 600px; margin: auto;"></div> <!> <!></div></div></div></div></div>');function ht(la,da){za(da,!1);const T="https://sos2425-18.onrender.com/api/v2/dana-grants-subsidies-stats",A="https://sos2425-17.onrender.com/api/v2/university-academic-performance",P="https://sos2425-11.onrender.com/api/v1/autonomy-dependence-applications",D="https://sos2425-13.onrender.com/api/v1/water-supply-improvements",R="https://sos2425-10.onrender.com/api/v1/radars-stats";let $=F("/api/v1/employment-data"),E=[],y=[],C=[],x=[],k=[],S=[],N=[],m=F(!0),c=F("");function _(a){return new Promise((t,e)=>{if(document.querySelector(`script[src="${a}"]`))return t();const r=document.createElement("script");r.src=a,r.onload=t,r.onerror=e,document.head.appendChild(r)})}async function pa(){l(m,!0),l(c,""),y=[];try{console.log(`Solicitando datos a: ${P}`);let a=await fetch(P,{method:"GET",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`Error en la respuesta: ${a.status}`);y=await a.json(),console.log(`Datos recibidos: ${y.length} registros`),_a()}catch(a){console.error(`ERROR G11: ${a}`),l(c,`Error al cargar datos G11: ${a.message}`)}finally{l(m,!1)}}async function ua(){l(m,!0),l(c,""),C=[],N=[];try{let a=await fetch(p($),{method:"GET",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`Error en la respuesta: ${a.status}`);N=await a.json(),console.log(`Solicitando datos a: ${D}`);let e=await fetch(D,{method:"GET",headers:{Accept:"application/json"}});if(!e.ok)throw new Error(`Error en la respuesta: ${e.status}`);let i=await e.json();if(i.length===0){if(console.warn("No hay datos. Cargando datos iniciales..."),!(await fetch(`${D}/loadInitialData`,{method:"GET"})).ok)throw new Error("No se pudo cargar datos iniciales");if(await new Promise(o=>setTimeout(o,1e3)),e=await fetch(D,{method:"GET",headers:{Accept:"application/json"}}),!e.ok)throw new Error("Error al obtener datos tras la carga inicial");i=await e.json()}C=i,console.log(`Datos recibidos: ${C.length} registros`),ya()}catch(a){console.error(`ERROR G13: ${a}`),l(c,`Error al cargar datos G13: ${a.message}`)}finally{l(m,!1)}}async function ma(){l(m,!0),l(c,""),E=[];try{console.log(`Solicitando datos a: ${A}`);let a=await fetch(A,{method:"GET",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`Error en la respuesta: ${a.status}`);let t=await a.json();if(t.length===0){if(console.warn("No hay datos. Cargando datos iniciales..."),!(await fetch(`${A}/loadInitialData`,{method:"GET"})).ok)throw new Error("No se pudo cargar datos iniciales");if(await new Promise(i=>setTimeout(i,1e3)),a=await fetch(A,{method:"GET",headers:{Accept:"application/json"}}),!a.ok)throw new Error("Error al obtener datos tras la carga inicial");t=await a.json()}E=t,console.log(`Datos recibidos: ${E.length} registros`),ga()}catch(a){console.error(`ERROR G17: ${a}`),l(c,`Error al cargar datos G17: ${a.message}`)}finally{l(m,!1)}}async function ha(){l(m,!0),l(c,""),x=[],S=[];try{let a=await fetch(p($),{method:"GET",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`Error en la respuesta: ${a.status}`);S=await a.json(),console.log(`Solicitando datos a: ${R}`);const e=await fetch(R,{method:"GET",headers:{Accept:"application/json"}});if(!e.ok)throw new Error(`Error en la respuesta: ${e.status}`);x=await e.json(),console.log(`Datos recibidos: ${x.length} registros`),wa()}catch(a){console.error(`ERROR G10: ${a}`),l(c,`Error al cargar datos G10: ${a.message}`),l(m,!1)}}async function fa(){l(m,!0),l(c,"");try{console.log(`Solicitando datos a: ${T}`);const a=await fetch(T,{method:"GET",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`Error en la respuesta: ${a.status}`);k=await a.json(),console.log(`Datos recibidos: ${k.length} registros`),va()}catch(a){console.error(`ERROR al obtener datos: ${a}`),l(c,`Error al cargar datos: ${a.message}`)}finally{l(m,!1)}}async function va(){console.log("Estructura de los primeros datos:",JSON.stringify(k[0],null,2));const a={};k.forEach(i=>{const r=i.mun_name,o=i.amt_granted;a[r]||(a[r]=0),a[r]+=o}),console.log("Datos agrupados por municipio:",a);const t=Object.entries(a).map(([i,r])=>({name:i,y:r})).sort((i,r)=>r.y-i.y);if(console.log("Datos preparados para el gráfico:",t),t.length===0){l(c,"No se pudieron encontrar datos válidos de municipios y cantidades");return}let e=t.slice(0,10);if(t.length>10){const r=t.slice(10).reduce((o,s)=>o+s.y,0);e.push({name:"Otros municipios",y:r})}Highcharts.chart("container",{chart:{type:"pie",backgroundColor:"rgba(255, 255, 255, 0.8)"},title:{text:"Distribución de ayudas por municipios",align:"center",style:{fontWeight:"bold",fontSize:"18px"}},subtitle:{text:"Fuente: G18-dana-grants-subsidies-stats",align:"center"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.percentage:.1f}%",style:{fontSize:"12px"}},showInLegend:!0}},tooltip:{pointFormat:"{series.name}: <b>{point.y:.0f}€</b> ({point.percentage:.1f}%)"},legend:{enabled:!0,layout:"vertical",align:"right",verticalAlign:"middle"},accessibility:{point:{valueSuffix:"€"}},series:[{name:"Importe total",colorByPoint:!0,data:e}],credits:{enabled:!0,text:"G18-dana-grants-subsidies-stats"}})}function ga(){if(!Array.isArray(E)||E.length===0){l(c,"No hay datos disponibles de universidades para mostrar el gráfico.");return}const a={};E.forEach(o=>{const s=o.degree||"Desconocido";a[s]||(a[s]=0),a[s]+=o.cohortStudents||0});const t=Object.entries(a).sort((o,s)=>s[1]-o[1]),e=t.slice(0,6),i=t.slice(6).reduce((o,[,s])=>o+s,0);i>0&&e.push(["Otras",i]);const r=e.map(([o,s])=>[o,s]);c3.generate({bindto:"#chart17",data:{type:"donut",columns:r},donut:{title:"Estudiantes por universidad"}})}async function ya(){await Fa();const a={};N.forEach(r=>{var o;if(((o=r.autonomous_community)==null?void 0:o.toLowerCase())==="andalucía"&&r.education_level==="TOTAL"){const s=r.year.toString();a[s]||(a[s]={activity_rate:null,project_count:null}),a[s].activity_rate=r.activity_rate}}),C.forEach(r=>{var o,s;if(((o=r.autonomous_community)==null?void 0:o.toLowerCase())==="andalucía"||((s=r.autonomous_community)==null?void 0:s.toLowerCase())==="andalucia"){const v=r.year.toString();a[v]||(a[v]={activity_rate:null,project_count:null}),a[v].project_count=r.project_count}});const t=Object.keys(a).sort(),e=["Tasa de Actividad (%)"],i=["Número de Proyectos"];t.forEach(r=>{const o=a[r];e.push(o.activity_rate??0),i.push(o.project_count??0)}),c3.generate({bindto:"#andaluciaChart",data:{x:"x",columns:[["x",...t],e,i],types:{"Tasa de Actividad (%)":"area-spline","Número de Proyectos":"area-spline"},labels:!0},axis:{x:{type:"category",label:"Año"},y:{label:"Valores"}},title:{text:"Evolución de Proyectos y Tasa de Actividad en Andalucía"},legend:{position:"right"}})}function _a(){if(!Array.isArray(y)||y.length===0){l(c,"No hay datos disponibles para mostrar el gráfico.");return}const a=[...new Set(y.map(i=>`${i.place} ${i.year}`))],t=["Autonomía"],e=["Dependencia"];a.forEach(i=>{const[r,o]=i.split(/ (?=\d{4}$)/),s=y.find(v=>v.place===r&&v.year.toString()===o);t.push((s==null?void 0:s.request)||0),e.push((s==null?void 0:s.dependent_population)||0)}),c3.generate({bindto:"#chart11",data:{x:"x",columns:[["x",...a],t,e],type:"bar",labels:!0},axis:{x:{type:"category",label:{text:"Comunidad y Año",position:"outer-center"},tick:{rotate:45,multiline:!1}},y:{label:{text:"Solicitudes",position:"outer-middle"}}},title:{text:"Comparativa de Solicitudes de Autonomía y Dependencia por Comunidad Autónoma y Año"},legend:{position:"right"},tooltip:{grouped:!1}})}function wa(){if(x.length===0||S.length===0){l(c,"No hay datos disponibles para mostrar el gráfico");return}const a={Madrid:"Madrid (Comunidad de)",Navarra:"Navarra (Comunidad Foral de)"};function t(o){return a[o]||o}const e=[["x"],["Tasa de Paro (%)"]],i=[];[...new Set(x.map(o=>t(o.autonomousCommunity)))].forEach(o=>{const s=x.filter(w=>t(w.autonomousCommunity)===o).reduce((w,Ia)=>w+(Ia.complaint||0),0),v=S.find(w=>t(w.autonomous_community)===o&&w.year===2023&&w.education_level==="TOTAL");v&&(i.push(o),e[0].push(s),e[1].push(v.unemployment_rate))}),console.log("Datos:",e),c3.generate({bindto:"#chart10",data:{xs:{"Tasa de Paro (%)":"x"},columns:e,type:"scatter",labels:!0},axis:{x:{label:"Número de multas",tick:{fit:!1}},y:{label:"Tasa de paro (%)"}},tooltip:{format:{title(o,s){return i[s]},value(o,s,v){return`${v==="x"?"Multas":"Paro"}: ${o}`}}},title:{text:"Relación entre tasa de paro (2023) y número de multas por Comunidad Autónoma"},legend:{position:"right"}})}Ua(async()=>{try{await _("https://code.highcharts.com/highcharts.js"),await _("https://code.highcharts.com/modules/heatmap.js"),await _("https://code.highcharts.com/modules/exporting.js"),await _("https://code.highcharts.com/modules/export-data.js"),await _("https://code.highcharts.com/modules/accessibility.js"),await _("https://cdnjs.cloudflare.com/ajax/libs/d3/5.16.0/d3.min.js"),await _("https://cdnjs.cloudflare.com/ajax/libs/c3/0.7.20/c3.min.js"),await fa(),await ua(),await ha(),await ma(),await pa()}catch(a){l(c,`Error cargando scripts de Highcharts: ${a}`),console.error(a)}}),Ja();var I=rt();Oa(a=>{var t=Ba();Ma.title="Integrations - Jaime Duffy Panés",qa(4),h(a,t)});var W=d(I),O=n(d(W),4),z=d(O),H=n(d(z),4);b(H,"href",T);var J=n(H,2),U=d(J),B=n(d(U),2);{var ba=a=>{var t=Va();h(a,t)};g(B,a=>{p(m)&&a(ba)})}var Ea=n(B,2);{var xa=a=>{var t=Ya(),e=d(t,!0);u(t),j(()=>G(e,p(c))),h(a,t)};g(Ea,a=>{p(c)&&a(xa)})}u(U),u(J),u(z);var L=n(z,2),V=n(d(L),4);b(V,"href",R);var Y=n(V,2),K=n(Y,2),Q=n(d(K),2);{var ja=a=>{var t=Ka();h(a,t)};g(Q,a=>{p(m)&&a(ja)})}var Aa=n(Q,2);{var Da=a=>{var t=Qa(),e=d(t,!0);u(t),j(()=>G(e,p(c))),h(a,t)};g(Aa,a=>{p(c)&&a(Da)})}u(K),u(L);var M=n(L,2),X=n(d(M),4);b(X,"href",D);var Z=n(X,2),aa=n(Z,2),ta=n(d(aa),2);{var Ga=a=>{var t=Xa();h(a,t)};g(ta,a=>{p(m)&&a(Ga)})}var $a=n(ta,2);{var Ca=a=>{var t=Za(),e=d(t,!0);u(t),j(()=>G(e,p(c))),h(a,t)};g($a,a=>{p(c)&&a(Ca)})}u(aa),u(M);var q=n(M,2),ea=n(d(q),4);b(ea,"href",A);var oa=n(ea,2),ra=n(d(oa),2);{var ka=a=>{var t=at();h(a,t)};g(ra,a=>{p(m)&&a(ka)})}var Sa=n(ra,2);{var Ta=a=>{var t=tt(),e=d(t,!0);u(t),j(()=>G(e,p(c))),h(a,t)};g(Sa,a=>{p(c)&&a(Ta)})}u(oa),u(q);var sa=n(q,2),ia=n(d(sa),4);b(ia,"href",P);var na=n(ia,2),ca=n(d(na),2);{var Pa=a=>{var t=et();h(a,t)};g(ca,a=>{p(m)&&a(Pa)})}var Ra=n(ca,2);{var Na=a=>{var t=ot(),e=d(t,!0);u(t),j(()=>G(e,p(c))),h(a,t)};g(Ra,a=>{p(c)&&a(Na)})}u(na),u(sa),u(O),u(W),u(I),j(()=>{b(Y,"href",p($)),b(Z,"href",p($))}),Wa(3,O,()=>Ha,()=>({duration:400})),h(la,I),La()}export{ht as component};
