import{t as v,h as O,a as m,b as k}from"../chunks/CoNQuiwa.js";import"../chunks/CmnpUSTW.js";import{v as W,x as _,b as t,w as F,s as h,c as l,h as r,m as x,n as H,B as U,r as i}from"../chunks/9WqpKGnU.js";import{e as V,s as N}from"../chunks/e9-FdQ4l.js";import{i as j}from"../chunks/0Uz-nMqn.js";import{e as q,i as J}from"../chunks/CuQGIb-H.js";import{b as K}from"../chunks/2tmVuuMt.js";import{i as Q}from"../chunks/ChH0W3mW.js";import{o as X}from"../chunks/C8PSm_dE.js";var Y=k('<script src="https://code.highcharts.com/highcharts.js"><\/script> <script src="https://code.highcharts.com/modules/heatmap.js"><\/script> <script src="https://code.highcharts.com/modules/exporting.js"><\/script> <script src="https://code.highcharts.com/modules/export-data.js"><\/script> <script src="https://code.highcharts.com/modules/accessibility.js"><\/script>',1),Z=v("<option> </option>"),aa=v("<p>Cargando datos...</p>"),ea=v('<p style="color: red"> </p>'),ta=v('<div class="wrapper"><div class="container"><h2>Gráficas de employment-data</h2> <hr> <div class="article"><h3>Gráfica de la tasa de empleo</h3> <p>Esta gráfica permite visualizar los datos de empleo por año y nivel educativo. Puedes seleccionar la comunidad autónoma en específico.</p></div> <div class="graph-container"><h3>Selecciona la comunidad autónmoma:</h3> <select class="custom-select"></select> <figure class="highcharts-figure svelte-t3krpg"><div id="container"></div> <!> <!></figure></div></div></div>');function ma(L,M){W(M,!1);let P="/api/v1/employment-data",d=[],g=["INF","SEC","SUP","TOTAL"],u=[],f=x(!0),s=x("");const B=["Andalucía","Aragón","Asturias","Baleares","Canarias","Cantabria","Castilla-La Mancha","Castilla y León","Cataluña","Comunitat Valenciana","Extremadura","Galicia","Madrid","Murcia","Navarra","País Vasco","La Rioja","Ceuta y Melilla","TOTAL"];let n=x("Andalucía");async function A(){r(f,!0),r(s,"");const a=`${P}?autonomous_community=${encodeURIComponent(t(n))}`;try{console.log(`Solicitando datos a: ${a}`);const e=await fetch(a,{method:"GET"});if(!e.ok)throw new Error(`Error en la respuesta: ${e.status}`);d=await e.json(),console.log(`Datos recibidos: ${d.length} registros para ${t(n)}`),u=[...new Set(d.map(c=>c.year))].sort(),D()}catch(e){console.error(`ERROR al obtener datos de ${a}: ${e}`),r(s,`Error al cargar datos: ${e.message}`)}finally{r(f,!1)}}function D(){if(d.length===0){console.log("No hay datos para mostrar"),r(s,"No hay datos disponibles para la comunidad seleccionada");return}const a=[];if(g.forEach((e,o)=>{u.forEach((c,y)=>{const S=d.find(T=>T.education_level===e&&T.year===c);S&&a.push([y,o,S.employment_rate])})}),a.length===0){console.error("No se encontraron puntos de datos para el gráfico"),r(s,"No hay datos disponibles para generar el gráfico para la comunidad seleccionada");return}console.log(`Generando gráfico con ${a.length} puntos de datos`),Highcharts.chart("container",{chart:{type:"heatmap",marginTop:40,marginBottom:80,plotBorderWidth:1},title:{text:`Tasa de empleo por nivel educativo en ${t(n)}`,style:{fontSize:"1.2em"}},xAxis:{categories:u.map(String),title:{text:"Año"}},yAxis:{categories:g,title:{text:"Nivel Educativo"},reversed:!0},colorAxis:{min:40,max:100,minColor:"#e0bbff",maxColor:"#5f4b8b"},legend:{align:"right",layout:"vertical",margin:0,verticalAlign:"top",y:25,symbolHeight:280},tooltip:{formatter(){return`<b>Año: ${u[this.point.x]}</b><br><b>Nivel educativo: ${g[this.point.y]}</b><br><b>Tasa de empleo: ${this.point.value.toFixed(2)}%</b>`}},series:[{name:"Tasa de empleo",borderWidth:0,data:a,dataLabels:{enabled:!0,color:"#ffffff"}}],responsive:{rules:[{condition:{maxWidth:500},chartOptions:{yAxis:{labels:{style:{fontSize:"10px"}}},legend:{align:"center",verticalAlign:"bottom",layout:"horizontal",y:0}}}]}})}function G(){r(s,""),A()}X(async()=>{await A()}),Q();var b=ta();O(a=>{var e=Y();H(8),m(a,e)});var C=l(b),$=h(l(C),6),p=h(l($),2);_(()=>{t(n),U(()=>{})}),q(p,5,()=>B,J,(a,e)=>{var o=Z(),c={},y=l(o,!0);i(o),_(()=>{c!==(c=t(e))&&(o.value=(o.__value=t(e))??""),N(y,t(e))}),m(a,o)}),i(p);var E=h(p,2),w=h(l(E),2);{var R=a=>{var e=aa();m(a,e)};j(w,a=>{t(f)&&a(R)})}var z=h(w,2);{var I=a=>{var e=ea(),o=l(e,!0);i(e),_(()=>N(o,t(s))),m(a,e)};j(z,a=>{t(s)&&a(I)})}i(E),i($),i(C),i(b),K(p,()=>t(n),a=>r(n,a)),V("change",p,G),m(L,b),F()}export{ma as component};
