import{t as F,h as he,a as P}from"../chunks/B3u6e_HZ.js";import"../chunks/BgQ-wDfz.js";import{v as ve,w as be,$ as ge,c as f,s,b as e,m as q,r as m,h as r,x as ee,y as c,n as ye}from"../chunks/DOV76-9X.js";import{e as w,s as C}from"../chunks/ByobJIaC.js";import{i as M}from"../chunks/Ggrbtp_H.js";import{e as Ee,i as we}from"../chunks/X689s75_.js";import{r as l}from"../chunks/Ddg-f8kW.js";import{t as $e,f as xe,b as u,p as te}from"../chunks/yImMENhG.js";import{i as De}from"../chunks/CLw_NnEe.js";import{o as Te}from"../chunks/BFnYxA1T.js";import{g as Re}from"../chunks/DuTt44cL.js";var ke=F('<p class="info-message"> </p>'),Ae=F('<form class="create-form"><input placeholder="Comunidad Aut√≥noma" required> <input type="number" placeholder="A√±o" required> <input type="number" placeholder="Formaci√≥n Profesional B√°sica" required step="any"> <input type="number" placeholder="Grado Medio" required step="any"> <input type="number" placeholder="Grado Superior" required step="any"> <button type="submit" class="submit">Crear</button> <button type="button" class="cancel">Cancelar</button></form>'),qe=F('<form class="create-form"><input type="number" placeholder="Desde a√±o"> <input type="number" placeholder="Hasta a√±o"> <input type="number" placeholder="A√±o exacto"> <input type="text" placeholder="Comunidad aut√≥noma"> <input type="number" placeholder="Formaci√≥n Profesional B√°sica exacto" step="any"> <input type="number" placeholder="Formaci√≥n Prof. B√°sica desde" step="any"> <input type="number" placeholder="Formaci√≥n Prof. B√°sica hasta" step="any"> <input type="number" placeholder="Grado Medio exacto" step="any"> <input type="number" placeholder="Grado Medio desde" step="any"> <input type="number" placeholder="Grado Medio hasta" step="any"> <input type="number" placeholder="Grado Superior exacto" step="any"> <input type="number" placeholder="Grado Superior desde" step="any"> <input type="number" placeholder="Grado Superior hasta" step="any"> <input type="number" placeholder="Limitar a..."> <input type="number" placeholder="Comenzar desde..."> <button class="btn" type="submit">Buscar</button></form>'),Ce=F('<tr><td> </td><td> </td><td> </td><td> </td><td> </td><td class="actions"><button class="btn-circle" title="Editar Registro"><i class="fas fa-pen"></i></button> <button class="btn-circle" title="Eliminar Registro"><i class="fas fa-times"></i></button></td></tr>'),Ge=F('<div class="wrapper dash"><div class="container dash"><!> <div class="header"><h3>Datos de Educaci√≥n</h3> <div class="actions"><button class="btn"><i class="fas fa-search"></i> B√∫squeda</button> <button class="btn"><i class="fas fa-plus"></i> Nuevo registro</button> <button class="btn"><i class="fas fa-sync-alt"></i> Recargar los datos iniciales</button> <button class="btn"><i class="fas fa-trash-alt"></i> Eliminar todos los datos</button></div></div> <!> <!> <div class="seeker"></div> <div class="table-container"><table><thead><tr><th>Comunidad Aut√≥noma</th><th>A√±o</th><th>Formaci√≥n Profesional B√°sica</th><th>Grado Medio</th><th>Grado Superior</th><th>Acciones</th></tr></thead></table> <div class="scroll-body"><table><tbody></tbody></table></div></div></div></div>');function Ue(re,ae){ve(ae,!1);let $="/api/v1/education-data",b=q([]),i=q(""),T=q(!1),G=q(!1),p=q({autonomous_community:"",year:"",basic_fp:"",middle_grade:"",higher_grade:""}),t=q({from:"",to:"",year:"",autonomous_community:"",basic_fp_from:"",basic_fp_to:"",middle_grade_from:"",middle_grade_to:"",higher_grade_from:"",higher_grade_to:"",limit:"",offset:""});async function R(){try{const o=await fetch($);if(!o.ok){o.status===404?r(i,"No se encontraron datos de educaci√≥n."):o.status===500?r(i,"Error del servidor. Intenta m√°s tarde."):r(i,"Error inesperado"),r(b,[]);return}r(b,await o.json())}catch(o){console.error("[GET] Error cargando datos:",o),r(i,"No se pudo conectar con el servidor."),r(b,[])}setTimeout(()=>r(i,""),2e3)}function oe(){r(G,!e(G)),r(T,!1),e(G)||(r(t,{from:"",to:"",year:"",autonomous_community:"",basic_fp:"",middle_grade:"",higher_grade:"",basic_fp_from:"",basic_fp_to:"",middle_grade_from:"",middle_grade_to:"",higher_grade_from:"",higher_grade_to:"",limit:"",offset:""}),r(i,""),R())}function ie(){r(T,!e(T)),r(G,!1)}async function se(){const o=new URLSearchParams;for(const[a,n]of Object.entries(e(t)))n!==""&&n!==null&&n!==void 0&&o.append(a,n);try{const a=await fetch(`${$}?${o.toString()}`);if(!a.ok){a.status===400?r(i,"Par√°metros de b√∫squeda no v√°lidos."):a.status===500?r(i,"Error interno del servidor al buscar."):r(i,"Error inesperado"),r(b,[]);return}r(b,await a.json()),e(b).length===0?r(i,"No se encontraron resultados para tu b√∫squeda."):r(i,`Se encontraron ${e(b).length} resultados.`)}catch(a){console.error("[SEARCH] Error al buscar:",a),r(i,"No se pudo conectar con el servidor."),r(b,[])}setTimeout(()=>r(i,""),2e3)}async function ne(){try{const o=await fetch($,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e(p))}),a=await o.json();o.status===201?(r(i,"Registro creado correctamente"),r(T,!1),de(),await R()):o.status===400?r(i,`Datos inv√°lidos: ${a.error||"Revisa los campos."}`):o.status===409?r(i,"Ya existe un registro con esos identificadores."):r(i,`Error inesperado (${o.status}) al procesar la petici√≥n.`)}catch(o){console.error("[CREATE] Error:",o),r(i,"No se pudo conectar con el servidor.")}setTimeout(()=>r(i,""),2e3)}function de(){r(p,{autonomous_community:"",year:"",basic_fp:"",middle_grade:"",higher_grade:""})}async function ce(){const o=`${$}/loadInitialData?reset=true`,a=`${$}/loadInitialData`;try{if(e(b).length>0){if(!confirm("There are existing records. Do you want to reload the initial data and reset everything?"))return;const h=await fetch(o);if(!h.ok)throw new Error(`Error ${h.status}`);r(i,"üîÑ Initial data reloaded with reset.")}else{const n=await fetch(a);if(!n.ok)throw new Error(`Error ${n.status}`);r(i,"üì• Initial data loaded.")}await R()}catch(n){console.error("[LOAD INITIAL DATA] Error:",n),r(i,"‚ùå Error loading initial data.")}setTimeout(()=>{r(i,"")},3e3)}async function le(){if(confirm("¬øEst√°s seguro de que quieres eliminar todos los registros de educaci√≥n?")){try{const a=await fetch($,{method:"DELETE"});a.status===200?(r(i,"Todos los registros de educaci√≥n han sido eliminados."),await R()):a.status===404?r(i,"No hay registros de educaci√≥n que eliminar."):r(i,"Error al eliminar los registros de educaci√≥n.")}catch(a){console.error("[DELETE] Error eliminando registros de educaci√≥n:",a),r(i,"Error al eliminar los registros de educaci√≥n.")}setTimeout(()=>{r(i,"")},2e3)}}async function ue(o,a){try{const n=await fetch(`${$}/${o}/${a}`,{method:"DELETE"});n.status===200?(r(i,`Registro de educaci√≥n en ${o} (${a}) eliminado correctamente.`),await R()):n.status===404?r(i,"Registro de educaci√≥n no encontrado."):r(i,"Error al eliminar el registro de educaci√≥n.")}catch(n){console.error("[DELETE] Error eliminando el registro de educaci√≥n:",n),r(i,"Error al eliminar el registro de educaci√≥n.")}setTimeout(()=>{r(i,"")},2e3)}Te(async()=>{await R()}),De();var L=Ge();he(o=>{ge.title="Datos de Educaci√≥n"});var j=f(L),O=f(j);{var me=o=>{var a=ke(),n=f(a,!0);m(a),ee(()=>C(n,e(i))),$e(3,a,()=>xe,()=>({duration:300})),P(o,a)};M(O,o=>{e(i)&&o(me)})}var B=s(O,2),H=s(f(B),2),U=f(H),z=s(U,2),J=s(z,2),pe=s(J,2);m(H),m(B);var Y=s(B,2);{var fe=o=>{var a=Ae(),n=f(a);l(n);var h=s(n,2);l(h);var g=s(h,2);l(g);var v=s(g,2);l(v);var y=s(v,2);l(y);var E=s(y,4);m(a),u(n,()=>e(p).autonomous_community,_=>c(p,e(p).autonomous_community=_)),u(h,()=>e(p).year,_=>c(p,e(p).year=_)),u(g,()=>e(p).basic_fp,_=>c(p,e(p).basic_fp=_)),u(v,()=>e(p).middle_grade,_=>c(p,e(p).middle_grade=_)),u(y,()=>e(p).higher_grade,_=>c(p,e(p).higher_grade=_)),w("click",E,()=>r(T,!1)),w("submit",a,te(ne)),P(o,a)};M(Y,o=>{e(T)&&o(fe)})}var K=s(Y,2);{var _e=o=>{var a=qe(),n=f(a);l(n);var h=s(n,2);l(h);var g=s(h,2);l(g);var v=s(g,2);l(v);var y=s(v,2);l(y);var E=s(y,2);l(E);var _=s(E,2);l(_);var x=s(_,2);l(x);var I=s(x,2);l(I);var D=s(I,2);l(D);var S=s(D,2);l(S);var k=s(S,2);l(k);var A=s(k,2);l(A);var N=s(A,2);l(N);var Z=s(N,2);l(Z),ye(2),m(a),u(n,()=>e(t).from,d=>c(t,e(t).from=d)),u(h,()=>e(t).to,d=>c(t,e(t).to=d)),u(g,()=>e(t).year,d=>c(t,e(t).year=d)),u(v,()=>e(t).autonomous_community,d=>c(t,e(t).autonomous_community=d)),u(y,()=>e(t).basic_fp,d=>c(t,e(t).basic_fp=d)),u(E,()=>e(t).basic_fp_from,d=>c(t,e(t).basic_fp_from=d)),u(_,()=>e(t).basic_fp_to,d=>c(t,e(t).basic_fp_to=d)),u(x,()=>e(t).middle_grade,d=>c(t,e(t).middle_grade=d)),u(I,()=>e(t).middle_grade_from,d=>c(t,e(t).middle_grade_from=d)),u(D,()=>e(t).middle_grade_to,d=>c(t,e(t).middle_grade_to=d)),u(S,()=>e(t).higher_grade,d=>c(t,e(t).higher_grade=d)),u(k,()=>e(t).higher_grade_from,d=>c(t,e(t).higher_grade_from=d)),u(A,()=>e(t).higher_grade_to,d=>c(t,e(t).higher_grade_to=d)),u(N,()=>e(t).limit,d=>c(t,e(t).limit=d)),u(Z,()=>e(t).offset,d=>c(t,e(t).offset=d)),w("submit",a,te(se)),P(o,a)};M(K,o=>{e(G)&&o(_e)})}var Q=s(K,4),V=s(f(Q),2),W=f(V),X=f(W);Ee(X,5,()=>e(b),we,(o,a)=>{var n=Ce(),h=f(n),g=f(h,!0);m(h);var v=s(h),y=f(v,!0);m(v);var E=s(v),_=f(E,!0);m(E);var x=s(E),I=f(x,!0);m(x);var D=s(x),S=f(D,!0);m(D);var k=s(D),A=f(k),N=s(A,2);m(k),m(n),ee(()=>{C(g,e(a).autonomous_community),C(y,e(a).year),C(_,e(a).basic_fp),C(I,e(a).middle_grade),C(S,e(a).higher_grade)}),w("click",A,()=>Re(`/education/edit/${encodeURIComponent(e(a).autonomous_community)}/${e(a).year}`)),w("click",N,()=>ue(e(a).autonomous_community,e(a).year)),P(o,n)}),m(X),m(W),m(V),m(Q),m(j),m(L),w("click",U,oe),w("click",z,ie),w("click",J,ce),w("click",pe,le),P(re,L),be()}export{Ue as component};
